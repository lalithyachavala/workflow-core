{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/lib/env.ts"],"sourcesContent":["export const env = {\n  mongodbUri: process.env.MONGODB_URI || \"mongodb://localhost:27017/workforce\",\n  accessSecret: process.env.JWT_ACCESS_SECRET || \"dev-access-secret-change-me\",\n  refreshSecret: process.env.JWT_REFRESH_SECRET || \"dev-refresh-secret-change-me\",\n  accessTokenTtlMinutes: Number(process.env.ACCESS_TOKEN_TTL_MINUTES || \"15\"),\n  refreshTokenTtlDays: Number(process.env.REFRESH_TOKEN_TTL_DAYS || \"30\"),\n  geoFallbackCountry: process.env.GEOIP_FALLBACK_COUNTRY || \"Unknown\",\n  /** 32-byte hex key for AES-GCM embedding encryption. Generate: openssl rand -hex 32 */\n  faceEmbeddingKey: process.env.FACE_EMBEDDING_KEY || \"0000000000000000000000000000000000000000000000000000000000000000\",\n};\n"],"names":[],"mappings":";;;;AAAO,MAAM,MAAM;IACjB,YAAY,QAAQ,GAAG,CAAC,WAAW,IAAI;IACvC,cAAc,QAAQ,GAAG,CAAC,iBAAiB,IAAI;IAC/C,eAAe,QAAQ,GAAG,CAAC,kBAAkB,IAAI;IACjD,uBAAuB,OAAO,QAAQ,GAAG,CAAC,wBAAwB,IAAI;IACtE,qBAAqB,OAAO,QAAQ,GAAG,CAAC,sBAAsB,IAAI;IAClE,oBAAoB,QAAQ,GAAG,CAAC,sBAAsB,IAAI;IAC1D,qFAAqF,GACrF,kBAAkB,QAAQ,GAAG,CAAC,kBAAkB,IAAI;AACtD"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/lib/mongodb.ts"],"sourcesContent":["import mongoose from \"mongoose\";\nimport { env } from \"@/src/lib/env\";\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var mongooseConn: Promise<typeof mongoose> | undefined;\n}\n\nexport function connectMongo() {\n  if (!global.mongooseConn) {\n    global.mongooseConn = mongoose.connect(env.mongodbUri, { dbName: \"workforce\" });\n  }\n  return global.mongooseConn;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAOO,SAAS;IACd,IAAI,CAAC,OAAO,YAAY,EAAE;QACxB,OAAO,YAAY,GAAG,mKAAQ,CAAC,OAAO,CAAC,yIAAG,CAAC,UAAU,EAAE;YAAE,QAAQ;QAAY;IAC/E;IACA,OAAO,OAAO,YAAY;AAC5B"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/db/models.ts"],"sourcesContent":["import mongoose, { Schema, type InferSchemaType } from \"mongoose\";\n\nconst userSchema = new Schema(\n  {\n    email: { type: String, unique: true, required: true, lowercase: true, trim: true },\n    passwordHash: { type: String, required: true },\n    roleIds: [{ type: Schema.Types.ObjectId, ref: \"Role\" }],\n    isActive: { type: Boolean, default: true },\n    profile: {\n      displayName: { type: String, default: \"\" },\n      profilePictureBase64: { type: String, default: \"\" },\n      employeeCode: { type: String, default: \"\" },\n      firstName: { type: String, default: \"\" },\n      lastName: { type: String, default: \"\" },\n      nationality: { type: String, default: \"\" },\n      dateOfBirth: { type: Date, default: null },\n      gender: { type: String, default: \"\" },\n      maritalStatus: { type: String, default: \"\" },\n      jobTitle: { type: String, default: \"\" },\n      department: { type: String, default: \"\" },\n      manager: { type: String, default: \"\" },\n      phone: { type: String, default: \"\" },\n      timezone: { type: String, default: \"\" },\n      skills: [{ type: String }],\n      education: { type: String, default: \"\" },\n      languages: [{ type: String }],\n      dependents: [{ type: String }],\n      contacts: [{ type: String }],\n    },\n  },\n  { timestamps: true },\n);\n\nconst roleSchema = new Schema(\n  {\n    name: { type: String, unique: true, required: true, trim: true },\n    description: { type: String, default: \"\" },\n    permissions: [{ type: String, required: true }],\n  },\n  { timestamps: true },\n);\n\nconst refreshTokenSchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\n    tokenHash: { type: String, required: true, unique: true },\n    expiresAt: { type: Date, required: true, index: true },\n    revokedAt: { type: Date, default: null },\n  },\n  { timestamps: true },\n);\n\nconst deviceSchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\n    hostname: { type: String, required: true },\n    osVersion: { type: String, default: \"\" },\n    deviceFingerprint: { type: String, required: true, index: true },\n    appVersion: { type: String, default: \"\" },\n  },\n  { timestamps: true },\n);\n\nconst faceTemplateSchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, unique: true },\n    /** Encrypted embeddings per pose (AES-GCM). front, left, right. */\n    embeddingFront: { type: String, default: null },\n    embeddingLeft: { type: String, default: null },\n    embeddingRight: { type: String, default: null },\n    /** Model version for embedding compatibility. */\n    modelVersion: { type: Number, default: 1 },\n    status: { type: String, default: \"active\" },\n    /** @deprecated legacy single embedding - migrate to embeddingFront/Left/Right */\n    embeddingVector: [{ type: Number }],\n    version: { type: Number, default: 1 },\n  },\n  { timestamps: true },\n);\n\nconst attendanceEventSchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\n    type: { type: String, enum: [\"clockIn\", \"clockOut\"], required: true },\n    timestamp: { type: Date, required: true, index: true },\n    ip: { type: String, default: \"\" },\n    geo: {\n      country: { type: String, default: \"\" },\n      city: { type: String, default: \"\" },\n      ll: [{ type: Number }],\n    },\n    deviceId: { type: Schema.Types.ObjectId, ref: \"Device\" },\n    faceScore: { type: Number, default: 0 },\n    verificationStatus: { type: String, default: \"pending\" },\n  },\n  { timestamps: true },\n);\n\nconst workSessionSchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\n    clockInAt: { type: Date, required: true, index: true },\n    clockOutAt: { type: Date, default: null, index: true },\n    totalSeconds: { type: Number, default: 0 },\n    ipAtIn: { type: String, default: \"\" },\n    ipAtOut: { type: String, default: \"\" },\n    deviceIdAtIn: { type: Schema.Types.ObjectId, ref: \"Device\" },\n    deviceIdAtOut: { type: Schema.Types.ObjectId, ref: \"Device\" },\n  },\n  { timestamps: true },\n);\n\nconst auditLogSchema = new Schema(\n  {\n    actorUserId: { type: Schema.Types.ObjectId, ref: \"User\" },\n    action: { type: String, required: true },\n    details: { type: Schema.Types.Mixed, default: {} },\n  },\n  { timestamps: true },\n);\n\nconst awayAlertSchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\n    employeeEmail: { type: String, required: true },\n    awayAt: { type: Date, required: true, default: () => new Date() },\n    minutesAway: { type: Number, required: true, default: 15 },\n  },\n  { timestamps: true },\n);\n\nconst companyStructureSchema = new Schema(\n  {\n    name: { type: String, required: true, trim: true },\n    address: { type: String, default: \"\" },\n    type: { type: String, default: \"Department\" },\n    country: { type: String, default: \"\" },\n    timeZone: { type: String, default: \"\" },\n    parentStructure: { type: String, default: \"\" },\n  },\n  { timestamps: true },\n);\n\nconst loginHistorySchema = new Schema(\n  {\n    userId: { type: Schema.Types.ObjectId, ref: \"User\", required: true, index: true },\n    loginTime: { type: Date, required: true },\n    loginTimeFormatted: { type: String, required: true },\n    ipAddress: { type: String, default: \"\" },\n    systemName: { type: String, default: \"\" },\n    location: { type: String, default: \"\" },\n  },\n  { timestamps: true },\n);\n\nexport type UserDoc = InferSchemaType<typeof userSchema>;\nexport type RoleDoc = InferSchemaType<typeof roleSchema>;\n\nexport const User = mongoose.models.User || mongoose.model(\"User\", userSchema);\nexport const Role = mongoose.models.Role || mongoose.model(\"Role\", roleSchema);\nexport const RefreshToken =\n  mongoose.models.RefreshToken || mongoose.model(\"RefreshToken\", refreshTokenSchema);\nexport const Device = mongoose.models.Device || mongoose.model(\"Device\", deviceSchema);\nexport const FaceTemplate =\n  mongoose.models.FaceTemplate || mongoose.model(\"FaceTemplate\", faceTemplateSchema);\nexport const AttendanceEvent =\n  mongoose.models.AttendanceEvent || mongoose.model(\"AttendanceEvent\", attendanceEventSchema);\nexport const WorkSession =\n  mongoose.models.WorkSession || mongoose.model(\"WorkSession\", workSessionSchema);\nexport const AuditLog = mongoose.models.AuditLog || mongoose.model(\"AuditLog\", auditLogSchema);\nexport const CompanyStructure =\n  mongoose.models.CompanyStructure || mongoose.model(\"CompanyStructure\", companyStructureSchema);\nexport const AwayAlert =\n  mongoose.models.AwayAlert || mongoose.model(\"AwayAlert\", awayAlertSchema);\nexport const LoginHistory =\n  mongoose.models.LoginHistory || mongoose.model(\"LoginHistory\", loginHistorySchema);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 558, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/lib/tokens.ts"],"sourcesContent":["import crypto from \"crypto\";\nimport { SignJWT, jwtVerify } from \"jose\";\nimport { env } from \"@/src/lib/env\";\nimport { RefreshToken } from \"@/src/db/models\";\n\nconst accessSecret = new TextEncoder().encode(env.accessSecret);\nconst refreshSecret = new TextEncoder().encode(env.refreshSecret);\n\nexport type AccessTokenPayload = {\n  sub: string;\n  email: string;\n  roles: string[];\n};\n\nexport async function createAccessToken(payload: AccessTokenPayload) {\n  return new SignJWT(payload)\n    .setProtectedHeader({ alg: \"HS256\" })\n    .setIssuedAt()\n    .setExpirationTime(`${env.accessTokenTtlMinutes}m`)\n    .sign(accessSecret);\n}\n\nexport async function createRefreshToken(userId: string) {\n  const rawToken = crypto.randomUUID();\n  const tokenHash = crypto.createHash(\"sha256\").update(rawToken).digest(\"hex\");\n  const expiresAt = new Date(Date.now() + env.refreshTokenTtlDays * 24 * 60 * 60 * 1000);\n\n  await RefreshToken.create({ userId, tokenHash, expiresAt });\n  return rawToken;\n}\n\nexport async function verifyAccessToken(token: string) {\n  const { payload } = await jwtVerify(token, accessSecret);\n  return payload as unknown as AccessTokenPayload;\n}\n\nexport async function rotateRefreshToken(userId: string, incomingToken: string) {\n  const incomingHash = crypto.createHash(\"sha256\").update(incomingToken).digest(\"hex\");\n  const existing = await RefreshToken.findOne({ userId, tokenHash: incomingHash, revokedAt: null });\n  if (!existing || existing.expiresAt < new Date()) {\n    return null;\n  }\n\n  existing.revokedAt = new Date();\n  await existing.save();\n  return createRefreshToken(userId);\n}\n\nexport async function revokeRefreshToken(token: string) {\n  const tokenHash = crypto.createHash(\"sha256\").update(token).digest(\"hex\");\n  await RefreshToken.updateOne({ tokenHash, revokedAt: null }, { $set: { revokedAt: new Date() } });\n}\n\nexport async function verifyRefreshSubject(token: string) {\n  // Keep a signed wrapper if needed later; currently returns raw token presence.\n  await jwtVerify(\n    await new SignJWT({ token }).setProtectedHeader({ alg: \"HS256\" }).setExpirationTime(\"7d\").sign(refreshSecret),\n    refreshSecret,\n  );\n  return true;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;AAEA,MAAM,eAAe,IAAI,cAAc,MAAM,CAAC,yIAAG,CAAC,YAAY;AAC9D,MAAM,gBAAgB,IAAI,cAAc,MAAM,CAAC,yIAAG,CAAC,aAAa;AAQzD,eAAe,kBAAkB,OAA2B;IACjE,OAAO,IAAI,uKAAO,CAAC,SAChB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,GAAG,yIAAG,CAAC,qBAAqB,CAAC,CAAC,CAAC,EACjD,IAAI,CAAC;AACV;AAEO,eAAe,mBAAmB,MAAc;IACrD,MAAM,WAAW,gHAAM,CAAC,UAAU;IAClC,MAAM,YAAY,gHAAM,CAAC,UAAU,CAAC,UAAU,MAAM,CAAC,UAAU,MAAM,CAAC;IACtE,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,yIAAG,CAAC,mBAAmB,GAAG,KAAK,KAAK,KAAK;IAEjF,MAAM,oJAAY,CAAC,MAAM,CAAC;QAAE;QAAQ;QAAW;IAAU;IACzD,OAAO;AACT;AAEO,eAAe,kBAAkB,KAAa;IACnD,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,2KAAS,EAAC,OAAO;IAC3C,OAAO;AACT;AAEO,eAAe,mBAAmB,MAAc,EAAE,aAAqB;IAC5E,MAAM,eAAe,gHAAM,CAAC,UAAU,CAAC,UAAU,MAAM,CAAC,eAAe,MAAM,CAAC;IAC9E,MAAM,WAAW,MAAM,oJAAY,CAAC,OAAO,CAAC;QAAE;QAAQ,WAAW;QAAc,WAAW;IAAK;IAC/F,IAAI,CAAC,YAAY,SAAS,SAAS,GAAG,IAAI,QAAQ;QAChD,OAAO;IACT;IAEA,SAAS,SAAS,GAAG,IAAI;IACzB,MAAM,SAAS,IAAI;IACnB,OAAO,mBAAmB;AAC5B;AAEO,eAAe,mBAAmB,KAAa;IACpD,MAAM,YAAY,gHAAM,CAAC,UAAU,CAAC,UAAU,MAAM,CAAC,OAAO,MAAM,CAAC;IACnE,MAAM,oJAAY,CAAC,SAAS,CAAC;QAAE;QAAW,WAAW;IAAK,GAAG;QAAE,MAAM;YAAE,WAAW,IAAI;QAAO;IAAE;AACjG;AAEO,eAAe,qBAAqB,KAAa;IACtD,+EAA+E;IAC/E,MAAM,IAAA,2KAAS,EACb,MAAM,IAAI,uKAAO,CAAC;QAAE;IAAM,GAAG,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAAG,iBAAiB,CAAC,MAAM,IAAI,CAAC,gBAC/F;IAEF,OAAO;AACT"}},
    {"offset": {"line": 641, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/security/casbin/enforcer.ts"],"sourcesContent":["import { newEnforcer, newModelFromString } from \"casbin\";\nimport { Role, User } from \"@/src/db/models\";\n\nconst modelText = `\n[request_definition]\nr = sub, obj, act\n\n[policy_definition]\np = sub, obj, act\n\n[role_definition]\ng = _, _\n\n[policy_effect]\ne = some(where (p.eft == allow))\n\n[matchers]\nm = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act\n`;\n\nexport async function enforceUserPermission(userId: string, resource: string, action: string) {\n  const user = await User.findById(userId).lean();\n  if (!user) {\n    return false;\n  }\n\n  const roleDocs = await Role.find({ _id: { $in: user.roleIds } }).lean();\n  const enforcer = await newEnforcer(newModelFromString(modelText));\n  for (const role of roleDocs) {\n    await enforcer.addGroupingPolicy(userId, role.name);\n    for (const perm of role.permissions) {\n      const [obj, act] = perm.split(\":\");\n      if (obj && act) {\n        await enforcer.addPolicy(role.name, obj, act);\n      }\n    }\n  }\n\n  return enforcer.enforce(userId, resource, action);\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AACA;;;AAEA,MAAM,YAAY,CAAC;;;;;;;;;;;;;;;AAenB,CAAC;AAEM,eAAe,sBAAsB,MAAc,EAAE,QAAgB,EAAE,MAAc;IAC1F,MAAM,OAAO,MAAM,4IAAI,CAAC,QAAQ,CAAC,QAAQ,IAAI;IAC7C,IAAI,CAAC,MAAM;QACT,OAAO;IACT;IAEA,MAAM,WAAW,MAAM,4IAAI,CAAC,IAAI,CAAC;QAAE,KAAK;YAAE,KAAK,KAAK,OAAO;QAAC;IAAE,GAAG,IAAI;IACrE,MAAM,WAAW,MAAM,IAAA,iKAAW,EAAC,IAAA,8KAAkB,EAAC;IACtD,KAAK,MAAM,QAAQ,SAAU;QAC3B,MAAM,SAAS,iBAAiB,CAAC,QAAQ,KAAK,IAAI;QAClD,KAAK,MAAM,QAAQ,KAAK,WAAW,CAAE;YACnC,MAAM,CAAC,KAAK,IAAI,GAAG,KAAK,KAAK,CAAC;YAC9B,IAAI,OAAO,KAAK;gBACd,MAAM,SAAS,SAAS,CAAC,KAAK,IAAI,EAAE,KAAK;YAC3C;QACF;IACF;IAEA,OAAO,SAAS,OAAO,CAAC,QAAQ,UAAU;AAC5C"}},
    {"offset": {"line": 693, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/lib/request-auth.ts"],"sourcesContent":["import { NextRequest } from \"next/server\";\nimport { verifyAccessToken } from \"@/src/lib/tokens\";\nimport { enforceUserPermission } from \"@/src/security/casbin/enforcer\";\n\nexport async function requireAuth(req: NextRequest) {\n  const authHeader = req.headers.get(\"authorization\");\n  if (!authHeader?.startsWith(\"Bearer \")) {\n    return null;\n  }\n\n  const token = authHeader.substring(\"Bearer \".length);\n  try {\n    return await verifyAccessToken(token);\n  } catch {\n    return null;\n  }\n}\n\nexport async function requirePermission(\n  req: NextRequest,\n  resource: string,\n  action: string,\n) {\n  const user = await requireAuth(req);\n  if (!user?.sub) {\n    return { allowed: false, user: null };\n  }\n\n  const allowed = await enforceUserPermission(user.sub, resource, action);\n  return { allowed, user };\n}\n"],"names":[],"mappings":";;;;;;AACA;AACA;;;AAEO,eAAe,YAAY,GAAgB;IAChD,MAAM,aAAa,IAAI,OAAO,CAAC,GAAG,CAAC;IACnC,IAAI,CAAC,YAAY,WAAW,YAAY;QACtC,OAAO;IACT;IAEA,MAAM,QAAQ,WAAW,SAAS,CAAC,UAAU,MAAM;IACnD,IAAI;QACF,OAAO,MAAM,IAAA,0JAAiB,EAAC;IACjC,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,kBACpB,GAAgB,EAChB,QAAgB,EAChB,MAAc;IAEd,MAAM,OAAO,MAAM,YAAY;IAC/B,IAAI,CAAC,MAAM,KAAK;QACd,OAAO;YAAE,SAAS;YAAO,MAAM;QAAK;IACtC;IAEA,MAAM,UAAU,MAAM,IAAA,+KAAqB,EAAC,KAAK,GAAG,EAAE,UAAU;IAChE,OAAO;QAAE;QAAS;IAAK;AACzB"}},
    {"offset": {"line": 733, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/src/biometric/face.ts"],"sourcesContent":["import crypto from \"crypto\";\nimport { FaceTemplate, User } from \"@/src/db/models\";\nimport { env } from \"@/src/lib/env\";\n\nconst MODEL_VERSION = 1;\nconst IV_LENGTH = 12;\nconst AUTH_TAG_LENGTH = 16;\nconst ALGORITHM = \"aes-256-gcm\";\n\nfunction getKeyBuffer(): Buffer {\n  const hex = env.faceEmbeddingKey.replace(/[^0-9a-fA-F]/g, \"\");\n  if (hex.length !== 64) {\n    throw new Error(\"FACE_EMBEDDING_KEY must be 32-byte hex (64 chars). Generate: openssl rand -hex 32\");\n  }\n  return Buffer.from(hex, \"hex\");\n}\n\nfunction encryptEmbedding(embedding: number[]): string {\n  const key = getKeyBuffer();\n  const iv = crypto.randomBytes(IV_LENGTH);\n  const plain = Buffer.from(Float32Array.from(embedding).buffer);\n  const cipher = crypto.createCipheriv(ALGORITHM, key, iv, { authTagLength: AUTH_TAG_LENGTH });\n  const encrypted = Buffer.concat([cipher.update(plain), cipher.final()]);\n  const tag = cipher.getAuthTag();\n  return Buffer.concat([iv, tag, encrypted]).toString(\"base64\");\n}\n\nfunction decryptEmbedding(encryptedBase64: string): number[] {\n  const key = getKeyBuffer();\n  const buf = Buffer.from(encryptedBase64, \"base64\");\n  if (buf.length < IV_LENGTH + AUTH_TAG_LENGTH) {\n    throw new Error(\"Invalid encrypted embedding\");\n  }\n  const iv = buf.subarray(0, IV_LENGTH);\n  const tag = buf.subarray(IV_LENGTH, IV_LENGTH + AUTH_TAG_LENGTH);\n  const ciphertext = buf.subarray(IV_LENGTH + AUTH_TAG_LENGTH);\n  const decipher = crypto.createDecipheriv(ALGORITHM, key, iv, { authTagLength: AUTH_TAG_LENGTH });\n  decipher.setAuthTag(tag);\n  const plain = Buffer.concat([decipher.update(ciphertext), decipher.final()]);\n  return Array.from(new Float32Array(plain.buffer, plain.byteOffset, plain.length / 4));\n}\n\nfunction cosineSimilarity(a: number[], b: number[]): number {\n  const len = Math.min(a.length, b.length);\n  let dot = 0;\n  let magA = 0;\n  let magB = 0;\n  for (let i = 0; i < len; i += 1) {\n    dot += a[i] * b[i];\n    magA += a[i] * a[i];\n    magB += b[i] * b[i];\n  }\n  if (magA === 0 || magB === 0) return 0;\n  return dot / (Math.sqrt(magA) * Math.sqrt(magB));\n}\n\nexport async function updateProfilePicture(userId: string, imageBase64: string) {\n  await User.findByIdAndUpdate(userId, {\n    \"profile.profilePictureBase64\": imageBase64,\n  });\n}\n\ntype Pose = \"front\" | \"left\" | \"right\";\n\n/** Enroll one pose embedding. Call 3 times (front, left, right) to complete enrollment. */\nexport async function enrollFace(userId: string, embedding: number[], pose: Pose, profileImageBase64?: string) {\n  if (!Array.isArray(embedding) || embedding.length !== 512) {\n    throw new Error(\"Embedding must be 512 floats\");\n  }\n  const field = pose === \"front\" ? \"embeddingFront\" : pose === \"left\" ? \"embeddingLeft\" : \"embeddingRight\";\n  const encrypted = encryptEmbedding(embedding);\n  await FaceTemplate.findOneAndUpdate(\n    { userId },\n    { [field]: encrypted, modelVersion: MODEL_VERSION, status: \"active\" },\n    { upsert: true, new: true },\n  );\n  if (profileImageBase64 && profileImageBase64.length > 20) {\n    await updateProfilePicture(userId, profileImageBase64);\n  }\n}\n\n/** Verify incoming embedding against stored poses. Returns best score across front/left/right. */\nexport async function verifyFace(userId: string, embedding: number[]) {\n  if (!Array.isArray(embedding) || embedding.length !== 512) {\n    return { score: 0, accepted: false, reason: \"invalid_embedding\" as const };\n  }\n  const template = await FaceTemplate.findOne({ userId }).lean();\n  if (!template) {\n    return { score: 0, accepted: false, reason: \"no_template\" as const };\n  }\n\n  const stored: number[][] = [];\n  for (const field of [\"embeddingFront\", \"embeddingLeft\", \"embeddingRight\"] as const) {\n    const enc = template[field];\n    if (enc && typeof enc === \"string\") {\n      try {\n        stored.push(decryptEmbedding(enc));\n      } catch {\n        // skip invalid\n      }\n    }\n  }\n\n  // Legacy: single embeddingVector\n  if (stored.length === 0 && template.embeddingVector?.length === 512) {\n    stored.push(template.embeddingVector);\n  }\n\n  if (stored.length === 0) {\n    return { score: 0, accepted: false, reason: \"no_template\" as const };\n  }\n\n  let bestScore = 0;\n  for (const s of stored) {\n    const score = cosineSimilarity(embedding, s);\n    if (score > bestScore) bestScore = score;\n  }\n\n  const threshold = 0.32; // ArcFace cosine similarity; same person usually 0.4+\n  const accepted = bestScore >= threshold;\n  return {\n    score: bestScore,\n    accepted,\n    reason: accepted ? (\"matched\" as const) : (\"below_threshold\" as const),\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 894, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/app/api/auth/enroll-face/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { z } from \"zod\";\nimport { connectMongo } from \"@/src/lib/mongodb\";\nimport { requireAuth } from \"@/src/lib/request-auth\";\nimport { enrollFace } from \"@/src/biometric/face\";\n\nconst bodySchema = z.object({\n  embedding: z.array(z.number()).length(512),\n  pose: z.enum([\"front\", \"left\", \"right\"]),\n  profileImageBase64: z.string().optional(),\n});\n\nexport async function POST(req: NextRequest) {\n  await connectMongo();\n  const user = await requireAuth(req);\n  if (!user?.sub) {\n    return NextResponse.json({ message: \"Unauthorized.\" }, { status: 401 });\n  }\n\n  const parsed = bodySchema.safeParse(await req.json());\n  if (!parsed.success) {\n    return NextResponse.json({ message: \"Invalid payload.\" }, { status: 400 });\n  }\n\n  try {\n    await enrollFace(\n      user.sub,\n      parsed.data.embedding,\n      parsed.data.pose,\n      parsed.data.profileImageBase64,\n    );\n    return NextResponse.json({ ok: true });\n  } catch (e) {\n    const message = e instanceof Error ? e.message : \"Face enrollment failed.\";\n    return NextResponse.json({ ok: false, message }, { status: 400 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM,aAAa,yKAAC,CAAC,MAAM,CAAC;IAC1B,WAAW,yKAAC,CAAC,KAAK,CAAC,yKAAC,CAAC,MAAM,IAAI,MAAM,CAAC;IACtC,MAAM,yKAAC,CAAC,IAAI,CAAC;QAAC;QAAS;QAAQ;KAAQ;IACvC,oBAAoB,yKAAC,CAAC,MAAM,GAAG,QAAQ;AACzC;AAEO,eAAe,KAAK,GAAgB;IACzC,MAAM,IAAA,sJAAY;IAClB,MAAM,OAAO,MAAM,IAAA,6JAAW,EAAC;IAC/B,IAAI,CAAC,MAAM,KAAK;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACvE;IAEA,MAAM,SAAS,WAAW,SAAS,CAAC,MAAM,IAAI,IAAI;IAClD,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmB,GAAG;YAAE,QAAQ;QAAI;IAC1E;IAEA,IAAI;QACF,MAAM,IAAA,uJAAU,EACd,KAAK,GAAG,EACR,OAAO,IAAI,CAAC,SAAS,EACrB,OAAO,IAAI,CAAC,IAAI,EAChB,OAAO,IAAI,CAAC,kBAAkB;QAEhC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;QAAK;IACtC,EAAE,OAAO,GAAG;QACV,MAAM,UAAU,aAAa,QAAQ,EAAE,OAAO,GAAG;QACjD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAO;QAAQ,GAAG;YAAE,QAAQ;QAAI;IACjE;AACF"}}]
}