{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/util/ip.js"],"sourcesContent":["// This is a minimal subset of node-ip for handling IPMatch\n// https://github.com/indutny/node-ip/blob/master/lib/ip.js\n//\n// ### License\n//\n// This software is licensed under the MIT License.\n//\n// Copyright Fedor Indutny, 2012.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\nimport { Buffer } from 'buffer/';\nconst ipv4Regex = /^(\\d{1,3}\\.){3,3}\\d{1,3}$/;\nconst ipv6Regex = /^(::)?(((\\d{1,3}\\.){3}(\\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;\nexport const ip = {\n    toBuffer: function (ip, buff, offset) {\n        offset = offset ? offset : 0;\n        let result;\n        if (this.isV4Format(ip)) {\n            result = buff || new Buffer(offset + 4);\n            ip.split(/\\./g).map(function (byte) {\n                offset = offset ? offset : 0;\n                result[offset++] = parseInt(byte, 10) & 0xff;\n            });\n        }\n        else if (this.isV6Format(ip)) {\n            const sections = ip.split(':', 8);\n            let i;\n            for (i = 0; i < sections.length; i++) {\n                const isv4 = this.isV4Format(sections[i]);\n                let v4Buffer;\n                if (isv4) {\n                    v4Buffer = this.toBuffer(sections[i]);\n                    sections[i] = v4Buffer.slice(0, 2).toString('hex');\n                }\n                if (v4Buffer && ++i < 8) {\n                    sections.splice(i, 0, v4Buffer.slice(2, 4).toString('hex'));\n                }\n            }\n            if (sections[0] === '') {\n                while (sections.length < 8)\n                    sections.unshift('0');\n            }\n            else if (sections[sections.length - 1] === '') {\n                while (sections.length < 8)\n                    sections.push('0');\n            }\n            else if (sections.length < 8) {\n                for (i = 0; i < sections.length && sections[i] !== ''; i++) { }\n                const argv = [i, 1];\n                for (i = 9 - sections.length; i > 0; i--) {\n                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                    // @ts-ignore\n                    argv.push('0');\n                }\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                // eslint-disable-next-line prefer-spread\n                sections.splice.apply(sections, argv);\n            }\n            result = buff || new Buffer(offset + 16);\n            for (i = 0; i < sections.length; i++) {\n                const word = parseInt(sections[i], 16);\n                result[offset++] = (word >> 8) & 0xff;\n                result[offset++] = word & 0xff;\n            }\n        }\n        if (!result) {\n            throw Error('Invalid ip address: ' + ip);\n        }\n        return result;\n    },\n    toString: function (buff, offset, length) {\n        offset = offset ? offset : 0;\n        length = length || buff.length - offset;\n        let result = [];\n        if (length === 4) {\n            // IPv4\n            for (let i = 0; i < length; i++) {\n                result.push(buff[offset + i]);\n            }\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            result = result.join('.');\n        }\n        else if (length === 16) {\n            // IPv6\n            for (let i = 0; i < length; i += 2) {\n                result.push(buff.readUInt16BE(offset + i).toString(16));\n            }\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            result = result.join(':');\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            result = result.replace(/(^|:)0(:0)*:0(:|$)/, '$1::$3');\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            result = result.replace(/:{3,4}/, '::');\n        }\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        return result;\n    },\n    isV4Format: function (ip) {\n        return ipv4Regex.test(ip);\n    },\n    isV6Format: function (ip) {\n        return ipv6Regex.test(ip);\n    },\n    fromPrefixLen: function (prefixlen, family) {\n        if (prefixlen > 32) {\n            family = 'ipv6';\n        }\n        else {\n            family = _normalizeFamily(typeof family === 'string' ? family : '');\n        }\n        let len = 4;\n        if (family === 'ipv6') {\n            len = 16;\n        }\n        const buff = new Buffer(len);\n        for (let i = 0, n = buff.length; i < n; ++i) {\n            let bits = 8;\n            if (prefixlen < 8) {\n                bits = prefixlen;\n            }\n            prefixlen -= bits;\n            buff[i] = ~(0xff >> bits) & 0xff;\n        }\n        return ip.toString(buff);\n    },\n    mask: function (addr, mask) {\n        const addrBuffer = ip.toBuffer(addr);\n        const maskBuffer = ip.toBuffer(mask);\n        const result = new Buffer(Math.max(addrBuffer.length, maskBuffer.length));\n        let i;\n        // Same protocol - do bitwise and\n        if (addrBuffer.length === maskBuffer.length) {\n            for (i = 0; i < addrBuffer.length; i++) {\n                result[i] = addrBuffer[i] & maskBuffer[i];\n            }\n        }\n        else if (maskBuffer.length === 4) {\n            // IPv6 address and IPv4 mask\n            // (Mask low bits)\n            for (i = 0; i < maskBuffer.length; i++) {\n                result[i] = addrBuffer[addrBuffer.length - 4 + i] & maskBuffer[i];\n            }\n        }\n        else {\n            // IPv6 mask and IPv4 addr\n            for (let i = 0; i < result.length - 6; i++) {\n                result[i] = 0;\n            }\n            // ::ffff:ipv4\n            result[10] = 0xff;\n            result[11] = 0xff;\n            for (i = 0; i < addrBuffer.length; i++) {\n                result[i + 12] = addrBuffer[i] & maskBuffer[i + 12];\n            }\n            i = i + 12;\n        }\n        for (; i < result.length; i++)\n            result[i] = 0;\n        return ip.toString(result);\n    },\n    subnet: function (addr, mask) {\n        const networkAddress = ip.toLong(ip.mask(addr, mask));\n        // Calculate the mask's length.\n        const maskBuffer = ip.toBuffer(mask);\n        let maskLength = 0;\n        for (let i = 0; i < maskBuffer.length; i++) {\n            if (maskBuffer[i] === 0xff) {\n                maskLength += 8;\n            }\n            else {\n                let octet = maskBuffer[i] & 0xff;\n                while (octet) {\n                    octet = (octet << 1) & 0xff;\n                    maskLength++;\n                }\n            }\n        }\n        return {\n            contains: function (other) {\n                return networkAddress === ip.toLong(ip.mask(other, mask));\n            },\n        };\n    },\n    cidrSubnet: function (cidrString) {\n        const cidrParts = cidrString.split('/');\n        const addr = cidrParts[0];\n        if (cidrParts.length !== 2)\n            throw new Error('invalid CIDR subnet: ' + addr);\n        const mask = ip.fromPrefixLen(parseInt(cidrParts[1], 10));\n        return ip.subnet(addr, mask);\n    },\n    isEqual: function (a, b) {\n        let aBuffer = ip.toBuffer(a);\n        let bBuffer = ip.toBuffer(b);\n        // Same protocol\n        if (aBuffer.length === bBuffer.length) {\n            for (let i = 0; i < aBuffer.length; i++) {\n                if (aBuffer[i] !== bBuffer[i])\n                    return false;\n            }\n            return true;\n        }\n        // Swap\n        if (bBuffer.length === 4) {\n            const t = bBuffer;\n            bBuffer = aBuffer;\n            aBuffer = t;\n        }\n        // a - IPv4, b - IPv6\n        for (let i = 0; i < 10; i++) {\n            if (bBuffer[i] !== 0)\n                return false;\n        }\n        const word = bBuffer.readUInt16BE(10);\n        if (word !== 0 && word !== 0xffff)\n            return false;\n        for (let i = 0; i < 4; i++) {\n            if (aBuffer[i] !== bBuffer[i + 12])\n                return false;\n        }\n        return true;\n    },\n    toLong: function (ip) {\n        let ipl = 0;\n        ip.split('.').forEach(function (octet) {\n            ipl <<= 8;\n            ipl += parseInt(octet);\n        });\n        return ipl >>> 0;\n    },\n    fromLong: function (ipl) {\n        return (ipl >>> 24) + '.' + ((ipl >> 16) & 255) + '.' + ((ipl >> 8) & 255) + '.' + (ipl & 255);\n    },\n};\nfunction _normalizeFamily(family) {\n    return family ? family.toLowerCase() : 'ipv4';\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/util/builtinOperators.js"],"sourcesContent":["// Copyright 2017 The casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { ip } from './ip';\nimport { minimatch } from 'minimatch';\n// regexMatch determines whether key1 matches the pattern of key2 in regular expression.\nfunction regexMatch(key1, key2) {\n    return new RegExp(key2).test(key1);\n}\n// keyMatch determines whether key1 matches the pattern of key2 (similar to RESTful path),\n// key2 can contain a *.\n// For example, '/foo/bar' matches '/foo/*'\nfunction keyMatch(key1, key2) {\n    const pos = key2.indexOf('*');\n    if (pos === -1) {\n        return key1 === key2;\n    }\n    if (key1.length > pos) {\n        return key1.slice(0, pos) === key2.slice(0, pos);\n    }\n    return key1 === key2.slice(0, pos);\n}\n// keyMatchFunc is the wrapper for keyMatch.\nfunction keyMatchFunc(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return keyMatch(name1, name2);\n}\n// KeyGet returns the matched part\n// For example, \"/foo/bar/foo\" matches \"/foo/*\"\n// \"bar/foo\" will been returned\nfunction keyGet(key1, key2) {\n    const pos = key2.indexOf('*');\n    if (pos === -1) {\n        return '';\n    }\n    if (key1.length > pos) {\n        if (key1.slice(0, pos) === key2.slice(0, pos)) {\n            return key1.slice(pos, key1.length);\n        }\n    }\n    return '';\n}\n// keyGetFunc is the wrapper for keyGet.\nfunction keyGetFunc(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return keyGet(name1, name2);\n}\n// keyMatch2 determines whether key1 matches the pattern of key2 (similar to RESTful path),\n// key2 can contain a *.\n// For example, '/foo/bar' matches '/foo/*', '/resource1' matches '/:resource'\nfunction keyMatch2(key1, key2) {\n    key2 = key2.replace(/\\/\\*/g, '/.*');\n    const regexp = new RegExp(/(.*):[^/]+(.*)/g);\n    for (;;) {\n        if (!key2.includes('/:')) {\n            break;\n        }\n        key2 = key2.replace(regexp, '$1[^/]+$2');\n    }\n    if (key2 === '*') {\n        key2 = '(.*)';\n    }\n    return regexMatch(key1, '^' + key2 + '$');\n}\n// keyMatch2Func is the wrapper for keyMatch2.\nfunction keyMatch2Func(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return keyMatch2(name1, name2);\n}\n// KeyGet2 returns value matched pattern\n// For example, \"/resource1\" matches \"/:resource\"\n// if the pathVar == \"resource\", then \"resource1\" will be returned\nfunction keyGet2(key1, key2, pathVar) {\n    if (keyMatch2(key1, key2)) {\n        const re = new RegExp('[^/]+', 'g');\n        const keys = key2.match(re);\n        const values = key1.match(re);\n        if (!keys || !values) {\n            return '';\n        }\n        const index = keys.indexOf(`:${pathVar}`);\n        if (index === -1) {\n            return '';\n        }\n        return values[index];\n    }\n    else {\n        return '';\n    }\n}\nfunction keyGet2Func(...args) {\n    const [arg0, arg1, arg2] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    const name3 = (arg2 || '').toString();\n    return keyGet2(name1, name2, name3);\n}\n// keyMatch3 determines whether key1 matches the pattern of key2 (similar to RESTful path), key2 can contain a *.\n// For example, '/foo/bar' matches '/foo/*', '/resource1' matches '/{resource}'\nfunction keyMatch3(key1, key2) {\n    key2 = key2.replace(/\\/\\*/g, '/.*');\n    const regexp = new RegExp(/(.*){[^/]+}(.*)/g);\n    for (;;) {\n        if (!key2.includes('/{')) {\n            break;\n        }\n        key2 = key2.replace(regexp, '$1[^/]+$2');\n    }\n    return regexMatch(key1, '^' + key2 + '$');\n}\n// keyMatch3Func is the wrapper for keyMatch3.\nfunction keyMatch3Func(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return keyMatch3(name1, name2);\n}\n// keyMatch4 determines whether key1 matches the pattern of key2 (similar to RESTful path), key2 can contain a *.\n// Besides what keyMatch3 does, keyMatch4 can also match repeated patterns:\n// \"/parent/123/child/123\" matches \"/parent/{id}/child/{id}\"\n// \"/parent/123/child/456\" does not match \"/parent/{id}/child/{id}\"\n// But keyMatch3 will match both.\nfunction keyMatch4(key1, key2) {\n    key2 = key2.replace(/\\/\\*/g, '/.*');\n    const tokens = [];\n    let j = -1;\n    for (let i = 0; i < key2.length; i++) {\n        const c = key2.charAt(i);\n        if (c === '{') {\n            j = i;\n        }\n        else if (c === '}') {\n            tokens.push(key2.substring(j, i + 1));\n        }\n    }\n    let regexp = new RegExp(/(.*){[^/]+}(.*)/g);\n    for (;;) {\n        if (!key2.includes('/{')) {\n            break;\n        }\n        key2 = key2.replace(regexp, '$1([^/]+)$2');\n    }\n    regexp = new RegExp('^' + key2 + '$');\n    let values = regexp.exec(key1);\n    if (!values) {\n        return false;\n    }\n    values = values.slice(1);\n    if (tokens.length !== values.length) {\n        throw new Error('KeyMatch4: number of tokens is not equal to number of values');\n    }\n    const m = new Map();\n    tokens.forEach((n, index) => {\n        const key = tokens[index];\n        let v = m.get(key);\n        if (!v) {\n            v = [];\n        }\n        if (values) {\n            v.push(values[index]);\n        }\n        m.set(key, v);\n    });\n    for (const value of m.values()) {\n        if (value.length > 1) {\n            for (let i = 1; i < values.length; i++) {\n                if (values[i] !== values[0]) {\n                    return false;\n                }\n            }\n        }\n    }\n    return true;\n}\n// keyMatch4Func is the wrapper for keyMatch4.\nfunction keyMatch4Func(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return keyMatch4(name1, name2);\n}\n// KeyMatch determines whether key1 matches the pattern of key2 and ignores the parameters in key2.\n// For example, \"/foo/bar?status=1&type=2\" matches \"/foo/bar\"\nfunction KeyMatch5(key1, key2) {\n    const i = key1.indexOf('?');\n    if (i !== -1) {\n        key1 = key1.slice(0, i);\n    }\n    key2 = key2.replace(/\\/\\*/g, '/.*');\n    const regexp = new RegExp(/(.*){[^/]+}(.*)/g);\n    for (;;) {\n        if (!key2.includes('/{')) {\n            break;\n        }\n        key2 = key2.replace(regexp, '$1[^/]+$2');\n    }\n    return regexMatch(key1, '^' + key2 + '$');\n}\n// keyMatch5Func is the wrapper for KeyMatch5.\nfunction keyMatch5Func(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return KeyMatch5(name1, name2);\n}\n// regexMatchFunc is the wrapper for regexMatch.\nfunction regexMatchFunc(...args) {\n    const [arg0, arg1] = args;\n    const name1 = (arg0 || '').toString();\n    const name2 = (arg1 || '').toString();\n    return regexMatch(name1, name2);\n}\n// ipMatch determines whether IP address ip1 matches the pattern of IP address ip2,\n// ip2 can be an IP address or a CIDR pattern.\n// For example, '192.168.2.123' matches '192.168.2.0/24'\nfunction ipMatch(ip1, ip2) {\n    // check ip1\n    if (!(ip.isV4Format(ip1) || ip.isV6Format(ip1))) {\n        throw new Error('invalid argument: ip1 in ipMatch() function is not an IP address.');\n    }\n    // check ip2\n    const cidrParts = ip2.split('/');\n    if (cidrParts.length === 2) {\n        return ip.cidrSubnet(ip2).contains(ip1);\n    }\n    else {\n        if (!(ip.isV4Format(ip2) || ip.isV6Format(ip2))) {\n            console.log(ip2);\n            throw new Error('invalid argument: ip2 in ipMatch() function is not an IP address.');\n        }\n        return ip.isEqual(ip1, ip2);\n    }\n}\n// ipMatchFunc is the wrapper for ipMatch.\nfunction ipMatchFunc(...args) {\n    const [arg0, arg1] = args;\n    const ip1 = (arg0 || '').toString();\n    const ip2 = (arg1 || '').toString();\n    return ipMatch(ip1, ip2);\n}\n/**\n * Returns true if the specified `string` matches the given glob `pattern`.\n *\n * @param string String to match\n * @param pattern Glob pattern to use for matching.\n * @returns Returns true if the string matches the glob pattern.\n *\n * @example\n * ```javascript\n * globMatch(\"abc.conf\", \"*.conf\") => true\n * ```\n */\nfunction globMatch(string, pattern) {\n    // The minimatch doesn't support the pattern starts with *\n    // See https://github.com/isaacs/minimatch/issues/195\n    if (pattern[0] === '*' && pattern[1] === '/') {\n        pattern = pattern.substring(1);\n    }\n    return minimatch(string, pattern);\n}\n// generateGFunction is the factory method of the g(_, _) function.\nfunction generateGFunction(rm) {\n    const memorized = new Map();\n    return async function (...args) {\n        const key = args.toString();\n        let value = memorized.get(key);\n        if (value) {\n            return value;\n        }\n        const [arg0, arg1] = args;\n        const name1 = (arg0 || '').toString();\n        const name2 = (arg1 || '').toString();\n        if (!rm) {\n            value = name1 === name2;\n        }\n        else if (args.length === 2) {\n            value = await rm.hasLink(name1, name2);\n        }\n        else {\n            const domain = args[2].toString();\n            value = await rm.hasLink(name1, name2, domain);\n        }\n        memorized.set(key, value);\n        return value;\n    };\n}\n// generateSyncedGFunction is the synchronous factory method of the g(_, _) function.\nfunction generateSyncedGFunction(rm) {\n    const memorized = new Map();\n    return function (...args) {\n        const key = args.toString();\n        let value = memorized.get(key);\n        if (value) {\n            return value;\n        }\n        const [arg0, arg1] = args;\n        const name1 = (arg0 || '').toString();\n        const name2 = (arg1 || '').toString();\n        if (!rm) {\n            value = name1 === name2;\n        }\n        else if (!(rm === null || rm === void 0 ? void 0 : rm.syncedHasLink)) {\n            throw new Error('RoleManager requires syncedHasLink for synchronous execution');\n        }\n        else if (args.length === 2) {\n            value = rm.syncedHasLink(name1, name2);\n        }\n        else {\n            const domain = args[2].toString();\n            value = rm.syncedHasLink(name1, name2, domain);\n        }\n        memorized.set(key, value);\n        return value;\n    };\n}\nexport { keyMatchFunc, keyGetFunc, keyMatch2Func, keyGet2Func, keyMatch3Func, regexMatchFunc, ipMatchFunc, generateSyncedGFunction, generateGFunction, keyMatch4Func, keyMatch5Func, globMatch, };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 615, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/adapter.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 634, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/helper.js"],"sourcesContent":["import { parse } from 'csv-parse/sync';\nexport class BasicCsvParser {\n    parse(line) {\n        if (!line || line.trimStart().charAt(0) === '#') {\n            return null;\n        }\n        return parse(line, {\n            delimiter: ',',\n            skip_empty_lines: true,\n            trim: true,\n            relax_quotes: true,\n        });\n    }\n}\nexport class BracketAwareCsvParser {\n    constructor(baseParser = new BasicCsvParser()) {\n        this.baseParser = baseParser;\n    }\n    parse(line) {\n        const rawTokens = this.baseParser.parse(line);\n        if (!rawTokens || !rawTokens[0]) {\n            return null;\n        }\n        const tokens = rawTokens[0];\n        const processedTokens = [];\n        let currentToken = '';\n        let bracketCount = 0;\n        for (const token of tokens) {\n            for (const char of token) {\n                if (char === '(')\n                    bracketCount++;\n                else if (char === ')')\n                    bracketCount--;\n            }\n            currentToken += (currentToken ? ',' : '') + token;\n            if (bracketCount === 0) {\n                processedTokens.push(currentToken);\n                currentToken = '';\n            }\n        }\n        if (bracketCount !== 0) {\n            throw new Error(`Unmatched brackets in policy line: ${line}`);\n        }\n        return processedTokens.length > 0 ? [processedTokens] : null;\n    }\n}\nexport class PolicyLoader {\n    constructor(parser = new BracketAwareCsvParser()) {\n        this.parser = parser;\n    }\n    loadPolicyLine(line, model) {\n        const tokens = this.parser.parse(line);\n        if (!tokens || !tokens[0]) {\n            return;\n        }\n        let key = tokens[0][0].trim();\n        if (key.startsWith('\"') && key.endsWith('\"')) {\n            key = key.slice(1, -1);\n        }\n        const sec = key.substring(0, 1);\n        const item = model.model.get(sec);\n        if (!item) {\n            return;\n        }\n        const policy = item.get(key);\n        if (!policy) {\n            return;\n        }\n        const values = tokens[0].slice(1).map((v) => {\n            if (v.startsWith('\"') && v.endsWith('\"')) {\n                v = v.slice(1, -1);\n            }\n            return v.replace(/\"\"/g, '\"').trim();\n        });\n        policy.policy.push(values);\n    }\n}\nexport class Helper {\n    static loadPolicyLine(line, model) {\n        Helper.policyLoader.loadPolicyLine(line, model);\n    }\n}\nHelper.policyLoader = new PolicyLoader();\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AACO,MAAM;IACT,MAAM,IAAI,EAAE;QACR,IAAI,CAAC,QAAQ,KAAK,SAAS,GAAG,MAAM,CAAC,OAAO,KAAK;YAC7C,OAAO;QACX;QACA,OAAO,IAAA,qLAAK,EAAC,MAAM;YACf,WAAW;YACX,kBAAkB;YAClB,MAAM;YACN,cAAc;QAClB;IACJ;AACJ;AACO,MAAM;IACT,YAAY,aAAa,IAAI,gBAAgB,CAAE;QAC3C,IAAI,CAAC,UAAU,GAAG;IACtB;IACA,MAAM,IAAI,EAAE;QACR,MAAM,YAAY,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;QACxC,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,EAAE,EAAE;YAC7B,OAAO;QACX;QACA,MAAM,SAAS,SAAS,CAAC,EAAE;QAC3B,MAAM,kBAAkB,EAAE;QAC1B,IAAI,eAAe;QACnB,IAAI,eAAe;QACnB,KAAK,MAAM,SAAS,OAAQ;YACxB,KAAK,MAAM,QAAQ,MAAO;gBACtB,IAAI,SAAS,KACT;qBACC,IAAI,SAAS,KACd;YACR;YACA,gBAAgB,CAAC,eAAe,MAAM,EAAE,IAAI;YAC5C,IAAI,iBAAiB,GAAG;gBACpB,gBAAgB,IAAI,CAAC;gBACrB,eAAe;YACnB;QACJ;QACA,IAAI,iBAAiB,GAAG;YACpB,MAAM,IAAI,MAAM,CAAC,mCAAmC,EAAE,MAAM;QAChE;QACA,OAAO,gBAAgB,MAAM,GAAG,IAAI;YAAC;SAAgB,GAAG;IAC5D;AACJ;AACO,MAAM;IACT,YAAY,SAAS,IAAI,uBAAuB,CAAE;QAC9C,IAAI,CAAC,MAAM,GAAG;IAClB;IACA,eAAe,IAAI,EAAE,KAAK,EAAE;QACxB,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE,EAAE;YACvB;QACJ;QACA,IAAI,MAAM,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI;QAC3B,IAAI,IAAI,UAAU,CAAC,QAAQ,IAAI,QAAQ,CAAC,MAAM;YAC1C,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC;QACxB;QACA,MAAM,MAAM,IAAI,SAAS,CAAC,GAAG;QAC7B,MAAM,OAAO,MAAM,KAAK,CAAC,GAAG,CAAC;QAC7B,IAAI,CAAC,MAAM;YACP;QACJ;QACA,MAAM,SAAS,KAAK,GAAG,CAAC;QACxB,IAAI,CAAC,QAAQ;YACT;QACJ;QACA,MAAM,SAAS,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC;YACnC,IAAI,EAAE,UAAU,CAAC,QAAQ,EAAE,QAAQ,CAAC,MAAM;gBACtC,IAAI,EAAE,KAAK,CAAC,GAAG,CAAC;YACpB;YACA,OAAO,EAAE,OAAO,CAAC,OAAO,KAAK,IAAI;QACrC;QACA,OAAO,MAAM,CAAC,IAAI,CAAC;IACvB;AACJ;AACO,MAAM;IACT,OAAO,eAAe,IAAI,EAAE,KAAK,EAAE;QAC/B,OAAO,YAAY,CAAC,cAAc,CAAC,MAAM;IAC7C;AACJ;AACA,OAAO,YAAY,GAAG,IAAI","ignoreList":[0]}},
    {"offset": {"line": 732, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/fileSystem.js"],"sourcesContent":["let defaultFileSystem = undefined;\nconst ErrorNoFileSystem = new Error('please set the default FileSystem by call the setDefaultFileSystem');\nexport const setDefaultFileSystem = (fs) => {\n    defaultFileSystem = fs;\n};\nexport const getDefaultFileSystem = () => defaultFileSystem;\nexport const mustGetDefaultFileSystem = () => {\n    if (defaultFileSystem) {\n        return defaultFileSystem;\n    }\n    throw ErrorNoFileSystem;\n};\n"],"names":[],"mappings":";;;;;;;;AAAA,IAAI,oBAAoB;AACxB,MAAM,oBAAoB,IAAI,MAAM;AAC7B,MAAM,uBAAuB,CAAC;IACjC,oBAAoB;AACxB;AACO,MAAM,uBAAuB,IAAM;AACnC,MAAM,2BAA2B;IACpC,IAAI,mBAAmB;QACnB,OAAO;IACX;IACA,MAAM;AACV","ignoreList":[0]}},
    {"offset": {"line": 756, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/fileAdapter.js"],"sourcesContent":["import { Helper } from './helper';\nimport { arrayToString } from '../util';\nimport { mustGetDefaultFileSystem } from './fileSystem';\n/**\n * FileAdapter is the file adapter for Casbin.\n * It can load policy from file or save policy to file.\n */\nexport class FileAdapter {\n    /**\n     * FileAdapter is the constructor for FileAdapter.\n     *\n     * @param filePath filePath the path of the policy file.\n     * @param fs {@link FileSystem}\n     */\n    constructor(filePath, fs) {\n        this.filePath = filePath;\n        this.fs = fs;\n    }\n    async loadPolicy(model) {\n        if (!this.filePath) {\n            // throw new Error('invalid file path, file path cannot be empty');\n            return;\n        }\n        await this.loadPolicyFile(model, Helper.loadPolicyLine);\n    }\n    async loadPolicyFile(model, handler) {\n        const bodyBuf = await (this.fs ? this.fs : mustGetDefaultFileSystem()).readFileSync(this.filePath);\n        const lines = bodyBuf.toString().split('\\n');\n        lines.forEach((line) => {\n            if (!line || line.trim().startsWith('#')) {\n                return;\n            }\n            handler(line, model);\n        });\n    }\n    /**\n     * savePolicy saves all policy rules to the storage.\n     */\n    async savePolicy(model) {\n        if (!this.filePath) {\n            // throw new Error('invalid file path, file path cannot be empty');\n            return false;\n        }\n        let result = '';\n        const pList = model.model.get('p');\n        if (!pList) {\n            return false;\n        }\n        pList.forEach((n) => {\n            n.policy.forEach((m) => {\n                result += n.key + ', ';\n                result += arrayToString(m);\n                result += '\\n';\n            });\n        });\n        const gList = model.model.get('g');\n        if (!gList) {\n            return false;\n        }\n        gList.forEach((n) => {\n            n.policy.forEach((m) => {\n                result += n.key + ', ';\n                result += arrayToString(m.map((element) => this.escapeCsv(element)));\n                result += '\\n';\n            });\n        });\n        await this.savePolicyFile(result.trim());\n        return true;\n    }\n    escapeCsv(value) {\n        // If the value contains a comma, wrap it in double quotes and escape any existing double quotes\n        if (value.includes(',')) {\n            return `\"${value.replace(/\"/g, '\"\"')}\"`;\n        }\n        return value;\n    }\n    async savePolicyFile(text) {\n        (this.fs ? this.fs : mustGetDefaultFileSystem()).writeFileSync(this.filePath, text);\n    }\n    /**\n     * addPolicy adds a policy rule to the storage.\n     */\n    async addPolicy(sec, ptype, rule) {\n        throw new Error('not implemented');\n    }\n    /**\n     * addPolicies adds policy rules to the storage.\n     This is part of the Auto-Save feature.\n     */\n    async addPolicies(sec, ptype, rules) {\n        throw new Error('not implemented');\n    }\n    /**\n     * UpdatePolicy updates a policy rule from storage.\n     * This is part of the Auto-Save feature.\n     */\n    updatePolicy(sec, ptype, oldRule, newRule) {\n        throw new Error('not implemented');\n    }\n    /**\n     * removePolicy removes a policy rule from the storage.\n     */\n    async removePolicy(sec, ptype, rule) {\n        throw new Error('not implemented');\n    }\n    /**\n     * removePolicies removes policy rules from the storage.\n     * This is part of the Auto-Save feature.\n     */\n    async removePolicies(sec, ptype, rules) {\n        throw new Error('not implemented');\n    }\n    /**\n     * removeFilteredPolicy removes policy rules that match the filter from the storage.\n     */\n    async removeFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues) {\n        throw new Error('not implemented');\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 875, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/stringAdapter.js"],"sourcesContent":["import { Helper } from './helper';\n/**\n * StringAdapter is the string adapter for Casbin.\n * It can load policy from a string.\n */\nexport class StringAdapter {\n    /**\n     * StringAdapter is the constructor for StringAdapter.\n     * @param {string} policy policy formatted as a CSV string.\n     */\n    constructor(policy) {\n        this.policy = policy;\n    }\n    async loadPolicy(model) {\n        if (!this.policy) {\n            throw new Error('Invalid policy, policy document cannot be false-y');\n        }\n        await this.loadRules(model, Helper.loadPolicyLine);\n    }\n    async loadRules(model, handler) {\n        const rules = this.policy.split('\\n');\n        rules.forEach((n, index) => {\n            if (!n) {\n                return;\n            }\n            handler(n, model);\n        });\n    }\n    /**\n     * savePolicy saves all policy rules to the storage.\n     */\n    async savePolicy(model) {\n        throw new Error('not implemented');\n    }\n    /**\n     * addPolicy adds a policy rule to the storage.\n     */\n    async addPolicy(sec, ptype, rule) {\n        throw new Error('not implemented');\n    }\n    /**\n     * removePolicy removes a policy rule from the storage.\n     */\n    async removePolicy(sec, ptype, rule) {\n        throw new Error('not implemented');\n    }\n    /**\n     * removeFilteredPolicy removes policy rules that match the filter from the storage.\n     */\n    async removeFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues) {\n        throw new Error('not implemented');\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAKO,MAAM;IACT;;;KAGC,GACD,YAAY,MAAM,CAAE;QAChB,IAAI,CAAC,MAAM,GAAG;IAClB;IACA,MAAM,WAAW,KAAK,EAAE;QACpB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YACd,MAAM,IAAI,MAAM;QACpB;QACA,MAAM,IAAI,CAAC,SAAS,CAAC,OAAO,oLAAM,CAAC,cAAc;IACrD;IACA,MAAM,UAAU,KAAK,EAAE,OAAO,EAAE;QAC5B,MAAM,QAAQ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;QAChC,MAAM,OAAO,CAAC,CAAC,GAAG;YACd,IAAI,CAAC,GAAG;gBACJ;YACJ;YACA,QAAQ,GAAG;QACf;IACJ;IACA;;KAEC,GACD,MAAM,WAAW,KAAK,EAAE;QACpB,MAAM,IAAI,MAAM;IACpB;IACA;;KAEC,GACD,MAAM,UAAU,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE;QAC9B,MAAM,IAAI,MAAM;IACpB;IACA;;KAEC,GACD,MAAM,aAAa,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE;QACjC,MAAM,IAAI,MAAM;IACpB;IACA;;KAEC,GACD,MAAM,qBAAqB,GAAG,EAAE,KAAK,EAAE,UAAU,EAAE,GAAG,WAAW,EAAE;QAC/D,MAAM,IAAI,MAAM;IACpB;AACJ","ignoreList":[0]}},
    {"offset": {"line": 928, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/watcher.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 947, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/watcherEx.js"],"sourcesContent":["// Copyright 2022 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 966, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 972, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/defaultFilteredAdapter.js"],"sourcesContent":["import { FileAdapter } from './fileAdapter';\nimport { Helper } from './helper';\nimport { readFile } from '../util';\nexport class Filter {\n    constructor() {\n        this.g = [];\n        this.p = [];\n    }\n}\nexport class DefaultFilteredAdapter extends FileAdapter {\n    constructor(filePath) {\n        super(filePath);\n        this.filtered = false;\n    }\n    // loadPolicy loads all policy rules from the storage.\n    async loadPolicy(model) {\n        this.filtered = false;\n        await super.loadPolicy(model);\n    }\n    async loadFilteredPolicy(model, filter) {\n        if (!filter) {\n            await this.loadPolicy(model);\n            return;\n        }\n        if (!this.filePath) {\n            throw new Error('invalid file path, file path cannot be empty');\n        }\n        await this.loadFilteredPolicyFile(model, filter, Helper.loadPolicyLine);\n        this.filtered = true;\n    }\n    async loadFilteredPolicyFile(model, filter, handler) {\n        const bodyBuf = await readFile(this.filePath);\n        const lines = bodyBuf.toString().split('\\n');\n        lines.forEach((n, index) => {\n            const line = n;\n            if (!line || DefaultFilteredAdapter.filterLine(line, filter)) {\n                return;\n            }\n            handler(line, model);\n        });\n    }\n    isFiltered() {\n        return this.filtered;\n    }\n    async savePolicy(model) {\n        if (this.filtered) {\n            throw new Error('cannot save a filtered policy');\n        }\n        await super.savePolicy(model);\n        return true;\n    }\n    static filterLine(line, filter) {\n        if (!filter) {\n            return false;\n        }\n        const p = line.split(',');\n        if (p.length === 0) {\n            return true;\n        }\n        let filterSlice = [];\n        switch (p[0].trim()) {\n            case 'p':\n                filterSlice = filter.p;\n                break;\n            case 'g':\n                filterSlice = filter.g;\n                break;\n        }\n        return DefaultFilteredAdapter.filterWords(p, filterSlice);\n    }\n    static filterWords(line, filter) {\n        if (line.length < filter.length + 1) {\n            return true;\n        }\n        let skipLine = false;\n        for (let i = 0; i < filter.length; i++) {\n            if (filter[i] && filter[i] !== filter[i + 1]) {\n                skipLine = true;\n                break;\n            }\n        }\n        return skipLine;\n    }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AAAA;;;;AACO,MAAM;IACT,aAAc;QACV,IAAI,CAAC,CAAC,GAAG,EAAE;QACX,IAAI,CAAC,CAAC,GAAG,EAAE;IACf;AACJ;AACO,MAAM,+BAA+B,8LAAW;IACnD,YAAY,QAAQ,CAAE;QAClB,KAAK,CAAC;QACN,IAAI,CAAC,QAAQ,GAAG;IACpB;IACA,sDAAsD;IACtD,MAAM,WAAW,KAAK,EAAE;QACpB,IAAI,CAAC,QAAQ,GAAG;QAChB,MAAM,KAAK,CAAC,WAAW;IAC3B;IACA,MAAM,mBAAmB,KAAK,EAAE,MAAM,EAAE;QACpC,IAAI,CAAC,QAAQ;YACT,MAAM,IAAI,CAAC,UAAU,CAAC;YACtB;QACJ;QACA,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAChB,MAAM,IAAI,MAAM;QACpB;QACA,MAAM,IAAI,CAAC,sBAAsB,CAAC,OAAO,QAAQ,oLAAM,CAAC,cAAc;QACtE,IAAI,CAAC,QAAQ,GAAG;IACpB;IACA,MAAM,uBAAuB,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;QACjD,MAAM,UAAU,MAAM,IAAA,iLAAQ,EAAC,IAAI,CAAC,QAAQ;QAC5C,MAAM,QAAQ,QAAQ,QAAQ,GAAG,KAAK,CAAC;QACvC,MAAM,OAAO,CAAC,CAAC,GAAG;YACd,MAAM,OAAO;YACb,IAAI,CAAC,QAAQ,uBAAuB,UAAU,CAAC,MAAM,SAAS;gBAC1D;YACJ;YACA,QAAQ,MAAM;QAClB;IACJ;IACA,aAAa;QACT,OAAO,IAAI,CAAC,QAAQ;IACxB;IACA,MAAM,WAAW,KAAK,EAAE;QACpB,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,MAAM,IAAI,MAAM;QACpB;QACA,MAAM,KAAK,CAAC,WAAW;QACvB,OAAO;IACX;IACA,OAAO,WAAW,IAAI,EAAE,MAAM,EAAE;QAC5B,IAAI,CAAC,QAAQ;YACT,OAAO;QACX;QACA,MAAM,IAAI,KAAK,KAAK,CAAC;QACrB,IAAI,EAAE,MAAM,KAAK,GAAG;YAChB,OAAO;QACX;QACA,IAAI,cAAc,EAAE;QACpB,OAAQ,CAAC,CAAC,EAAE,CAAC,IAAI;YACb,KAAK;gBACD,cAAc,OAAO,CAAC;gBACtB;YACJ,KAAK;gBACD,cAAc,OAAO,CAAC;gBACtB;QACR;QACA,OAAO,uBAAuB,WAAW,CAAC,GAAG;IACjD;IACA,OAAO,YAAY,IAAI,EAAE,MAAM,EAAE;QAC7B,IAAI,KAAK,MAAM,GAAG,OAAO,MAAM,GAAG,GAAG;YACjC,OAAO;QACX;QACA,IAAI,WAAW;QACf,IAAK,IAAI,IAAI,GAAG,IAAI,OAAO,MAAM,EAAE,IAAK;YACpC,IAAI,MAAM,CAAC,EAAE,IAAI,MAAM,CAAC,EAAE,KAAK,MAAM,CAAC,IAAI,EAAE,EAAE;gBAC1C,WAAW;gBACX;YACJ;QACJ;QACA,OAAO;IACX;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1070, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1076, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/batchFileAdapter.js"],"sourcesContent":["import { FileAdapter } from './fileAdapter';\n/**\n * BatchFileAdapter is the file adapter for Casbin.\n * It can add policies and remove policies.\n * @deprecated The class should not be used, you should use FileAdapter.\n */\nexport class BatchFileAdapter extends FileAdapter {\n    /**\n     * FileAdapter is the constructor for FileAdapter.\n     * @param {string} filePath filePath the path of the policy file.\n     */\n    constructor(filePath) {\n        super(filePath);\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAMO,MAAM,yBAAyB,8LAAW;IAC7C;;;KAGC,GACD,YAAY,QAAQ,CAAE;QAClB,KAAK,CAAC;IACV;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1094, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/updatableAdapter.js"],"sourcesContent":["// Copyright 2021 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 1113, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/persist/index.js"],"sourcesContent":["export * from './adapter';\nexport * from './fileAdapter';\nexport * from './stringAdapter';\nexport * from './helper';\nexport * from './watcher';\nexport * from './watcherEx';\nexport * from './filteredAdapter';\nexport * from './defaultFilteredAdapter';\nexport * from './batchAdapter';\nexport * from './batchFileAdapter';\nexport * from './updatableAdapter';\nexport * from './fileSystem';\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 1142, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/util/util.js"],"sourcesContent":["// Copyright 2017 The casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the 'License');\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an 'AS IS' BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n// escapeAssertion escapes the dots in the assertion,\n// because the expression evaluation doesn't support such variable names.\nimport { mustGetDefaultFileSystem } from '../persist';\nconst escapeAssertionReg = new RegExp(/([()\\s|&,=!><+\\-*/]|^)((r|p)[0-9]*)\\./g);\nfunction escapeAssertion(s) {\n    s = s.replace(escapeAssertionReg, (match) => {\n        // Replace only the last dot with underscore (preserve the prefix character)\n        const lastDotIdx = match.lastIndexOf('.');\n        if (lastDotIdx > 0) {\n            return match.substring(0, lastDotIdx) + '_';\n        }\n        return match;\n    });\n    return s;\n}\n// removeComments removes the comments starting with # in the text.\nfunction removeComments(s) {\n    const pos = s.indexOf('#');\n    return pos > -1 ? s.slice(0, pos).trim() : s;\n}\n// arrayEquals determines whether two string arrays are identical.\nfunction arrayEquals(a = [], b = []) {\n    const aLen = a.length;\n    const bLen = b.length;\n    if (aLen !== bLen) {\n        return false;\n    }\n    for (let i = 0; i < aLen; i++) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n// array2DEquals determines whether two 2-dimensional string arrays are identical.\nfunction array2DEquals(a = [], b = []) {\n    const aLen = a.length;\n    const bLen = a.length;\n    if (aLen !== bLen) {\n        return false;\n    }\n    for (let i = 0; i < aLen; i++) {\n        if (!arrayEquals(a[i], b[i])) {\n            return false;\n        }\n    }\n    return true;\n}\n// arrayRemoveDuplicates removes any duplicated elements in a string array.\nfunction arrayRemoveDuplicates(s) {\n    return [...new Set(s)];\n}\n// arrayToString gets a printable string for a string array.\nfunction arrayToString(a) {\n    return a.join(', ');\n}\n// paramsToString gets a printable string for variable number of parameters.\nfunction paramsToString(...v) {\n    return v.join(', ');\n}\n// setEquals determines whether two string sets are identical.\nfunction setEquals(a, b) {\n    return arrayEquals(a.sort(), b.sort());\n}\n// readFile return a promise for readFile.\nfunction readFile(path, encoding) {\n    const fs = mustGetDefaultFileSystem();\n    return new Promise((resolve, reject) => {\n        try {\n            const content = fs.readFileSync(path, encoding || 'utf8');\n            resolve(content);\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n}\n// writeFile return a promise for writeFile.\nfunction writeFile(path, file, encoding) {\n    const fs = mustGetDefaultFileSystem();\n    return new Promise((resolve, reject) => {\n        try {\n            fs.writeFileSync(path, file, encoding || 'utf-8');\n            resolve();\n        }\n        catch (e) {\n            reject(e);\n        }\n    });\n}\nconst evalRegG = new RegExp(/\\beval\\(([^),]*)\\)/g);\nconst evalReg = new RegExp(/\\beval\\(([^),]*)\\)/);\n// hasEval determine whether matcher contains function eval\nfunction hasEval(s) {\n    return evalReg.test(s);\n}\n// replaceEval replace function eval with the value of its parameters\nfunction replaceEval(s, ruleName, rule) {\n    return s.replace(`eval(${ruleName})`, '(' + rule + ')');\n}\n// getEvalValue returns the parameters of function eval\nfunction getEvalValue(s) {\n    const subMatch = s.match(evalRegG);\n    const rules = [];\n    if (!subMatch) {\n        return [];\n    }\n    for (const rule of subMatch) {\n        const index = rule.indexOf('(');\n        rules.push(rule.slice(index + 1, -1));\n    }\n    return rules;\n}\n// generatorRunSync handle generator function in Sync model and return value which is not Promise\nfunction generatorRunSync(iterator) {\n    let { value, done } = iterator.next();\n    while (true) {\n        if (value instanceof Promise) {\n            throw new Error('cannot handle Promise in generatorRunSync, Please use generatorRunAsync');\n        }\n        if (!done) {\n            const temp = value;\n            ({ value, done } = iterator.next(temp));\n        }\n        else {\n            return value;\n        }\n    }\n}\n// generatorRunAsync handle generator function in Async model and return Promise\nasync function generatorRunAsync(iterator) {\n    let { value, done } = iterator.next();\n    while (true) {\n        if (!done) {\n            const temp = await value;\n            ({ value, done } = iterator.next(temp));\n        }\n        else {\n            return value;\n        }\n    }\n}\nfunction deepCopy(obj) {\n    if (typeof obj !== 'object')\n        return;\n    const newObj = obj instanceof Array ? [] : {};\n    for (const key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            newObj[key] = typeof obj[key] === 'object' ? deepCopy(obj[key]) : obj[key];\n        }\n    }\n    return newObj;\n}\nfunction customIn(a, b) {\n    if (b instanceof Array) {\n        return b.includes(a);\n    }\n    return (a in b);\n}\nfunction bracketCompatible(exp) {\n    // TODO: This function didn't support nested bracket.\n    if (!(exp.includes(' in ') && exp.includes(' ('))) {\n        return exp;\n    }\n    const re = / \\([^)]*\\)/g;\n    const array = exp.split('');\n    let reResult;\n    while ((reResult = re.exec(exp)) !== null) {\n        if (!reResult[0].includes(',')) {\n            continue;\n        }\n        array[reResult.index + 1] = '[';\n        array[re.lastIndex - 1] = ']';\n    }\n    exp = array.join('');\n    return exp;\n}\nexport { escapeAssertion, removeComments, arrayEquals, array2DEquals, arrayRemoveDuplicates, arrayToString, paramsToString, setEquals, readFile, writeFile, hasEval, replaceEval, getEvalValue, generatorRunSync, generatorRunAsync, deepCopy, customIn, bracketCompatible, };\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 1374, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/util/index.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport * from './builtinOperators';\nexport * from './util';\n"],"names":[],"mappings":";AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AACA","ignoreList":[0]}},
    {"offset": {"line": 1465, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/config.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { mustGetDefaultFileSystem } from './persist';\nexport class Config {\n    constructor(fs) {\n        this.data = new Map();\n        if (fs) {\n            this.fs = fs;\n        }\n    }\n    /**\n     * newConfig create an empty configuration representation from file.\n     *\n     * @param confName the path of the model file.\n     * @return the constructor of Config.\n     * @deprecated use {@link newConfigFromFile} instead.\n     */\n    static newConfig(confName) {\n        return this.newConfigFromFile(confName);\n    }\n    /**\n     * newConfigFromFile create an empty configuration representation from file.\n     * @param path the path of the model file.\n     * @param fs {@link FileSystem}\n     */\n    static newConfigFromFile(path, fs) {\n        const config = new Config(fs);\n        config.parse(path);\n        return config;\n    }\n    /**\n     * newConfigFromText create an empty configuration representation from text.\n     *\n     * @param text the model text.\n     * @return the constructor of Config.\n     */\n    static newConfigFromText(text) {\n        const config = new Config();\n        config.parseBuffer(Buffer.from(text));\n        return config;\n    }\n    /**\n     * addConfig adds a new section->key:value to the configuration.\n     */\n    addConfig(section, option, value) {\n        if (section === '') {\n            section = Config.DEFAULT_SECTION;\n        }\n        const hasKey = this.data.has(section);\n        if (!hasKey) {\n            this.data.set(section, new Map());\n        }\n        const item = this.data.get(section);\n        if (item) {\n            item.set(option, value);\n            return item.has(option);\n        }\n        else {\n            return false;\n        }\n    }\n    parse(path) {\n        const body = (this.fs ? this.fs : mustGetDefaultFileSystem()).readFileSync(path);\n        this.parseBuffer(Buffer.isBuffer(body) ? body : Buffer.from(body));\n    }\n    parseBuffer(buf) {\n        const lines = buf\n            .toString()\n            .split('\\n')\n            .filter((v) => v);\n        const linesCount = lines.length;\n        let section = '';\n        let currentLine = '';\n        const seenSections = new Set();\n        lines.forEach((n, index) => {\n            let commentPos = n.indexOf(Config.DEFAULT_COMMENT);\n            if (commentPos > -1) {\n                n = n.slice(0, commentPos);\n            }\n            commentPos = n.indexOf(Config.DEFAULT_COMMENT_SEM);\n            if (commentPos > -1) {\n                n = n.slice(0, commentPos);\n            }\n            const line = n.trim();\n            if (!line) {\n                return;\n            }\n            const lineNumber = index + 1;\n            if (line.startsWith('[') && line.endsWith(']')) {\n                if (currentLine.length !== 0) {\n                    this.write(section, lineNumber - 1, currentLine);\n                    currentLine = '';\n                }\n                section = line.substring(1, line.length - 1);\n                if (seenSections.has(section)) {\n                    throw new Error(`Duplicated section: ${section} at line ${lineNumber}`);\n                }\n                seenSections.add(section);\n            }\n            else {\n                let shouldWrite = false;\n                if (line.endsWith(Config.DEFAULT_MULTI_LINE_SEPARATOR)) {\n                    currentLine += line.substring(0, line.length - 1).trim();\n                }\n                else {\n                    currentLine += line;\n                    shouldWrite = true;\n                }\n                if (shouldWrite || lineNumber === linesCount) {\n                    this.write(section, lineNumber, currentLine);\n                    currentLine = '';\n                }\n            }\n        });\n    }\n    write(section, lineNum, line) {\n        const equalIndex = line.indexOf('=');\n        if (equalIndex === -1) {\n            throw new Error(`parse the content error : line ${lineNum}`);\n        }\n        const key = line.substring(0, equalIndex);\n        const value = line.substring(equalIndex + 1);\n        this.addConfig(section, key.trim(), value.trim());\n    }\n    getBool(key) {\n        return !!this.get(key);\n    }\n    getInt(key) {\n        return Number.parseInt(this.get(key), 10);\n    }\n    getFloat(key) {\n        return Number.parseFloat(this.get(key));\n    }\n    getString(key) {\n        return this.get(key);\n    }\n    getStrings(key) {\n        const v = this.get(key);\n        return v.split(',');\n    }\n    set(key, value) {\n        if (!key) {\n            throw new Error('key is empty');\n        }\n        let section = '';\n        let option;\n        const keys = key.toLowerCase().split('::');\n        if (keys.length >= 2) {\n            section = keys[0];\n            option = keys[1];\n        }\n        else {\n            option = keys[0];\n        }\n        this.addConfig(section, option, value);\n    }\n    get(key) {\n        let section;\n        let option;\n        const keys = key.toLowerCase().split('::');\n        if (keys.length >= 2) {\n            section = keys[0];\n            option = keys[1];\n        }\n        else {\n            section = Config.DEFAULT_SECTION;\n            option = keys[0];\n        }\n        const item = this.data.get(section);\n        const itemChild = item && item.get(option);\n        return itemChild ? itemChild : '';\n    }\n}\nConfig.DEFAULT_SECTION = 'default';\nConfig.DEFAULT_COMMENT = '#';\nConfig.DEFAULT_COMMENT_SEM = ';';\nConfig.DEFAULT_MULTI_LINE_SEPARATOR = '\\\\';\n"],"names":[],"mappings":";;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AAAA;;AACO,MAAM;IACT,YAAY,EAAE,CAAE;QACZ,IAAI,CAAC,IAAI,GAAG,IAAI;QAChB,IAAI,IAAI;YACJ,IAAI,CAAC,EAAE,GAAG;QACd;IACJ;IACA;;;;;;KAMC,GACD,OAAO,UAAU,QAAQ,EAAE;QACvB,OAAO,IAAI,CAAC,iBAAiB,CAAC;IAClC;IACA;;;;KAIC,GACD,OAAO,kBAAkB,IAAI,EAAE,EAAE,EAAE;QAC/B,MAAM,SAAS,IAAI,OAAO;QAC1B,OAAO,KAAK,CAAC;QACb,OAAO;IACX;IACA;;;;;KAKC,GACD,OAAO,kBAAkB,IAAI,EAAE;QAC3B,MAAM,SAAS,IAAI;QACnB,OAAO,WAAW,CAAC,OAAO,IAAI,CAAC;QAC/B,OAAO;IACX;IACA;;KAEC,GACD,UAAU,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE;QAC9B,IAAI,YAAY,IAAI;YAChB,UAAU,OAAO,eAAe;QACpC;QACA,MAAM,SAAS,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QAC7B,IAAI,CAAC,QAAQ;YACT,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,IAAI;QAC/B;QACA,MAAM,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QAC3B,IAAI,MAAM;YACN,KAAK,GAAG,CAAC,QAAQ;YACjB,OAAO,KAAK,GAAG,CAAC;QACpB,OACK;YACD,OAAO;QACX;IACJ;IACA,MAAM,IAAI,EAAE;QACR,MAAM,OAAO,CAAC,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,GAAG,IAAA,0MAAwB,GAAE,EAAE,YAAY,CAAC;QAC3E,IAAI,CAAC,WAAW,CAAC,OAAO,QAAQ,CAAC,QAAQ,OAAO,OAAO,IAAI,CAAC;IAChE;IACA,YAAY,GAAG,EAAE;QACb,MAAM,QAAQ,IACT,QAAQ,GACR,KAAK,CAAC,MACN,MAAM,CAAC,CAAC,IAAM;QACnB,MAAM,aAAa,MAAM,MAAM;QAC/B,IAAI,UAAU;QACd,IAAI,cAAc;QAClB,MAAM,eAAe,IAAI;QACzB,MAAM,OAAO,CAAC,CAAC,GAAG;YACd,IAAI,aAAa,EAAE,OAAO,CAAC,OAAO,eAAe;YACjD,IAAI,aAAa,CAAC,GAAG;gBACjB,IAAI,EAAE,KAAK,CAAC,GAAG;YACnB;YACA,aAAa,EAAE,OAAO,CAAC,OAAO,mBAAmB;YACjD,IAAI,aAAa,CAAC,GAAG;gBACjB,IAAI,EAAE,KAAK,CAAC,GAAG;YACnB;YACA,MAAM,OAAO,EAAE,IAAI;YACnB,IAAI,CAAC,MAAM;gBACP;YACJ;YACA,MAAM,aAAa,QAAQ;YAC3B,IAAI,KAAK,UAAU,CAAC,QAAQ,KAAK,QAAQ,CAAC,MAAM;gBAC5C,IAAI,YAAY,MAAM,KAAK,GAAG;oBAC1B,IAAI,CAAC,KAAK,CAAC,SAAS,aAAa,GAAG;oBACpC,cAAc;gBAClB;gBACA,UAAU,KAAK,SAAS,CAAC,GAAG,KAAK,MAAM,GAAG;gBAC1C,IAAI,aAAa,GAAG,CAAC,UAAU;oBAC3B,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE,QAAQ,SAAS,EAAE,YAAY;gBAC1E;gBACA,aAAa,GAAG,CAAC;YACrB,OACK;gBACD,IAAI,cAAc;gBAClB,IAAI,KAAK,QAAQ,CAAC,OAAO,4BAA4B,GAAG;oBACpD,eAAe,KAAK,SAAS,CAAC,GAAG,KAAK,MAAM,GAAG,GAAG,IAAI;gBAC1D,OACK;oBACD,eAAe;oBACf,cAAc;gBAClB;gBACA,IAAI,eAAe,eAAe,YAAY;oBAC1C,IAAI,CAAC,KAAK,CAAC,SAAS,YAAY;oBAChC,cAAc;gBAClB;YACJ;QACJ;IACJ;IACA,MAAM,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE;QAC1B,MAAM,aAAa,KAAK,OAAO,CAAC;QAChC,IAAI,eAAe,CAAC,GAAG;YACnB,MAAM,IAAI,MAAM,CAAC,+BAA+B,EAAE,SAAS;QAC/D;QACA,MAAM,MAAM,KAAK,SAAS,CAAC,GAAG;QAC9B,MAAM,QAAQ,KAAK,SAAS,CAAC,aAAa;QAC1C,IAAI,CAAC,SAAS,CAAC,SAAS,IAAI,IAAI,IAAI,MAAM,IAAI;IAClD;IACA,QAAQ,GAAG,EAAE;QACT,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;IACtB;IACA,OAAO,GAAG,EAAE;QACR,OAAO,OAAO,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM;IAC1C;IACA,SAAS,GAAG,EAAE;QACV,OAAO,OAAO,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC;IACtC;IACA,UAAU,GAAG,EAAE;QACX,OAAO,IAAI,CAAC,GAAG,CAAC;IACpB;IACA,WAAW,GAAG,EAAE;QACZ,MAAM,IAAI,IAAI,CAAC,GAAG,CAAC;QACnB,OAAO,EAAE,KAAK,CAAC;IACnB;IACA,IAAI,GAAG,EAAE,KAAK,EAAE;QACZ,IAAI,CAAC,KAAK;YACN,MAAM,IAAI,MAAM;QACpB;QACA,IAAI,UAAU;QACd,IAAI;QACJ,MAAM,OAAO,IAAI,WAAW,GAAG,KAAK,CAAC;QACrC,IAAI,KAAK,MAAM,IAAI,GAAG;YAClB,UAAU,IAAI,CAAC,EAAE;YACjB,SAAS,IAAI,CAAC,EAAE;QACpB,OACK;YACD,SAAS,IAAI,CAAC,EAAE;QACpB;QACA,IAAI,CAAC,SAAS,CAAC,SAAS,QAAQ;IACpC;IACA,IAAI,GAAG,EAAE;QACL,IAAI;QACJ,IAAI;QACJ,MAAM,OAAO,IAAI,WAAW,GAAG,KAAK,CAAC;QACrC,IAAI,KAAK,MAAM,IAAI,GAAG;YAClB,UAAU,IAAI,CAAC,EAAE;YACjB,SAAS,IAAI,CAAC,EAAE;QACpB,OACK;YACD,UAAU,OAAO,eAAe;YAChC,SAAS,IAAI,CAAC,EAAE;QACpB;QACA,MAAM,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC;QAC3B,MAAM,YAAY,QAAQ,KAAK,GAAG,CAAC;QACnC,OAAO,YAAY,YAAY;IACnC;AACJ;AACA,OAAO,eAAe,GAAG;AACzB,OAAO,eAAe,GAAG;AACzB,OAAO,mBAAmB,GAAG;AAC7B,OAAO,4BAA4B,GAAG","ignoreList":[0]}},
    {"offset": {"line": 1651, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/effect/effector.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport var Effect;\n(function (Effect) {\n    Effect[Effect[\"Allow\"] = 1] = \"Allow\";\n    Effect[Effect[\"Indeterminate\"] = 2] = \"Indeterminate\";\n    Effect[Effect[\"Deny\"] = 3] = \"Deny\";\n})(Effect || (Effect = {}));\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;;;;AAC1B,IAAI;AACX,CAAC,SAAU,MAAM;IACb,MAAM,CAAC,MAAM,CAAC,QAAQ,GAAG,EAAE,GAAG;IAC9B,MAAM,CAAC,MAAM,CAAC,gBAAgB,GAAG,EAAE,GAAG;IACtC,MAAM,CAAC,MAAM,CAAC,OAAO,GAAG,EAAE,GAAG;AACjC,CAAC,EAAE,UAAU,CAAC,SAAS,CAAC,CAAC","ignoreList":[0]}},
    {"offset": {"line": 1678, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/effect/effectorStream.js"],"sourcesContent":["// Copyright 2020 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 1697, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/effect/defaultEffectorStream.js"],"sourcesContent":["// Copyright 2020 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { Effect } from './effector';\n/**\n * DefaultEffectorStream is the default implementation of EffectorStream.\n */\nexport class DefaultEffectorStream {\n    constructor(expr) {\n        this.done = false;\n        this.res = false;\n        this.rec = false;\n        this.expr = expr;\n    }\n    current() {\n        return this.res;\n    }\n    pushEffect(eft) {\n        switch (this.expr) {\n            case \"some(where (p_eft == allow))\" /* EffectExpress.ALLOW */:\n                if (eft === Effect.Allow) {\n                    this.res = true;\n                    this.done = true;\n                    this.rec = true;\n                }\n                break;\n            case \"!some(where (p_eft == deny))\" /* EffectExpress.DENY */:\n                this.res = true;\n                if (eft === Effect.Deny) {\n                    this.res = false;\n                    this.done = true;\n                    this.rec = true;\n                }\n                break;\n            case \"some(where (p_eft == allow)) && !some(where (p_eft == deny))\" /* EffectExpress.ALLOW_AND_DENY */:\n                if (eft === Effect.Allow) {\n                    this.res = true;\n                    this.rec = true;\n                }\n                else if (eft === Effect.Deny) {\n                    this.res = false;\n                    this.done = true;\n                    this.rec = true;\n                }\n                else {\n                    this.rec = false;\n                }\n                break;\n            case \"priority(p_eft) || deny\" /* EffectExpress.PRIORITY */:\n            case \"subjectPriority(p_eft) || deny\" /* EffectExpress.SUBJECT_PRIORITY */:\n                if (eft !== Effect.Indeterminate) {\n                    this.res = eft === Effect.Allow;\n                    this.done = true;\n                    this.rec = true;\n                }\n                break;\n            default:\n                throw new Error('unsupported effect');\n        }\n        return [this.res, this.rec, this.done];\n    }\n}\n"],"names":[],"mappings":";;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;;AAIO,MAAM;IACT,YAAY,IAAI,CAAE;QACd,IAAI,CAAC,IAAI,GAAG;QACZ,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,IAAI,GAAG;IAChB;IACA,UAAU;QACN,OAAO,IAAI,CAAC,GAAG;IACnB;IACA,WAAW,GAAG,EAAE;QACZ,OAAQ,IAAI,CAAC,IAAI;YACb,KAAK,+BAA+B,uBAAuB;gBACvD,IAAI,QAAQ,qLAAM,CAAC,KAAK,EAAE;oBACtB,IAAI,CAAC,GAAG,GAAG;oBACX,IAAI,CAAC,IAAI,GAAG;oBACZ,IAAI,CAAC,GAAG,GAAG;gBACf;gBACA;YACJ,KAAK,+BAA+B,sBAAsB;gBACtD,IAAI,CAAC,GAAG,GAAG;gBACX,IAAI,QAAQ,qLAAM,CAAC,IAAI,EAAE;oBACrB,IAAI,CAAC,GAAG,GAAG;oBACX,IAAI,CAAC,IAAI,GAAG;oBACZ,IAAI,CAAC,GAAG,GAAG;gBACf;gBACA;YACJ,KAAK,+DAA+D,gCAAgC;gBAChG,IAAI,QAAQ,qLAAM,CAAC,KAAK,EAAE;oBACtB,IAAI,CAAC,GAAG,GAAG;oBACX,IAAI,CAAC,GAAG,GAAG;gBACf,OACK,IAAI,QAAQ,qLAAM,CAAC,IAAI,EAAE;oBAC1B,IAAI,CAAC,GAAG,GAAG;oBACX,IAAI,CAAC,IAAI,GAAG;oBACZ,IAAI,CAAC,GAAG,GAAG;gBACf,OACK;oBACD,IAAI,CAAC,GAAG,GAAG;gBACf;gBACA;YACJ,KAAK,0BAA0B,0BAA0B;YACzD,KAAK,iCAAiC,kCAAkC;gBACpE,IAAI,QAAQ,qLAAM,CAAC,aAAa,EAAE;oBAC9B,IAAI,CAAC,GAAG,GAAG,QAAQ,qLAAM,CAAC,KAAK;oBAC/B,IAAI,CAAC,IAAI,GAAG;oBACZ,IAAI,CAAC,GAAG,GAAG;gBACf;gBACA;YACJ;gBACI,MAAM,IAAI,MAAM;QACxB;QACA,OAAO;YAAC,IAAI,CAAC,GAAG;YAAE,IAAI,CAAC,GAAG;YAAE,IAAI,CAAC,IAAI;SAAC;IAC1C;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1777, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/effect/defaultEffector.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { DefaultEffectorStream } from './defaultEffectorStream';\n/**\n * DefaultEffector is default effector for Casbin.\n */\nexport class DefaultEffector {\n    newStream(expr) {\n        return new DefaultEffectorStream(expr);\n    }\n}\n"],"names":[],"mappings":";;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;;AAIO,MAAM;IACT,UAAU,IAAI,EAAE;QACZ,OAAO,IAAI,iNAAqB,CAAC;IACrC;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1805, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/effect/index.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport * from './effector';\nexport * from './effectorStream';\nexport * from './defaultEffector';\nexport * from './defaultEffectorStream';\n"],"names":[],"mappings":";AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AACA;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 1831, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/log/defaultLogger.js"],"sourcesContent":["// Copyright 2019 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n// DefaultLogger is the implementation for a Logger\nexport class DefaultLogger {\n    constructor() {\n        this.enable = false;\n    }\n    enableLog(enable) {\n        this.enable = enable;\n    }\n    isEnable() {\n        return this.enable;\n    }\n    print(...v) {\n        if (this.enable) {\n            console.log(...v);\n        }\n    }\n    printf(format, ...v) {\n        if (this.enable) {\n            console.log(format, ...v);\n        }\n    }\n}\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC,mDAAmD;;;;;AAC5C,MAAM;IACT,aAAc;QACV,IAAI,CAAC,MAAM,GAAG;IAClB;IACA,UAAU,MAAM,EAAE;QACd,IAAI,CAAC,MAAM,GAAG;IAClB;IACA,WAAW;QACP,OAAO,IAAI,CAAC,MAAM;IACtB;IACA,MAAM,GAAG,CAAC,EAAE;QACR,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,QAAQ,GAAG,IAAI;QACnB;IACJ;IACA,OAAO,MAAM,EAAE,GAAG,CAAC,EAAE;QACjB,IAAI,IAAI,CAAC,MAAM,EAAE;YACb,QAAQ,GAAG,CAAC,WAAW;QAC3B;IACJ;AACJ","ignoreList":[0]}},
    {"offset": {"line": 1874, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/log/logger.js"],"sourcesContent":["// Copyright 2019 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 1893, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/log/logUtil.js"],"sourcesContent":["// Copyright 2019 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { DefaultLogger } from './defaultLogger';\nlet logger = new DefaultLogger();\n// setLogger sets the current logger.\nfunction setLogger(l) {\n    logger = l;\n}\n// getLogger returns the current logger.\nfunction getLogger() {\n    return logger;\n}\n// logPrint prints the log.\nfunction logPrint(...v) {\n    logger.print(...v);\n}\n// logPrintf prints the log with the format.\nfunction logPrintf(format, ...v) {\n    logger.printf(format, ...v);\n}\nexport { setLogger, getLogger, logPrint, logPrintf };\n"],"names":[],"mappings":";;;;;;;;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;;AACA,IAAI,SAAS,IAAI,8LAAa;AAC9B,qCAAqC;AACrC,SAAS,UAAU,CAAC;IAChB,SAAS;AACb;AACA,wCAAwC;AACxC,SAAS;IACL,OAAO;AACX;AACA,2BAA2B;AAC3B,SAAS,SAAS,GAAG,CAAC;IAClB,OAAO,KAAK,IAAI;AACpB;AACA,4CAA4C;AAC5C,SAAS,UAAU,MAAM,EAAE,GAAG,CAAC;IAC3B,OAAO,MAAM,CAAC,WAAW;AAC7B","ignoreList":[0]}},
    {"offset": {"line": 1940, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/log/index.js"],"sourcesContent":["// Copyright 2019 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport * from './defaultLogger';\nexport * from './logger';\nexport * from './logUtil';\n"],"names":[],"mappings":";AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 1964, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/rbac/defaultRoleManager.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { getLogger, logPrint } from '../log';\n// DEFAULT_DOMAIN defines the default domain space.\nconst DEFAULT_DOMAIN = 'casbin::default';\n// loadOrDefault returns the existing value for the key if present.\n// Otherwise, it stores and returns the given value.\nfunction loadOrDefault(map, key, value) {\n    const read = map.get(key);\n    if (read === undefined) {\n        map.set(key, value);\n        return value;\n    }\n    return read;\n}\n/**\n * Role represents the data structure for a role in RBAC.\n */\nclass Role {\n    constructor(name) {\n        this.name = name;\n        this.roles = [];\n    }\n    addRole(role) {\n        if (this.roles.some((n) => n.name === role.name)) {\n            return;\n        }\n        this.roles.push(role);\n    }\n    deleteRole(role) {\n        this.roles = this.roles.filter((n) => n.name !== role.name);\n    }\n    hasRole(name, hierarchyLevel) {\n        if (this.name === name) {\n            return true;\n        }\n        if (hierarchyLevel <= 0) {\n            return false;\n        }\n        for (const role of this.roles) {\n            if (role.hasRole(name, hierarchyLevel - 1)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    hasDirectRole(name) {\n        return this.roles.some((n) => n.name === name);\n    }\n    toString() {\n        return this.name + this.roles.join(', ');\n    }\n    getRoles() {\n        return this.roles.map((n) => n.name);\n    }\n}\nclass Roles extends Map {\n    constructor() {\n        super();\n    }\n    hasRole(name, matchingFunc) {\n        let ok = false;\n        if (matchingFunc) {\n            this.forEach((value, key) => {\n                if (matchingFunc(name, key)) {\n                    ok = true;\n                }\n            });\n        }\n        else {\n            return this.has(name);\n        }\n        return ok;\n    }\n    createRole(name, matchingFunc) {\n        const role = loadOrDefault(this, name, new Role(name));\n        if (matchingFunc) {\n            this.forEach((value, key) => {\n                if (matchingFunc(name, key) && name !== key) {\n                    // Add new role to matching role\n                    const role1 = loadOrDefault(this, key, new Role(key));\n                    role.addRole(role1);\n                }\n            });\n        }\n        return role;\n    }\n}\n// RoleManager provides a default implementation for the RoleManager interface\nexport class DefaultRoleManager {\n    /**\n     * DefaultRoleManager is the constructor for creating an instance of the\n     * default RoleManager implementation.\n     *\n     * @param maxHierarchyLevel the maximized allowed RBAC hierarchy level.\n     */\n    constructor(maxHierarchyLevel) {\n        this.hasPattern = false;\n        this.hasDomainPattern = false;\n        this.hasDomainHierarchy = false;\n        this.allDomains = new Map();\n        this.allDomains.set(DEFAULT_DOMAIN, new Roles());\n        this.maxHierarchyLevel = maxHierarchyLevel;\n    }\n    /**\n     * addMatchingFunc support use pattern in g\n     * @param name name\n     * @param fn matching function\n     * @deprecated\n     */\n    async addMatchingFunc(name, fn) {\n        this.hasPattern = true;\n        if (typeof name === 'string' && fn) {\n            this.matchingFunc = fn;\n        }\n        else if (typeof name === 'function') {\n            this.matchingFunc = name;\n        }\n        else {\n            throw new Error('error: domain should be 1 parameter');\n        }\n    }\n    /**\n     * addDomainMatchingFunc support use domain pattern in g\n     * @param fn domain matching function\n     * ```\n     */\n    async addDomainMatchingFunc(fn) {\n        this.hasDomainPattern = true;\n        this.domainMatchingFunc = fn;\n    }\n    /**\n     * addDomainHierarchy sets a rolemanager to define role inheritance between domains\n     * @param rm RoleManager to define domain hierarchy\n     */\n    async addDomainHierarchy(rm) {\n        if (!(rm === null || rm === void 0 ? void 0 : rm.syncedHasLink))\n            throw Error('Domain hierarchy must be syncronous.');\n        this.hasDomainHierarchy = true;\n        this.domainHierarchyManager = rm;\n    }\n    generateTempRoles(domain) {\n        if (!this.hasPattern && !this.hasDomainPattern && !this.hasDomainHierarchy) {\n            return loadOrDefault(this.allDomains, domain, new Roles());\n        }\n        const extraDomain = new Set([domain]);\n        if (this.hasDomainPattern || this.hasDomainHierarchy) {\n            this.allDomains.forEach((value, key) => {\n                var _a;\n                if ((this.hasDomainPattern && this.domainMatchingFunc(domain, key)) ||\n                    (((_a = this.domainHierarchyManager) === null || _a === void 0 ? void 0 : _a.syncedHasLink) && this.domainHierarchyManager.syncedHasLink(key, domain))) {\n                    extraDomain.add(key);\n                }\n            });\n        }\n        const allRoles = new Roles();\n        extraDomain.forEach((dom) => {\n            loadOrDefault(this.allDomains, dom, new Roles()).forEach((value, key) => {\n                const role1 = allRoles.createRole(value.name, this.matchingFunc);\n                value.getRoles().forEach((n) => {\n                    role1.addRole(allRoles.createRole(n, this.matchingFunc));\n                });\n            });\n        });\n        return allRoles;\n    }\n    /**\n     * addLink adds the inheritance link between role: name1 and role: name2.\n     * aka role: name1 inherits role: name2.\n     * domain is a prefix to the roles.\n     */\n    async addLink(name1, name2, ...domain) {\n        if (domain.length === 0) {\n            domain = [DEFAULT_DOMAIN];\n        }\n        else if (domain.length > 1) {\n            throw new Error('error: domain should be 1 parameter');\n        }\n        const allRoles = loadOrDefault(this.allDomains, domain[0], new Roles());\n        const role1 = loadOrDefault(allRoles, name1, new Role(name1));\n        const role2 = loadOrDefault(allRoles, name2, new Role(name2));\n        role1.addRole(role2);\n    }\n    /**\n     * clear clears all stored data and resets the role manager to the initial state.\n     */\n    async clear() {\n        this.allDomains = new Map();\n        this.allDomains.set(DEFAULT_DOMAIN, new Roles());\n    }\n    /**\n     * deleteLink deletes the inheritance link between role: name1 and role: name2.\n     * aka role: name1 does not inherit role: name2 any more.\n     * domain is a prefix to the roles.\n     */\n    async deleteLink(name1, name2, ...domain) {\n        if (domain.length === 0) {\n            domain = [DEFAULT_DOMAIN];\n        }\n        else if (domain.length > 1) {\n            throw new Error('error: domain should be 1 parameter');\n        }\n        const allRoles = loadOrDefault(this.allDomains, domain[0], new Roles());\n        if (!allRoles.has(name1) || !allRoles.has(name2)) {\n            return;\n        }\n        const role1 = loadOrDefault(allRoles, name1, new Role(name1));\n        const role2 = loadOrDefault(allRoles, name2, new Role(name2));\n        role1.deleteRole(role2);\n    }\n    /**\n     * hasLink determines whether role: name1 inherits role: name2.\n     * domain is a prefix to the roles.\n     */\n    syncedHasLink(name1, name2, ...domain) {\n        if (domain.length === 0) {\n            domain = [DEFAULT_DOMAIN];\n        }\n        else if (domain.length > 1) {\n            throw new Error('error: domain should be 1 parameter');\n        }\n        if (name1 === name2) {\n            return true;\n        }\n        const allRoles = this.generateTempRoles(domain[0]);\n        if (!allRoles.hasRole(name1, this.matchingFunc) || !allRoles.hasRole(name2, this.matchingFunc)) {\n            return false;\n        }\n        const role1 = allRoles.createRole(name1, this.matchingFunc);\n        return role1.hasRole(name2, this.maxHierarchyLevel);\n    }\n    async hasLink(name1, name2, ...domain) {\n        return new Promise((resolve) => resolve(this.syncedHasLink(name1, name2, ...domain)));\n    }\n    /**\n     * getRoles gets the roles that a subject inherits.\n     * domain is a prefix to the roles.\n     */\n    async getRoles(name, ...domain) {\n        if (domain.length === 0) {\n            domain = [DEFAULT_DOMAIN];\n        }\n        else if (domain.length > 1) {\n            throw new Error('error: domain should be 1 parameter');\n        }\n        const allRoles = this.generateTempRoles(domain[0]);\n        if (!allRoles.hasRole(name, this.matchingFunc)) {\n            return [];\n        }\n        return allRoles.createRole(name, this.matchingFunc).getRoles();\n    }\n    /**\n     * getUsers gets the users that inherits a subject.\n     * domain is an unreferenced parameter here, may be used in other implementations.\n     */\n    async getUsers(name, ...domain) {\n        if (domain.length === 0) {\n            domain = [DEFAULT_DOMAIN];\n        }\n        else if (domain.length > 1) {\n            throw new Error('error: domain should be 1 parameter');\n        }\n        const allRoles = this.generateTempRoles(domain[0]);\n        if (!allRoles.hasRole(name, this.matchingFunc)) {\n            return [];\n        }\n        const users = [];\n        for (const user of allRoles.values()) {\n            if (user.hasDirectRole(name))\n                users.push(user.name);\n        }\n        return users;\n    }\n    /**\n     * printRoles prints all the roles to log.\n     */\n    async printRoles() {\n        if (getLogger().isEnable()) {\n            [...this.allDomains.values()].forEach((n) => {\n                logPrint(n.toString());\n            });\n        }\n    }\n    /**\n     * getDomains gets domains that a user has.\n     */\n    async getDomains(name) {\n        const domains = [];\n        this.allDomains.forEach((roles, domain) => {\n            // Skip the default domain if there are other domains\n            if (domain === DEFAULT_DOMAIN && this.allDomains.size > 1) {\n                return;\n            }\n            const role = roles.get(name);\n            if (role) {\n                // Check if role has any roles it inherits OR if any other role inherits from it\n                const hasRoles = role.getRoles().length > 0;\n                const hasUsers = this.hasUserForRole(roles, name);\n                if (hasRoles || hasUsers) {\n                    domains.push(domain);\n                }\n            }\n        });\n        return domains;\n    }\n    /**\n     * getAllDomains gets all domains.\n     */\n    async getAllDomains() {\n        const domains = Array.from(this.allDomains.keys());\n        // Filter out the default domain if there are other domains\n        if (domains.length > 1) {\n            return domains.filter((d) => d !== DEFAULT_DOMAIN);\n        }\n        return domains;\n    }\n    hasUserForRole(roles, name) {\n        for (const role of roles.values()) {\n            if (role.hasDirectRole(name)) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2298, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/rbac/roleManager.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport {};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC","ignoreList":[0]}},
    {"offset": {"line": 2317, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/rbac/index.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport * from './defaultRoleManager';\nexport * from './roleManager';\n"],"names":[],"mappings":";AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AACA","ignoreList":[0]}},
    {"offset": {"line": 2339, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/model/model.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport * as util from '../util';\nimport { Config } from '../config';\nimport { Assertion } from './assertion';\nimport { getLogger, logPrint } from '../log';\nimport { DefaultRoleManager } from '../rbac';\nconst defaultDomain = '';\nconst defaultSeparator = '::';\nexport const sectionNameMap = {\n    r: 'request_definition',\n    p: 'policy_definition',\n    g: 'role_definition',\n    e: 'policy_effect',\n    m: 'matchers',\n};\nexport var PolicyOp;\n(function (PolicyOp) {\n    PolicyOp[PolicyOp[\"PolicyAdd\"] = 0] = \"PolicyAdd\";\n    PolicyOp[PolicyOp[\"PolicyRemove\"] = 1] = \"PolicyRemove\";\n})(PolicyOp || (PolicyOp = {}));\nexport const requiredSections = ['r', 'p', 'e', 'm'];\nexport class Model {\n    /**\n     * constructor is the constructor for Model.\n     */\n    constructor() {\n        this.model = new Map();\n    }\n    loadAssertion(cfg, sec, key) {\n        const secName = sectionNameMap[sec];\n        const value = cfg.getString(`${secName}::${key}`);\n        return this.addDef(sec, key, value);\n    }\n    getKeySuffix(i) {\n        if (i === 1) {\n            return '';\n        }\n        return i.toString();\n    }\n    loadSection(cfg, sec) {\n        let i = 1;\n        for (;;) {\n            if (!this.loadAssertion(cfg, sec, sec + this.getKeySuffix(i))) {\n                break;\n            }\n            else {\n                i++;\n            }\n        }\n    }\n    // addDef adds an assertion to the model.\n    addDef(sec, key, value) {\n        if (value === '') {\n            return false;\n        }\n        const ast = new Assertion();\n        ast.key = key;\n        ast.value = value;\n        ast.fieldIndexMap = new Map();\n        if (sec === 'r' || sec === 'p') {\n            const tokens = value.split(',').map((n) => n.trim());\n            for (let i = 0; i < tokens.length; i++) {\n                tokens[i] = key + '_' + tokens[i];\n            }\n            ast.tokens = tokens;\n        }\n        else if (sec === 'm') {\n            const stringArguments = value.match(/\\\"(.*?)\\\"/g) || [];\n            stringArguments.forEach((n, index) => {\n                value = value.replace(n, `$<${index}>`);\n            });\n            value = util.escapeAssertion(value);\n            stringArguments.forEach((n, index) => {\n                value = value.replace(`$<${index}>`, n);\n            });\n            const invalidOperators = /(?<![&|])&(?!&)|(?<![&|])\\|(?!\\|)|&{3,}|\\|{3,}/g;\n            if (invalidOperators.test(value)) {\n                throw new Error(`Invalid operator in matcher`);\n            }\n            ast.value = value;\n        }\n        else {\n            ast.value = util.escapeAssertion(value);\n        }\n        const nodeMap = this.model.get(sec);\n        if (nodeMap) {\n            nodeMap.set(key, ast);\n        }\n        else {\n            const assertionMap = new Map();\n            assertionMap.set(key, ast);\n            this.model.set(sec, assertionMap);\n        }\n        return true;\n    }\n    /**\n     * loadModel loads the model from model CONF file.\n     * @param path the model file path\n     * @param fs {@link FileSystem}\n     * @deprecated {@link loadModelFromFile}\n     */\n    loadModel(path, fs) {\n        this.loadModelFromFile(path, fs);\n    }\n    /**\n     * loadModelFromFile loads the model from model CONF file.\n     * @param path the model file path\n     * @param fs {@link FileSystem}\n     */\n    loadModelFromFile(path, fs) {\n        const cfg = Config.newConfigFromFile(path, fs);\n        this.loadModelFromConfig(cfg);\n    }\n    // loadModelFromText loads the model from the text.\n    loadModelFromText(text) {\n        const cfg = Config.newConfigFromText(text);\n        this.loadModelFromConfig(cfg);\n    }\n    loadModelFromConfig(cfg) {\n        for (const s in sectionNameMap) {\n            this.loadSection(cfg, s);\n        }\n        const ms = [];\n        requiredSections.forEach((n) => {\n            if (!this.hasSection(n)) {\n                ms.push(sectionNameMap[n]);\n            }\n        });\n        if (ms.length > 0) {\n            throw new Error(`missing required sections: ${ms.join(',')}`);\n        }\n    }\n    hasSection(sec) {\n        return this.model.get(sec) !== undefined;\n    }\n    // printModel prints the model to the log.\n    printModel() {\n        logPrint('Model:');\n        this.model.forEach((value, key) => {\n            value.forEach((ast, astKey) => {\n                logPrint(`${key}.${astKey}: ${ast.value}`);\n            });\n        });\n    }\n    // buildIncrementalRoleLinks provides incremental build the role inheritance relations.\n    async buildIncrementalRoleLinks(rm, op, sec, ptype, rules) {\n        var _a, _b;\n        if (sec === 'g') {\n            await ((_b = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(ptype)) === null || _b === void 0 ? void 0 : _b.buildIncrementalRoleLinks(rm, op, rules));\n        }\n    }\n    // buildRoleLinks initializes the roles in RBAC.\n    async buildRoleLinks(rmMap) {\n        const astMap = this.model.get('g');\n        if (!astMap) {\n            return;\n        }\n        for (const key of astMap.keys()) {\n            const ast = astMap.get(key);\n            let rm = rmMap.get(key);\n            if (!rm) {\n                rm = new DefaultRoleManager(10);\n                rmMap.set(key, rm);\n            }\n            await (ast === null || ast === void 0 ? void 0 : ast.buildRoleLinks(rm));\n        }\n    }\n    // clearPolicy clears all current policy.\n    clearPolicy() {\n        this.model.forEach((value, key) => {\n            if (key === 'p' || key === 'g') {\n                value.forEach((ast) => {\n                    ast.policy = [];\n                });\n            }\n        });\n    }\n    // getPolicy gets all rules in a policy.\n    getPolicy(sec, key) {\n        var _a;\n        const policy = [];\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n        if (ast) {\n            policy.push(...ast.policy);\n        }\n        return policy;\n    }\n    // hasPolicy determines whether a model has the specified policy rule.\n    hasPolicy(sec, key, rule) {\n        var _a;\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n        if (!ast) {\n            return false;\n        }\n        return ast.policy.some((n) => util.arrayEquals(n, rule));\n    }\n    // addPolicy adds a policy rule to the model.\n    addPolicy(sec, key, rule) {\n        var _a;\n        if (!this.hasPolicy(sec, key, rule)) {\n            const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n            if (!ast) {\n                return false;\n            }\n            const policy = ast.policy;\n            const tokens = ast.tokens;\n            const priorityIndex = tokens.indexOf(`${key}_priority`);\n            if (priorityIndex !== -1) {\n                const priorityRule = rule[priorityIndex];\n                const insertIndex = policy.findIndex((oneRule) => oneRule[priorityIndex] >= priorityRule);\n                if (priorityIndex === -1) {\n                    policy.push(rule);\n                }\n                else {\n                    policy.splice(insertIndex, 0, rule);\n                }\n            }\n            else {\n                policy.push(rule);\n            }\n            return true;\n        }\n        return false;\n    }\n    // addPolicies adds policy rules to the model.\n    addPolicies(sec, ptype, rules) {\n        var _a;\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(ptype);\n        if (!ast) {\n            return [false, []];\n        }\n        for (const rule of rules) {\n            if (this.hasPolicy(sec, ptype, rule)) {\n                return [false, []];\n            }\n        }\n        const priorityFlag = ast.tokens.indexOf(`${ptype}_priority`) !== -1;\n        if (priorityFlag) {\n            rules.forEach((rule) => {\n                this.addPolicy(sec, ptype, rule);\n            });\n        }\n        else {\n            ast.policy = ast.policy.concat(rules);\n        }\n        return [true, rules];\n    }\n    // updatePolicy updates a policy from the model\n    updatePolicy(sec, ptype, oldRule, newRule) {\n        var _a;\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(ptype);\n        if (!ast) {\n            return false;\n        }\n        const index = ast.policy.findIndex((r) => util.arrayEquals(r, oldRule));\n        if (index === -1) {\n            return false;\n        }\n        const priorityIndex = ast.tokens.indexOf(`${ptype}_priority`);\n        if (priorityIndex !== -1) {\n            if (oldRule[priorityIndex] === newRule[priorityIndex]) {\n                ast.policy[index] = newRule;\n            }\n            else {\n                // this.removePolicy(sec, ptype, oldRule);\n                // this.addPolicy(sec, ptype, newRule);\n                throw new Error('new rule should have the same priority with old rule.');\n            }\n        }\n        else {\n            ast.policy[index] = newRule;\n        }\n        return true;\n    }\n    // removePolicy removes a policy rule from the model.\n    removePolicy(sec, key, rule) {\n        var _a;\n        if (this.hasPolicy(sec, key, rule)) {\n            const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n            if (!ast) {\n                return false;\n            }\n            ast.policy = ast.policy.filter((r) => !util.arrayEquals(rule, r));\n            return true;\n        }\n        return false;\n    }\n    // removePolicies removes policy rules from the model.\n    removePolicies(sec, ptype, rules) {\n        var _a;\n        const effects = [];\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(ptype);\n        if (!ast) {\n            return [false, []];\n        }\n        for (const rule of rules) {\n            if (!this.hasPolicy(sec, ptype, rule)) {\n                return [false, []];\n            }\n        }\n        for (const rule of rules) {\n            ast.policy = ast.policy.filter((r) => {\n                const equals = util.arrayEquals(rule, r);\n                if (equals) {\n                    effects.push(r);\n                }\n                return !equals;\n            });\n        }\n        return [true, effects];\n    }\n    // getFilteredPolicy gets rules based on field filters from a policy.\n    getFilteredPolicy(sec, key, fieldIndex, ...fieldValues) {\n        var _a;\n        const res = [];\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n        if (!ast) {\n            return res;\n        }\n        for (const rule of ast.policy) {\n            let matched = true;\n            for (let i = 0; i < fieldValues.length; i++) {\n                const fieldValue = fieldValues[i];\n                if (fieldValue !== '' && rule[fieldIndex + i] !== fieldValue) {\n                    matched = false;\n                    break;\n                }\n            }\n            if (matched) {\n                res.push(rule);\n            }\n        }\n        return res;\n    }\n    // removeFilteredPolicy removes policy rules based on field filters from the model.\n    removeFilteredPolicy(sec, key, fieldIndex, ...fieldValues) {\n        var _a;\n        const res = [];\n        const effects = [];\n        let bool = false;\n        if (fieldValues.length === 0) {\n            return [false, effects];\n        }\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n        if (!ast) {\n            return [false, []];\n        }\n        for (const rule of ast.policy) {\n            let matched = true;\n            for (let i = 0; i < fieldValues.length; i++) {\n                const fieldValue = fieldValues[i];\n                if (fieldValue !== '' && rule[fieldIndex + i] !== fieldValue) {\n                    matched = false;\n                    break;\n                }\n            }\n            if (matched) {\n                bool = true;\n                effects.push(rule);\n            }\n            else {\n                res.push(rule);\n            }\n        }\n        if (effects.length !== 0) {\n            ast.policy = res;\n        }\n        return [bool, effects];\n    }\n    // getValuesForFieldInPolicy gets all values for a field for all rules in a policy, duplicated values are removed.\n    getValuesForFieldInPolicy(sec, key, fieldIndex) {\n        var _a;\n        const values = [];\n        const ast = (_a = this.model.get(sec)) === null || _a === void 0 ? void 0 : _a.get(key);\n        if (!ast) {\n            return values;\n        }\n        return util.arrayRemoveDuplicates(ast.policy.map((n) => n[fieldIndex]));\n    }\n    // getValuesForFieldInPolicyAllTypes gets all values for a field for all rules in a policy of all ptypes, duplicated values are removed.\n    getValuesForFieldInPolicyAllTypes(sec, fieldIndex) {\n        const values = [];\n        const ast = this.model.get(sec);\n        if (!ast) {\n            return values;\n        }\n        for (const ptype of ast.keys()) {\n            values.push(...this.getValuesForFieldInPolicy(sec, ptype, fieldIndex));\n        }\n        return util.arrayRemoveDuplicates(values);\n    }\n    // printPolicy prints the policy to log.\n    printPolicy() {\n        if (!getLogger().isEnable()) {\n            return;\n        }\n        logPrint('Policy:');\n        this.model.forEach((map, key) => {\n            if (key === 'p' || key === 'g') {\n                map.forEach((ast) => {\n                    logPrint(`key, : ${ast.value}, : , ${ast.policy}`);\n                });\n            }\n        });\n    }\n    /**\n     * return the field index in fieldMap, if no this field in fieldMap, add it.\n     */\n    getFieldIndex(ptype, field) {\n        var _a;\n        const assertion = (_a = this.model.get('p')) === null || _a === void 0 ? void 0 : _a.get(ptype);\n        if (!assertion) {\n            return -1;\n        }\n        let index = assertion.fieldIndexMap.get(field);\n        if (index) {\n            return index;\n        }\n        const pattern = ptype + '_' + field;\n        index = -1;\n        for (let i = 0; i < assertion.tokens.length; i++) {\n            if (assertion.tokens[i] === pattern) {\n                index = i;\n                break;\n            }\n        }\n        if (index === -1) {\n            return index;\n        }\n        assertion.fieldIndexMap.set(field, index);\n        return index;\n    }\n    /**\n     * sort policies by subject hieraichy\n     */\n    sortPoliciesBySubjectHierarchy() {\n        var _a, _b, _c;\n        if (((_b = (_a = this.model.get('e')) === null || _a === void 0 ? void 0 : _a.get('e')) === null || _b === void 0 ? void 0 : _b.value) !== \"subjectPriority(p_eft) || deny\" /* EffectExpress.SUBJECT_PRIORITY */) {\n            return;\n        }\n        (_c = this.model.get('p')) === null || _c === void 0 ? void 0 : _c.forEach((assertion, ptype) => {\n            const domainIndex = this.getFieldIndex(ptype, \"dom\" /* FieldIndex.Domain */);\n            const subIndex = this.getFieldIndex(ptype, \"sub\" /* FieldIndex.Subject */);\n            // eslint-disable-next-line\n            const subjectHierarchyMap = this.getSubjectHierarchyMap(this.model.get('g').get('g').policy);\n            assertion.policy.sort((policyA, policyB) => {\n                const domainA = domainIndex === -1 ? defaultDomain : policyA[domainIndex];\n                const domainB = domainIndex === -1 ? defaultDomain : policyB[domainIndex];\n                // eslint-disable-next-line\n                const priorityA = subjectHierarchyMap.get(this.getNameWithDomain(domainA, policyA[subIndex]));\n                // eslint-disable-next-line\n                const priorityB = subjectHierarchyMap.get(this.getNameWithDomain(domainB, policyB[subIndex]));\n                return priorityB - priorityA;\n            });\n        });\n    }\n    /**\n     * Calculate the priority of each policy store in Map<string, number>\n     */\n    getSubjectHierarchyMap(groupPolicies) {\n        const subjectHierarchyMap = new Map();\n        if (!groupPolicies) {\n            return subjectHierarchyMap;\n        }\n        const policyMap = new Map();\n        let domain = defaultDomain;\n        groupPolicies.forEach((policy) => {\n            if (policy.length !== 2)\n                domain = policy[this.getFieldIndex('p', \"dom\" /* FieldIndex.Domain */)];\n            const child = this.getNameWithDomain(domain, policy[this.getFieldIndex('p', \"sub\" /* FieldIndex.Subject */)]);\n            const parent = this.getNameWithDomain(domain, policy[this.getFieldIndex('p', \"obj\" /* FieldIndex.Object */)]);\n            policyMap.set(child, parent);\n            if (!subjectHierarchyMap.has(child)) {\n                subjectHierarchyMap.set(child, 0);\n            }\n            if (!subjectHierarchyMap.has(parent)) {\n                subjectHierarchyMap.set(parent, 0);\n            }\n            subjectHierarchyMap.set(child, 1);\n        });\n        const set = new Set();\n        subjectHierarchyMap.forEach((_, key) => {\n            if (subjectHierarchyMap.get(key) !== 0)\n                set.add(key);\n        });\n        while (set.size !== 0) {\n            for (const child of set.values()) {\n                this.findHierarchy(policyMap, subjectHierarchyMap, set, child);\n            }\n        }\n        return subjectHierarchyMap;\n    }\n    findHierarchy(policyMap, subjectHierarchyMap, set, child) {\n        set.delete(child);\n        // eslint-disable-next-line\n        const parent = policyMap.get(child);\n        if (set.has(parent)) {\n            this.findHierarchy(policyMap, subjectHierarchyMap, set, parent);\n        }\n        // eslint-disable-next-line\n        subjectHierarchyMap.set(child, subjectHierarchyMap.get(parent) + 10);\n    }\n    /**\n     * get full name with domain\n     */\n    getNameWithDomain(domain, name) {\n        return domain + defaultSeparator + name;\n    }\n}\n/**\n * newModel creates a model.\n */\nexport function newModel(...text) {\n    const m = new Model();\n    if (text.length === 2) {\n        if (text[0] !== '') {\n            m.loadModelFromFile(text[0]);\n        }\n    }\n    else if (text.length === 1) {\n        m.loadModelFromText(text[0]);\n    }\n    else if (text.length !== 0) {\n        throw new Error('Invalid parameters for model.');\n    }\n    return m;\n}\n/**\n * newModelFromFile creates a model from a .CONF file.\n */\nexport function newModelFromFile(path, fs) {\n    const m = new Model();\n    if (path) {\n        m.loadModelFromFile(path, fs);\n    }\n    return m;\n}\n/**\n * newModelFromString creates a model from a string which contains model text.\n */\nexport function newModelFromString(text) {\n    const m = new Model();\n    m.loadModelFromText(text);\n    return m;\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 2926, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/model/assertion.js"],"sourcesContent":["// Copyright 2017 The casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport * as rbac from '../rbac';\nimport { logPrint } from '../log';\nimport { PolicyOp } from './model';\n// Assertion represents an expression in a section of the model.\n// For example: r = sub, obj, act\nexport class Assertion {\n    /**\n     * constructor is the constructor for Assertion.\n     */\n    constructor() {\n        this.key = '';\n        this.value = '';\n        this.tokens = [];\n        this.policy = [];\n        this.rm = new rbac.DefaultRoleManager(10);\n        this.fieldIndexMap = new Map();\n    }\n    async buildIncrementalRoleLinks(rm, op, rules) {\n        this.rm = rm;\n        const count = (this.value.match(/_/g) || []).length;\n        if (count < 2) {\n            throw new Error('the number of \"_\" in role definition should be at least 2');\n        }\n        for (let rule of rules) {\n            if (rule.length < count) {\n                throw new Error('grouping policy elements do not meet role definition');\n            }\n            if (rule.length > count) {\n                rule = rule.slice(0, count);\n            }\n            switch (op) {\n                case PolicyOp.PolicyAdd:\n                    await this.rm.addLink(rule[0], rule[1], ...rule.slice(2));\n                    break;\n                case PolicyOp.PolicyRemove:\n                    await this.rm.deleteLink(rule[0], rule[1], ...rule.slice(2));\n                    break;\n                default:\n                    throw new Error('unsupported operation');\n            }\n        }\n    }\n    async buildRoleLinks(rm) {\n        this.rm = rm;\n        const count = (this.value.match(/_/g) || []).length;\n        if (count < 2) {\n            throw new Error('the number of \"_\" in role definition should be at least 2');\n        }\n        for (let rule of this.policy) {\n            if (rule.length > count) {\n                rule = rule.slice(0, count);\n            }\n            await this.rm.addLink(rule[0], rule[1], ...rule.slice(2));\n        }\n        logPrint(`Role links for: ${this.key}`);\n        await this.rm.printRoles();\n    }\n}\n"],"names":[],"mappings":";;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AAAA;AACA;AAAA;AACA;;;;AAGO,MAAM;IACT;;KAEC,GACD,aAAc;QACV,IAAI,CAAC,GAAG,GAAG;QACX,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,MAAM,GAAG,EAAE;QAChB,IAAI,CAAC,MAAM,GAAG,EAAE;QAChB,IAAI,CAAC,EAAE,GAAG,IAAI,yMAAuB,CAAC;QACtC,IAAI,CAAC,aAAa,GAAG,IAAI;IAC7B;IACA,MAAM,0BAA0B,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE;QAC3C,IAAI,CAAC,EAAE,GAAG;QACV,MAAM,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,EAAE,EAAE,MAAM;QACnD,IAAI,QAAQ,GAAG;YACX,MAAM,IAAI,MAAM;QACpB;QACA,KAAK,IAAI,QAAQ,MAAO;YACpB,IAAI,KAAK,MAAM,GAAG,OAAO;gBACrB,MAAM,IAAI,MAAM;YACpB;YACA,IAAI,KAAK,MAAM,GAAG,OAAO;gBACrB,OAAO,KAAK,KAAK,CAAC,GAAG;YACzB;YACA,OAAQ;gBACJ,KAAK,mLAAQ,CAAC,SAAS;oBACnB,MAAM,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,KAAK,KAAK,KAAK,CAAC;oBACtD;gBACJ,KAAK,mLAAQ,CAAC,YAAY;oBACtB,MAAM,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,KAAK,KAAK,KAAK,CAAC;oBACzD;gBACJ;oBACI,MAAM,IAAI,MAAM;YACxB;QACJ;IACJ;IACA,MAAM,eAAe,EAAE,EAAE;QACrB,IAAI,CAAC,EAAE,GAAG;QACV,MAAM,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,SAAS,EAAE,EAAE,MAAM;QACnD,IAAI,QAAQ,GAAG;YACX,MAAM,IAAI,MAAM;QACpB;QACA,KAAK,IAAI,QAAQ,IAAI,CAAC,MAAM,CAAE;YAC1B,IAAI,KAAK,MAAM,GAAG,OAAO;gBACrB,OAAO,KAAK,KAAK,CAAC,GAAG;YACzB;YACA,MAAM,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,KAAK,KAAK,KAAK,CAAC;QAC1D;QACA,IAAA,mLAAQ,EAAC,CAAC,gBAAgB,EAAE,IAAI,CAAC,GAAG,EAAE;QACtC,MAAM,IAAI,CAAC,EAAE,CAAC,UAAU;IAC5B;AACJ","ignoreList":[0]}},
    {"offset": {"line": 3007, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/model/functionMap.js"],"sourcesContent":["// Copyright 2017 The casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport * as util from '../util';\n// FunctionMap represents the collection of Function.\nexport class FunctionMap {\n    /**\n     * constructor is the constructor for FunctionMap.\n     */\n    constructor() {\n        this.functions = new Map();\n    }\n    // loadFunctionMap loads an initial function map.\n    static loadFunctionMap() {\n        const fm = new FunctionMap();\n        fm.addFunction('keyMatch', util.keyMatchFunc);\n        fm.addFunction('keyGet', util.keyGetFunc);\n        fm.addFunction('keyMatch2', util.keyMatch2Func);\n        fm.addFunction('keyGet2', util.keyGet2Func);\n        fm.addFunction('keyMatch3', util.keyMatch3Func);\n        fm.addFunction('keyMatch4', util.keyMatch4Func);\n        fm.addFunction('keyMatch5', util.keyMatch5Func);\n        fm.addFunction('regexMatch', util.regexMatchFunc);\n        fm.addFunction('ipMatch', util.ipMatchFunc);\n        fm.addFunction('globMatch', util.globMatch);\n        return fm;\n    }\n    // addFunction adds an expression function.\n    addFunction(name, func) {\n        if (!this.functions.get(name)) {\n            this.functions.set(name, func);\n        }\n    }\n    // getFunctions return all functions.\n    getFunctions() {\n        return this.functions;\n    }\n}\n"],"names":[],"mappings":";;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AAAA;;AAEO,MAAM;IACT;;KAEC,GACD,aAAc;QACV,IAAI,CAAC,SAAS,GAAG,IAAI;IACzB;IACA,iDAAiD;IACjD,OAAO,kBAAkB;QACrB,MAAM,KAAK,IAAI;QACf,GAAG,WAAW,CAAC,YAAY,iMAAiB;QAC5C,GAAG,WAAW,CAAC,UAAU,+LAAe;QACxC,GAAG,WAAW,CAAC,aAAa,kMAAkB;QAC9C,GAAG,WAAW,CAAC,WAAW,gMAAgB;QAC1C,GAAG,WAAW,CAAC,aAAa,kMAAkB;QAC9C,GAAG,WAAW,CAAC,aAAa,kMAAkB;QAC9C,GAAG,WAAW,CAAC,aAAa,kMAAkB;QAC9C,GAAG,WAAW,CAAC,cAAc,mMAAmB;QAChD,GAAG,WAAW,CAAC,WAAW,gMAAgB;QAC1C,GAAG,WAAW,CAAC,aAAa,8LAAc;QAC1C,OAAO;IACX;IACA,2CAA2C;IAC3C,YAAY,IAAI,EAAE,IAAI,EAAE;QACpB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO;YAC3B,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM;QAC7B;IACJ;IACA,qCAAqC;IACrC,eAAe;QACX,OAAO,IAAI,CAAC,SAAS;IACzB;AACJ","ignoreList":[0]}},
    {"offset": {"line": 3063, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/model/index.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport * from './assertion';\nexport * from './functionMap';\nexport * from './model';\n"],"names":[],"mappings":";AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AACA;AACA","ignoreList":[0]}},
    {"offset": {"line": 3087, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/enforceContext.js"],"sourcesContent":["// Copyright 2023 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nexport class EnforceContext {\n    constructor(rType, pType, eType, mType) {\n        this.pType = pType;\n        this.eType = eType;\n        this.mType = mType;\n        this.rType = rType;\n    }\n}\nexport const newEnforceContext = (index) => {\n    return new EnforceContext('r' + index, 'p' + index, 'e' + index, 'm' + index);\n};\n"],"names":[],"mappings":"AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;;;;;;;AAC1B,MAAM;IACT,YAAY,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAE;QACpC,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,KAAK,GAAG;IACjB;AACJ;AACO,MAAM,oBAAoB,CAAC;IAC9B,OAAO,IAAI,eAAe,MAAM,OAAO,MAAM,OAAO,MAAM,OAAO,MAAM;AAC3E","ignoreList":[0]}},
    {"offset": {"line": 3121, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/coreEnforcer.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { compile, compileAsync, addBinaryOp } from '@casbin/expression-eval';\nimport { DefaultEffector, Effect } from './effect';\nimport { FunctionMap, newModelFromFile } from './model';\nimport { DefaultRoleManager } from './rbac';\nimport { EnforceContext } from './enforceContext';\nimport { escapeAssertion, generateGFunction, generateSyncedGFunction, getEvalValue, hasEval, replaceEval, generatorRunSync, generatorRunAsync, customIn, bracketCompatible, removeComments, } from './util';\nimport { getLogger, logPrint } from './log';\n/**\n * CoreEnforcer defines the core functionality of an enforcer.\n */\nexport class CoreEnforcer {\n    constructor() {\n        this.fm = FunctionMap.loadFunctionMap();\n        this.eft = new DefaultEffector();\n        this.matcherMap = new Map();\n        this.defaultEnforceContext = new EnforceContext('r', 'p', 'e', 'm');\n        this.watcher = null;\n        this.watcherEx = null;\n        this.enabled = true;\n        this.autoSave = true;\n        this.autoBuildRoleLinks = true;\n        this.autoNotifyWatcher = true;\n        this.acceptJsonRequest = false;\n    }\n    /**\n     * setFileSystem sets a file system to read the model file or the policy file.\n     * @param fs {@link FileSystem}\n     */\n    setFileSystem(fs) {\n        this.fs = fs;\n    }\n    /**\n     * getFileSystem gets the file system,\n     */\n    getFileSystem() {\n        return this.fs;\n    }\n    getExpression(asyncCompile, exp) {\n        const matcherKey = `${asyncCompile ? 'ASYNC[' : 'SYNC['}${exp}]`;\n        addBinaryOp('in', 1, customIn);\n        let expression = this.matcherMap.get(matcherKey);\n        if (!expression) {\n            exp = bracketCompatible(exp);\n            expression = asyncCompile ? compileAsync(exp) : compile(exp);\n            this.matcherMap.set(matcherKey, expression);\n        }\n        return expression;\n    }\n    /**\n     * loadModel reloads the model from the model CONF file.\n     * Because the policy is attached to a model,\n     * so the policy is invalidated and needs to be reloaded by calling LoadPolicy().\n     */\n    loadModel() {\n        this.model = newModelFromFile(this.modelPath, this.fs);\n        this.model.printModel();\n    }\n    /**\n     * getModel gets the current model.\n     *\n     * @return the model of the enforcer.\n     */\n    getModel() {\n        return this.model;\n    }\n    /**\n     * setModel sets the current model.\n     *\n     * @param m the model.\n     */\n    setModel(m) {\n        this.model = m;\n    }\n    /**\n     * getAdapter gets the current adapter.\n     *\n     * @return the adapter of the enforcer.\n     */\n    getAdapter() {\n        return this.adapter;\n    }\n    /**\n     * setAdapter sets the current adapter.\n     *\n     * @param adapter the adapter.\n     */\n    setAdapter(adapter) {\n        this.adapter = adapter;\n    }\n    /**\n     * setWatcher sets the current watcher.\n     *\n     * @param watcher the watcher.\n     */\n    setWatcher(watcher) {\n        this.watcher = watcher;\n        watcher.setUpdateCallback(async () => await this.loadPolicy());\n    }\n    /**\n     * setWatcherEx sets the current watcherEx.\n     *\n     * @param watcherEx the watcherEx.\n     */\n    setWatcherEx(watcherEx) {\n        this.watcherEx = watcherEx;\n    }\n    /**\n     * setRoleManager sets the current role manager.\n     *\n     * @param rm the role manager.\n     */\n    setRoleManager(rm) {\n        this.rmMap.set('g', rm);\n    }\n    /**\n     * setRoleManager sets the role manager for the named policy.\n     *\n     * @param ptype the named policy.\n     * @param rm the role manager.\n     */\n    setNamedRoleManager(ptype, rm) {\n        this.rmMap.set(ptype, rm);\n    }\n    /**\n     * getRoleManager gets the current role manager.\n     */\n    getRoleManager() {\n        return this.rmMap.get('g');\n    }\n    /**\n     * getNamedRoleManager gets role manager by name.\n     */\n    getNamedRoleManager(name) {\n        return this.rmMap.get(name);\n    }\n    /**\n     * setEffector sets the current effector.\n     *\n     * @param eft the effector.\n     */\n    setEffector(eft) {\n        this.eft = eft;\n    }\n    /**\n     * clearPolicy clears all policy.\n     */\n    clearPolicy() {\n        this.model.clearPolicy();\n    }\n    initRmMap() {\n        this.rmMap = new Map();\n        const rm = this.model.model.get('g');\n        if (rm) {\n            for (const ptype of rm.keys()) {\n                this.rmMap.set(ptype, new DefaultRoleManager(10));\n            }\n        }\n    }\n    sortPolicies() {\n        var _a;\n        (_a = this.model.model.get('p')) === null || _a === void 0 ? void 0 : _a.forEach((value, key) => {\n            const policy = value.policy;\n            const tokens = value.tokens;\n            if (policy && tokens) {\n                const priorityIndex = tokens.indexOf(`${key}_priority`);\n                if (priorityIndex !== -1) {\n                    policy.sort((a, b) => {\n                        return parseInt(a[priorityIndex], 10) - parseInt(b[priorityIndex], 10);\n                    });\n                }\n            }\n        });\n    }\n    /**\n     * loadPolicy reloads the policy from file/database.\n     */\n    async loadPolicy() {\n        this.model.clearPolicy();\n        await this.adapter.loadPolicy(this.model);\n        this.sortPolicies();\n        this.model.sortPoliciesBySubjectHierarchy();\n        if (this.autoBuildRoleLinks) {\n            await this.buildRoleLinksInternal();\n        }\n    }\n    /**\n     * loadFilteredPolicy reloads a filtered policy from file/database.\n     *\n     * @param filter the filter used to specify which type of policy should be loaded.\n     */\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n    async loadFilteredPolicy(filter) {\n        this.model.clearPolicy();\n        this.sortPolicies();\n        this.model.sortPoliciesBySubjectHierarchy();\n        return this.loadIncrementalFilteredPolicy(filter);\n    }\n    /**\n     * LoadIncrementalFilteredPolicy append a filtered policy from file/database.\n     *\n     * @param filter the filter used to specify which type of policy should be appended.\n     */\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n    async loadIncrementalFilteredPolicy(filter) {\n        if ('isFiltered' in this.adapter) {\n            await this.adapter.loadFilteredPolicy(this.model, filter);\n        }\n        else {\n            throw new Error('filtered policies are not supported by this adapter');\n        }\n        this.sortPolicies();\n        if (this.autoBuildRoleLinks) {\n            await this.buildRoleLinksInternal();\n        }\n        return true;\n    }\n    /**\n     * isFiltered returns true if the loaded policy has been filtered.\n     *\n     * @return if the loaded policy has been filtered.\n     */\n    isFiltered() {\n        if ('isFiltered' in this.adapter) {\n            return this.adapter.isFiltered();\n        }\n        return false;\n    }\n    /**\n     * savePolicy saves the current policy (usually after changed with\n     * Casbin API) back to file/database.\n     */\n    async savePolicy() {\n        if (this.isFiltered()) {\n            throw new Error('Cannot save a filtered policy');\n        }\n        const flag = await this.adapter.savePolicy(this.model);\n        if (!flag) {\n            return false;\n        }\n        if (this.watcherEx) {\n            return await this.watcherEx.updateForSavePolicy(this.model);\n        }\n        else if (this.watcher) {\n            return await this.watcher.update();\n        }\n        return true;\n    }\n    /**\n     * enableEnforce changes the enforcing state of Casbin, when Casbin is\n     * disabled, all access will be allowed by the enforce() function.\n     *\n     * @param enable whether to enable the enforcer.\n     */\n    enableEnforce(enable) {\n        this.enabled = enable;\n    }\n    /**\n     * enableLog changes whether to print Casbin log to the standard output.\n     *\n     * @param enable whether to enable Casbin's log.\n     */\n    enableLog(enable) {\n        getLogger().enableLog(enable);\n    }\n    /**\n     * enableAutoSave controls whether to save a policy rule automatically to\n     * the adapter when it is added or removed.\n     *\n     * @param autoSave whether to enable the AutoSave feature.\n     */\n    enableAutoSave(autoSave) {\n        this.autoSave = autoSave;\n    }\n    /**\n     * enableAutoNotifyWatcher controls whether to save a policy rule automatically notify the Watcher when it is added or removed.\n     * @param enable whether to enable the AutoNotifyWatcher feature.\n     */\n    enableAutoNotifyWatcher(enable) {\n        this.autoNotifyWatcher = enable;\n    }\n    /**\n     * enableAcceptJsonRequest determines whether to attempt parsing request args as JSON\n     *\n     * @param enable whether to attempt parsing request args as JSON\n     */\n    enableAcceptJsonRequest(enable) {\n        this.acceptJsonRequest = enable;\n    }\n    /**\n     * enableAutoBuildRoleLinks controls whether to save a policy rule\n     * automatically to the adapter when it is added or removed.\n     *\n     * @param autoBuildRoleLinks whether to automatically build the role links.\n     */\n    enableAutoBuildRoleLinks(autoBuildRoleLinks) {\n        this.autoBuildRoleLinks = autoBuildRoleLinks;\n    }\n    /**\n     * add matching function to RoleManager by ptype\n     * @param ptype g\n     * @param fn the function will be added\n     */\n    async addNamedMatchingFunc(ptype, fn) {\n        const rm = this.rmMap.get(ptype);\n        if (rm) {\n            return await rm.addMatchingFunc(fn);\n        }\n        throw Error('Target ptype not found.');\n    }\n    /**\n     * add domain matching function to RoleManager by ptype\n     * @param ptype g\n     * @param fn the function will be added\n     */\n    async addNamedDomainMatchingFunc(ptype, fn) {\n        const rm = this.rmMap.get(ptype);\n        if (rm) {\n            return await rm.addDomainMatchingFunc(fn);\n        }\n    }\n    /**\n     * buildRoleLinks manually rebuild the role inheritance relations.\n     */\n    async buildRoleLinks() {\n        return this.buildRoleLinksInternal();\n    }\n    /**\n     * buildIncrementalRoleLinks provides incremental build the role inheritance relations.\n     * @param op policy operation\n     * @param ptype g\n     * @param rules policies\n     */\n    async buildIncrementalRoleLinks(op, ptype, rules) {\n        let rm = this.rmMap.get(ptype);\n        if (!rm) {\n            rm = new DefaultRoleManager(10);\n            this.rmMap.set(ptype, rm);\n        }\n        await this.model.buildIncrementalRoleLinks(rm, op, 'g', ptype, rules);\n    }\n    async buildRoleLinksInternal() {\n        for (const rm of this.rmMap.values()) {\n            await rm.clear();\n            await this.model.buildRoleLinks(this.rmMap);\n        }\n    }\n    *privateEnforce(asyncCompile = true, explain = false, matcher, enforceContext = new EnforceContext('r', 'p', 'e', 'm'), ...rvals) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n        if (!this.enabled) {\n            return true;\n        }\n        let explainIndex = -1;\n        const functions = {};\n        this.fm.getFunctions().forEach((value, key) => {\n            functions[key] = value;\n        });\n        const astMap = this.model.model.get('g');\n        astMap === null || astMap === void 0 ? void 0 : astMap.forEach((value, key) => {\n            const rm = value.rm;\n            functions[key] = asyncCompile ? generateGFunction(rm) : generateSyncedGFunction(rm);\n        });\n        let expString;\n        if (!matcher) {\n            expString = (_b = (_a = this.model.model.get('m')) === null || _a === void 0 ? void 0 : _a.get(enforceContext.mType)) === null || _b === void 0 ? void 0 : _b.value;\n        }\n        else {\n            expString = removeComments(escapeAssertion(matcher));\n        }\n        if (!expString) {\n            throw new Error('Unable to find matchers in model');\n        }\n        const effectExpr = (_d = (_c = this.model.model.get('e')) === null || _c === void 0 ? void 0 : _c.get(enforceContext.eType)) === null || _d === void 0 ? void 0 : _d.value;\n        if (!effectExpr) {\n            throw new Error('Unable to find policy_effect in model');\n        }\n        const HasEval = hasEval(expString);\n        let expression = undefined;\n        const p = (_e = this.model.model.get('p')) === null || _e === void 0 ? void 0 : _e.get(enforceContext.pType);\n        const policyLen = (_f = p === null || p === void 0 ? void 0 : p.policy) === null || _f === void 0 ? void 0 : _f.length;\n        const rTokens = (_h = (_g = this.model.model.get('r')) === null || _g === void 0 ? void 0 : _g.get(enforceContext.rType)) === null || _h === void 0 ? void 0 : _h.tokens;\n        const rTokensLen = rTokens === null || rTokens === void 0 ? void 0 : rTokens.length;\n        const effectStream = this.eft.newStream(effectExpr);\n        if (policyLen && policyLen !== 0 && expString.includes(`${enforceContext.pType}_`)) {\n            for (let i = 0; i < policyLen; i++) {\n                const parameters = {};\n                if ((rTokens === null || rTokens === void 0 ? void 0 : rTokens.length) !== rvals.length) {\n                    throw new Error(`invalid request size: expected ${rTokensLen}, got ${rvals.length}, rvals: ${rvals}\"`);\n                }\n                if (this.acceptJsonRequest) {\n                    // Attempt to parse each request parameter as JSON; continue with string if failed\n                    rTokens.forEach((token, j) => {\n                        try {\n                            parameters[token] = JSON.parse(rvals[j]);\n                        }\n                        catch (_a) {\n                            parameters[token] = rvals[j];\n                        }\n                    });\n                }\n                else {\n                    rTokens.forEach((token, j) => {\n                        parameters[token] = rvals[j];\n                    });\n                }\n                p === null || p === void 0 ? void 0 : p.tokens.forEach((token, j) => {\n                    parameters[token] = p === null || p === void 0 ? void 0 : p.policy[i][j];\n                });\n                if (HasEval) {\n                    const ruleNames = getEvalValue(expString);\n                    let expWithRule = expString;\n                    for (const ruleName of ruleNames) {\n                        if (ruleName in parameters) {\n                            const rule = escapeAssertion(parameters[ruleName]);\n                            expWithRule = replaceEval(expWithRule, ruleName, rule);\n                        }\n                        else {\n                            throw new Error(`${ruleName} not in ${parameters}`);\n                        }\n                    }\n                    expression = this.getExpression(asyncCompile, expWithRule);\n                }\n                else {\n                    if (expression === undefined) {\n                        expression = this.getExpression(asyncCompile, expString);\n                    }\n                }\n                const context = Object.assign(Object.assign({}, parameters), functions);\n                const result = asyncCompile ? yield expression(context) : expression(context);\n                let eftRes;\n                switch (typeof result) {\n                    case 'boolean':\n                        eftRes = result ? Effect.Allow : Effect.Indeterminate;\n                        break;\n                    case 'number':\n                        if (result === 0) {\n                            eftRes = Effect.Indeterminate;\n                        }\n                        else {\n                            eftRes = result;\n                        }\n                        break;\n                    case 'string':\n                        if (result === '') {\n                            eftRes = Effect.Indeterminate;\n                        }\n                        else {\n                            eftRes = Effect.Allow;\n                        }\n                        break;\n                    default:\n                        throw new Error('matcher result should only be of type boolean, number, or string');\n                }\n                const eft = parameters[`${enforceContext.pType}_eft`];\n                if (eft && eftRes === Effect.Allow) {\n                    if (eft === 'allow') {\n                        eftRes = Effect.Allow;\n                    }\n                    else if (eft === 'deny') {\n                        eftRes = Effect.Deny;\n                    }\n                    else {\n                        eftRes = Effect.Indeterminate;\n                    }\n                }\n                const [res, rec, done] = effectStream.pushEffect(eftRes);\n                if (rec) {\n                    explainIndex = i;\n                }\n                if (done) {\n                    break;\n                }\n            }\n        }\n        else {\n            explainIndex = 0;\n            const parameters = {};\n            rTokens === null || rTokens === void 0 ? void 0 : rTokens.forEach((token, j) => {\n                parameters[token] = rvals[j];\n            });\n            (_j = p === null || p === void 0 ? void 0 : p.tokens) === null || _j === void 0 ? void 0 : _j.forEach((token) => {\n                parameters[token] = '';\n            });\n            expression = this.getExpression(asyncCompile, expString);\n            const context = Object.assign(Object.assign({}, parameters), functions);\n            const result = asyncCompile ? yield expression(context) : expression(context);\n            if (result) {\n                effectStream.pushEffect(Effect.Allow);\n            }\n            else {\n                effectStream.pushEffect(Effect.Indeterminate);\n            }\n        }\n        const res = effectStream.current();\n        // only generate the request --> result string if the message\n        // is going to be logged.\n        if (getLogger().isEnable()) {\n            let reqStr = 'Request: ';\n            for (let i = 0; i < rvals.length; i++) {\n                if (i !== rvals.length - 1) {\n                    reqStr += `${rvals[i]}, `;\n                }\n                else {\n                    reqStr += rvals[i];\n                }\n            }\n            reqStr += ` ---> ${res}`;\n            logPrint(reqStr);\n        }\n        if (explain) {\n            if (explainIndex === -1) {\n                return [res, []];\n            }\n            return [res, ((_k = p === null || p === void 0 ? void 0 : p.policy) === null || _k === void 0 ? void 0 : _k[explainIndex]) || []];\n        }\n        return res;\n    }\n    /**\n     * If the matchers does not contain an asynchronous method, call it faster.\n     *\n     * enforceSync decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\", input parameters are usually: (sub, obj, act).\n     *\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request.\n     */\n    enforceSync(...rvals) {\n        if (rvals[0] instanceof EnforceContext) {\n            const enforceContext = rvals.shift();\n            return generatorRunSync(this.privateEnforce(false, false, '', enforceContext, ...rvals));\n        }\n        return generatorRunSync(this.privateEnforce(false, false, '', this.defaultEnforceContext, ...rvals));\n    }\n    /**\n     * If the matchers does not contain an asynchronous method, call it faster.\n     *\n     * enforceSync decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\", input parameters are usually: (sub, obj, act).\n     *\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request and the reason rule.\n     */\n    enforceExSync(...rvals) {\n        if (rvals[0] instanceof EnforceContext) {\n            const enforceContext = rvals.shift();\n            return generatorRunSync(this.privateEnforce(false, true, '', enforceContext, ...rvals));\n        }\n        return generatorRunSync(this.privateEnforce(false, true, '', this.defaultEnforceContext, ...rvals));\n    }\n    /**\n     * Same as enforceSync. To be removed.\n     */\n    enforceWithSyncCompile(...rvals) {\n        return this.enforceSync(...rvals);\n    }\n    /**\n     * enforce decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\", input parameters are usually: (sub, obj, act).\n     *\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request.\n     */\n    async enforce(...rvals) {\n        if (rvals[0] instanceof EnforceContext) {\n            const enforceContext = rvals.shift();\n            return generatorRunAsync(this.privateEnforce(true, false, '', enforceContext, ...rvals));\n        }\n        return generatorRunAsync(this.privateEnforce(true, false, '', this.defaultEnforceContext, ...rvals));\n    }\n    /**\n     * enforceWithMatcher decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\" but with the matcher passed,\n     * input parameters are usually: (matcher, sub, obj, act).\n     *\n     * @param matcher matcher string.\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request.\n     */\n    async enforceWithMatcher(matcher, ...rvals) {\n        if (rvals[0] instanceof EnforceContext) {\n            const enforceContext = rvals.shift();\n            return generatorRunAsync(this.privateEnforce(true, false, matcher, enforceContext, ...rvals));\n        }\n        return generatorRunAsync(this.privateEnforce(true, false, matcher, this.defaultEnforceContext, ...rvals));\n    }\n    /**\n     * enforce decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\", input parameters are usually: (sub, obj, act).\n     *\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request and the reason rule.\n     */\n    async enforceEx(...rvals) {\n        if (rvals[0] instanceof EnforceContext) {\n            const enforceContext = rvals.shift();\n            return generatorRunAsync(this.privateEnforce(true, true, '', enforceContext, ...rvals));\n        }\n        return generatorRunAsync(this.privateEnforce(true, true, '', this.defaultEnforceContext, ...rvals));\n    }\n    /**\n     * enforceExWithMatcher decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\" but with the matcher passed,\n     *  input parameters are usually: (matcher, sub, obj, act).\n     *\n     * @param matcher matcher string.\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request and the reason rule.\n     */\n    async enforceExWithMatcher(matcher, ...rvals) {\n        if (rvals[0] instanceof EnforceContext) {\n            const enforceContext = rvals.shift();\n            return generatorRunAsync(this.privateEnforce(true, true, matcher, enforceContext, ...rvals));\n        }\n        return generatorRunAsync(this.privateEnforce(true, true, matcher, this.defaultEnforceContext, ...rvals));\n    }\n    /**\n     * batchEnforce enforces each request and returns result in a bool array.\n     * @param rvals the request need to be mediated, usually an array\n     *              of array of strings, can be class instances if ABAC is used.\n     * @returns whether to allow the requests.\n     */\n    async batchEnforce(rvals) {\n        return await Promise.all(rvals.map((rval) => this.enforce(...rval)));\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 3738, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/internalEnforcer.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { CoreEnforcer } from './coreEnforcer';\nimport { PolicyOp } from './model';\n/**\n * InternalEnforcer = CoreEnforcer + Internal API.\n */\nexport class InternalEnforcer extends CoreEnforcer {\n    /**\n     * addPolicyInternal adds a rule to the current policy.\n     */\n    async addPolicyInternal(sec, ptype, rule, useWatcher) {\n        if (this.model.hasPolicy(sec, ptype, rule)) {\n            return false;\n        }\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            try {\n                await this.adapter.addPolicy(sec, ptype, rule);\n            }\n            catch (e) {\n                if (e instanceof Error && e.message !== 'not implemented') {\n                    throw e;\n                }\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // error intentionally ignored\n                if (this.watcherEx) {\n                    this.watcherEx.updateForAddPolicy(sec, ptype, ...rule);\n                }\n                else if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const ok = this.model.addPolicy(sec, ptype, rule);\n        if (sec === 'g' && ok) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, [rule]);\n        }\n        return ok;\n    }\n    // addPolicies adds rules to the current policy.\n    // removePolicies removes rules from the current policy.\n    async addPoliciesInternal(sec, ptype, rules, useWatcher) {\n        for (const rule of rules) {\n            if (this.model.hasPolicy(sec, ptype, rule)) {\n                return false;\n            }\n        }\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            if ('addPolicies' in this.adapter) {\n                try {\n                    await this.adapter.addPolicies(sec, ptype, rules);\n                }\n                catch (e) {\n                    if (e instanceof Error && e.message !== 'not implemented') {\n                        throw e;\n                    }\n                }\n            }\n            else {\n                throw new Error('cannot to save policy, the adapter does not implement the BatchAdapter');\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // error intentionally ignored\n                if (this.watcherEx) {\n                    this.watcherEx.updateForAddPolicies(sec, ptype, ...rules);\n                }\n                else if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const [ok, effects] = await this.model.addPolicies(sec, ptype, rules);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, effects);\n        }\n        return ok;\n    }\n    /**\n     * addPoliciesInternalEx adds rules to the current policy.\n     * Unlike addPoliciesInternal, this method will filter out rules that already exist\n     * and continue to add the remaining rules instead of returning false immediately.\n     */\n    async addPoliciesInternalEx(sec, ptype, rules, useWatcher) {\n        // Filter out existing rules\n        const newRules = rules.filter((rule) => !this.model.hasPolicy(sec, ptype, rule));\n        // If no new rules to add, return false\n        if (newRules.length === 0) {\n            return false;\n        }\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            if ('addPolicies' in this.adapter) {\n                try {\n                    await this.adapter.addPolicies(sec, ptype, newRules);\n                }\n                catch (e) {\n                    if (e instanceof Error && e.message !== 'not implemented') {\n                        throw e;\n                    }\n                }\n            }\n            else {\n                throw new Error('cannot save policy, the adapter does not implement the BatchAdapter');\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // error intentionally ignored\n                if (this.watcherEx) {\n                    this.watcherEx.updateForAddPolicies(sec, ptype, ...newRules);\n                }\n                else if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const [ok, effects] = await this.model.addPolicies(sec, ptype, newRules);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, effects);\n        }\n        return ok;\n    }\n    /**\n     * updatePolicyInternal updates a rule from the current policy.\n     */\n    async updatePolicyInternal(sec, ptype, oldRule, newRule, useWatcher) {\n        if (!this.model.hasPolicy(sec, ptype, oldRule)) {\n            return false;\n        }\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            if ('updatePolicy' in this.adapter) {\n                try {\n                    await this.adapter.updatePolicy(sec, ptype, oldRule, newRule);\n                }\n                catch (e) {\n                    if (e instanceof Error && e.message !== 'not implemented') {\n                        throw e;\n                    }\n                }\n            }\n            else {\n                throw new Error('cannot to update policy, the adapter does not implement the UpdatableAdapter');\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // In fact I think it should wait for the respond, but they implement add_policy() like this\n                // error intentionally ignored\n                if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const ok = this.model.updatePolicy(sec, ptype, oldRule, newRule);\n        if (sec === 'g' && ok) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, [oldRule]);\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, [newRule]);\n        }\n        return ok;\n    }\n    /**\n     * removePolicyInternal removes a rule from the current policy.\n     */\n    async removePolicyInternal(sec, ptype, rule, useWatcher) {\n        if (!this.model.hasPolicy(sec, ptype, rule)) {\n            return false;\n        }\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            try {\n                await this.adapter.removePolicy(sec, ptype, rule);\n            }\n            catch (e) {\n                if (e instanceof Error && e.message !== 'not implemented') {\n                    throw e;\n                }\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // error intentionally ignored\n                if (this.watcherEx) {\n                    this.watcherEx.updateForRemovePolicy(sec, ptype, ...rule);\n                }\n                else if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const ok = await this.model.removePolicy(sec, ptype, rule);\n        if (sec === 'g' && ok) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, [rule]);\n        }\n        return ok;\n    }\n    // removePolicies removes rules from the current policy.\n    async removePoliciesInternal(sec, ptype, rules, useWatcher) {\n        for (const rule of rules) {\n            if (!this.model.hasPolicy(sec, ptype, rule)) {\n                return false;\n            }\n        }\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            if ('removePolicies' in this.adapter) {\n                try {\n                    await this.adapter.removePolicies(sec, ptype, rules);\n                }\n                catch (e) {\n                    if (e instanceof Error && e.message !== 'not implemented') {\n                        throw e;\n                    }\n                }\n            }\n            else {\n                throw new Error('cannot to save policy, the adapter does not implement the BatchAdapter');\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // error intentionally ignored\n                if (this.watcherEx) {\n                    this.watcherEx.updateForRemovePolicies(sec, ptype, ...rules);\n                }\n                else if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const [ok, effects] = this.model.removePolicies(sec, ptype, rules);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, effects);\n        }\n        return ok;\n    }\n    /**\n     * removeFilteredPolicyInternal removes rules based on field filters from the current policy.\n     */\n    async removeFilteredPolicyInternal(sec, ptype, fieldIndex, fieldValues, useWatcher) {\n        // Persist when an adapter is configured and autoSave is enabled.\n        if (this.adapter && this.autoSave) {\n            try {\n                await this.adapter.removeFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues);\n            }\n            catch (e) {\n                if (e instanceof Error && e.message !== 'not implemented') {\n                    throw e;\n                }\n            }\n        }\n        if (useWatcher) {\n            if (this.autoNotifyWatcher) {\n                // error intentionally ignored\n                if (this.watcherEx) {\n                    this.watcherEx.updateForRemoveFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues);\n                }\n                else if (this.watcher) {\n                    this.watcher.update();\n                }\n            }\n        }\n        const [ok, effects] = this.model.removeFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, effects);\n        }\n        return ok;\n    }\n    /**\n     * get field index in model.fieldMap.\n     */\n    getFieldIndex(ptype, field) {\n        return this.model.getFieldIndex(ptype, field);\n    }\n    /**\n     *  set index of field\n     */\n    setFieldIndex(ptype, field, index) {\n        var _a;\n        const assertion = (_a = this.model.model.get('p')) === null || _a === void 0 ? void 0 : _a.get(ptype);\n        assertion === null || assertion === void 0 ? void 0 : assertion.fieldIndexMap.set(field, index);\n    }\n    async addPolicyWithoutNotify(sec, ptype, rule) {\n        if (this.model.hasPolicy(sec, ptype, rule)) {\n            return false;\n        }\n        const ok = this.model.addPolicy(sec, ptype, rule);\n        if (sec === 'g' && ok) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, [rule]);\n        }\n        return ok;\n    }\n    async addPoliciesWithoutNotify(sec, ptype, rules) {\n        for (const rule of rules) {\n            if (this.model.hasPolicy(sec, ptype, rule)) {\n                return false;\n            }\n        }\n        const [ok, effects] = await this.model.addPolicies(sec, ptype, rules);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, effects);\n        }\n        return ok;\n    }\n    async addPoliciesWithoutNotifyEx(sec, ptype, rules) {\n        const newRules = rules.filter((rule) => !this.model.hasPolicy(sec, ptype, rule));\n        if (newRules.length === 0) {\n            return false;\n        }\n        const [ok, effects] = await this.model.addPolicies(sec, ptype, newRules);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, effects);\n        }\n        return ok;\n    }\n    async updatePolicyWithoutNotify(sec, ptype, oldRule, newRule) {\n        if (!this.model.hasPolicy(sec, ptype, oldRule)) {\n            return false;\n        }\n        const ok = this.model.updatePolicy(sec, ptype, oldRule, newRule);\n        if (sec === 'g' && ok) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, [oldRule]);\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyAdd, ptype, [newRule]);\n        }\n        return ok;\n    }\n    async removePolicyWithoutNotify(sec, ptype, rule) {\n        if (!this.model.hasPolicy(sec, ptype, rule)) {\n            return false;\n        }\n        const ok = await this.model.removePolicy(sec, ptype, rule);\n        if (sec === 'g' && ok) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, [rule]);\n        }\n        return ok;\n    }\n    async removePoliciesWithoutNotify(sec, ptype, rules) {\n        for (const rule of rules) {\n            if (!this.model.hasPolicy(sec, ptype, rule)) {\n                return false;\n            }\n        }\n        const [ok, effects] = this.model.removePolicies(sec, ptype, rules);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, effects);\n        }\n        return ok;\n    }\n    async removeFilteredPolicyWithoutNotify(sec, ptype, fieldIndex, fieldValues) {\n        const [ok, effects] = this.model.removeFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues);\n        if (sec === 'g' && ok && (effects === null || effects === void 0 ? void 0 : effects.length)) {\n            await this.buildIncrementalRoleLinks(PolicyOp.PolicyRemove, ptype, effects);\n        }\n        return ok;\n    }\n    async updatePoliciesWithoutNotify(sec, ptype, oldRules, newRules) {\n        // Mirror the Go updatePoliciesWithoutNotify; reuse the existing internal flow.\n        // Because updatePoliciesInternal isn't implemented yet, fall back to per-item updates.\n        if (oldRules.length !== newRules.length) {\n            throw new Error('the length of oldRules should be equal to the length of newRules');\n        }\n        for (let i = 0; i < oldRules.length; i++) {\n            const ok = await this.updatePolicyWithoutNotify(sec, ptype, oldRules[i], newRules[i]);\n            if (!ok) {\n                return false;\n            }\n        }\n        return true;\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4126, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/managementEnforcer.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { InternalEnforcer } from './internalEnforcer';\n/**\n * ManagementEnforcer = InternalEnforcer + Management API.\n */\nexport class ManagementEnforcer extends InternalEnforcer {\n    /**\n     * getAllSubjects gets the list of subjects that show up in the current policy.\n     *\n     * @return all the subjects in \"p\" policy rules. It actually collects the\n     *         0-index elements of \"p\" policy rules. So make sure your subject\n     *         is the 0-index element, like (sub, obj, act). Duplicates are removed.\n     */\n    async getAllSubjects() {\n        return this.getAllNamedSubjects('p');\n    }\n    /**\n     * getAllNamedSubjects gets the list of subjects that show up in the currentnamed policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return all the subjects in policy rules of the ptype type. It actually\n     *         collects the 0-index elements of the policy rules. So make sure\n     *         your subject is the 0-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedSubjects(ptype) {\n        return this.model.getValuesForFieldInPolicy('p', ptype, 0);\n    }\n    /**\n     * getAllObjects gets the list of objects that show up in the current policy.\n     *\n     * @return all the objects in \"p\" policy rules. It actually collects the\n     *         1-index elements of \"p\" policy rules. So make sure your object\n     *         is the 1-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllObjects() {\n        return this.getAllNamedObjects('p');\n    }\n    /**\n     * getAllNamedObjects gets the list of objects that show up in the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return all the objects in policy rules of the ptype type. It actually\n     *         collects the 1-index elements of the policy rules. So make sure\n     *         your object is the 1-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedObjects(ptype) {\n        return this.model.getValuesForFieldInPolicy('p', ptype, 1);\n    }\n    /**\n     * getAllActions gets the list of actions that show up in the current policy.\n     *\n     * @return all the actions in \"p\" policy rules. It actually collects\n     *         the 2-index elements of \"p\" policy rules. So make sure your action\n     *         is the 2-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllActions() {\n        return this.getAllNamedActions('p');\n    }\n    /**\n     * GetAllNamedActions gets the list of actions that show up in the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return all the actions in policy rules of the ptype type. It actually\n     *         collects the 2-index elements of the policy rules. So make sure\n     *         your action is the 2-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedActions(ptype) {\n        return this.model.getValuesForFieldInPolicy('p', ptype, 2);\n    }\n    /**\n     * getAllRoles gets the list of roles that show up in the current policy.\n     *\n     * @return all the roles in \"g\" policy rules. It actually collects\n     *         the 1-index elements of \"g\" policy rules. So make sure your\n     *         role is the 1-index element, like (sub, role).\n     *         Duplicates are removed.\n     */\n    async getAllRoles() {\n        return this.getAllNamedRoles('g');\n    }\n    /**\n     * getAllNamedRoles gets the list of roles that show up in the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @return all the subjects in policy rules of the ptype type. It actually\n     *         collects the 0-index elements of the policy rules. So make\n     *         sure your subject is the 0-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedRoles(ptype) {\n        return this.model.getValuesForFieldInPolicy('g', ptype, 1);\n    }\n    /**\n     * getPolicy gets all the authorization rules in the policy.\n     *\n     * @return all the \"p\" policy rules.\n     */\n    async getPolicy() {\n        return this.getNamedPolicy('p');\n    }\n    /**\n     * getFilteredPolicy gets all the authorization rules in the policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return the filtered \"p\" policy rules.\n     */\n    async getFilteredPolicy(fieldIndex, ...fieldValues) {\n        return this.getFilteredNamedPolicy('p', fieldIndex, ...fieldValues);\n    }\n    /**\n     * getNamedPolicy gets all the authorization rules in the named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return the \"p\" policy rules of the specified ptype.\n     */\n    async getNamedPolicy(ptype) {\n        return this.model.getPolicy('p', ptype);\n    }\n    /**\n     * getFilteredNamedPolicy gets all the authorization rules in the named policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return the filtered \"p\" policy rules of the specified ptype.\n     */\n    async getFilteredNamedPolicy(ptype, fieldIndex, ...fieldValues) {\n        return this.model.getFilteredPolicy('p', ptype, fieldIndex, ...fieldValues);\n    }\n    /**\n     * getGroupingPolicy gets all the role inheritance rules in the policy.\n     *\n     * @return all the \"g\" policy rules.\n     */\n    async getGroupingPolicy() {\n        return this.getNamedGroupingPolicy('g');\n    }\n    /**\n     * getFilteredGroupingPolicy gets all the role inheritance rules in the policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\" means not to match this field.\n     * @return the filtered \"g\" policy rules.\n     */\n    async getFilteredGroupingPolicy(fieldIndex, ...fieldValues) {\n        return this.getFilteredNamedGroupingPolicy('g', fieldIndex, ...fieldValues);\n    }\n    /**\n     * getNamedGroupingPolicy gets all the role inheritance rules in the policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @return the \"g\" policy rules of the specified ptype.\n     */\n    async getNamedGroupingPolicy(ptype) {\n        return this.model.getPolicy('g', ptype);\n    }\n    /**\n     * getFilteredNamedGroupingPolicy gets all the role inheritance rules in the policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return the filtered \"g\" policy rules of the specified ptype.\n     */\n    async getFilteredNamedGroupingPolicy(ptype, fieldIndex, ...fieldValues) {\n        return this.model.getFilteredPolicy('g', ptype, fieldIndex, ...fieldValues);\n    }\n    /**\n     * hasPolicy determines whether an authorization rule exists.\n     *\n     * @param params the \"p\" policy rule, ptype \"p\" is implicitly used.\n     * @return whether the rule exists.\n     */\n    async hasPolicy(...params) {\n        return this.hasNamedPolicy('p', ...params);\n    }\n    /**\n     * hasNamedPolicy determines whether a named authorization rule exists.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param params the \"p\" policy rule.\n     * @return whether the rule exists.\n     */\n    async hasNamedPolicy(ptype, ...params) {\n        return this.model.hasPolicy('p', ptype, params);\n    }\n    /**\n     * addPolicy adds an authorization rule to the current policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param params the \"p\" policy rule, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addPolicy(...params) {\n        return this.addNamedPolicy('p', ...params);\n    }\n    /**\n     * addPolicies adds authorization rules to the current policy.\n     * If the rule already exists, the function returns false and the rules will not be added.\n     * Otherwise the function returns true by adding the new rules.\n     *\n     * @param rules the \"p\" policy rules, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addPolicies(rules) {\n        return this.addNamedPolicies('p', rules);\n    }\n    /**\n     * addNamedPolicy adds an authorization rule to the current named policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param params the \"p\" policy rule.\n     * @return succeeds or not.\n     */\n    async addNamedPolicy(ptype, ...params) {\n        return this.addPolicyInternal('p', ptype, params, true);\n    }\n    /**\n     * addNamedPolicies adds authorization rules to the current named policy.\n     * If the rule already exists, the function returns false and the rules will not be added.\n     * Otherwise the function returns true by adding the new rules.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param rules the \"p\" policy rules.\n     * @return succeeds or not.\n     */\n    async addNamedPolicies(ptype, rules) {\n        return this.addPoliciesInternal('p', ptype, rules, true);\n    }\n    /**\n     * addPoliciesEx adds authorization rules to the current policy.\n     * If a rule already exists, the function will skip it and continue to add the remaining rules.\n     * The function returns true if at least one rule was added successfully.\n     *\n     * @param rules the \"p\" policy rules, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addPoliciesEx(rules) {\n        return this.addNamedPoliciesEx('p', rules);\n    }\n    /**\n     * addNamedPoliciesEx adds authorization rules to the current named policy.\n     * If a rule already exists, the function will skip it and continue to add the remaining rules.\n     * The function returns true if at least one rule was added successfully.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param rules the \"p\" policy rules.\n     * @return succeeds or not.\n     */\n    async addNamedPoliciesEx(ptype, rules) {\n        return this.addPoliciesInternalEx('p', ptype, rules, true);\n    }\n    /**\n     * updatePolicy updates an authorization rule from the current policy.\n     * If the rule not exists, the function returns false.\n     * Otherwise the function returns true by changing it to the new rule.\n     *\n     * @return succeeds or not.\n     * @param oldRule the policy will be remove\n     * @param newRule the policy will be added\n     */\n    async updatePolicy(oldRule, newRule) {\n        return this.updateNamedPolicy('p', oldRule, newRule);\n    }\n    /**\n     * updateNamedPolicy updates an authorization rule from the current named policy.\n     * If the rule not exists, the function returns false.\n     * Otherwise the function returns true by changing it to the new rule.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param oldRule the policy rule will be remove\n     * @param newRule the policy rule will be added\n     * @return succeeds or not.\n     */\n    async updateNamedPolicy(ptype, oldRule, newRule) {\n        return this.updatePolicyInternal('p', ptype, oldRule, newRule, true);\n    }\n    /**\n     * removePolicy removes an authorization rule from the current policy.\n     *\n     * @param params the \"p\" policy rule, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async removePolicy(...params) {\n        return this.removeNamedPolicy('p', ...params);\n    }\n    /**\n     * removePolicies removes an authorization rules from the current policy.\n     *\n     * @param rules the \"p\" policy rules, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async removePolicies(rules) {\n        return this.removeNamedPolicies('p', rules);\n    }\n    /**\n     * removeFilteredPolicy removes an authorization rule from the current policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredPolicy(fieldIndex, ...fieldValues) {\n        return this.removeFilteredNamedPolicy('p', fieldIndex, ...fieldValues);\n    }\n    /**\n     * removeNamedPolicy removes an authorization rule from the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param params the \"p\" policy rule.\n     * @return succeeds or not.\n     */\n    async removeNamedPolicy(ptype, ...params) {\n        return this.removePolicyInternal('p', ptype, params, true);\n    }\n    /**\n     * removeNamedPolicies removes authorization rules from the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param rules the \"p\" policy rules.\n     * @return succeeds or not.\n     */\n    async removeNamedPolicies(ptype, rules) {\n        return this.removePoliciesInternal('p', ptype, rules, true);\n    }\n    /**\n     * removeFilteredNamedPolicy removes an authorization rule from the current named policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredNamedPolicy(ptype, fieldIndex, ...fieldValues) {\n        return this.removeFilteredPolicyInternal('p', ptype, fieldIndex, fieldValues, true);\n    }\n    /**\n     * hasGroupingPolicy determines whether a role inheritance rule exists.\n     *\n     * @param params the \"g\" policy rule, ptype \"g\" is implicitly used.\n     * @return whether the rule exists.\n     */\n    async hasGroupingPolicy(...params) {\n        return this.hasNamedGroupingPolicy('g', ...params);\n    }\n    /**\n     * hasNamedGroupingPolicy determines whether a named role inheritance rule exists.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param params the \"g\" policy rule.\n     * @return whether the rule exists.\n     */\n    async hasNamedGroupingPolicy(ptype, ...params) {\n        return this.model.hasPolicy('g', ptype, params);\n    }\n    /**\n     * addGroupingPolicy adds a role inheritance rule to the current policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param params the \"g\" policy rule, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addGroupingPolicy(...params) {\n        return this.addNamedGroupingPolicy('g', ...params);\n    }\n    /**\n     * addGroupingPolicies adds a role inheritance rules to the current policy.\n     * If the rule already exists, the function returns false and the rules will not be added.\n     * Otherwise the function returns true by adding the new rules.\n     *\n     * @param rules the \"g\" policy rules, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addGroupingPolicies(rules) {\n        return this.addNamedGroupingPolicies('g', rules);\n    }\n    /**\n     * addNamedGroupingPolicy adds a named role inheritance rule to the current policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param params the \"g\" policy rule.\n     * @return succeeds or not.\n     */\n    async addNamedGroupingPolicy(ptype, ...params) {\n        return this.addPolicyInternal('g', ptype, params, true);\n    }\n    /**\n     * addNamedGroupingPolicies adds named role inheritance rules to the current policy.\n     * If the rule already exists, the function returns false and the rules will not be added.\n     * Otherwise the function returns true by adding the new rules.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param rules the \"g\" policy rule.\n     * @return succeeds or not.\n     */\n    async addNamedGroupingPolicies(ptype, rules) {\n        return this.addPoliciesInternal('g', ptype, rules, true);\n    }\n    /**\n     * addGroupingPoliciesEx adds role inheritance rules to the current policy.\n     * If a rule already exists, the function will skip it and continue to add the remaining rules.\n     * The function returns true if at least one rule was added successfully.\n     *\n     * @param rules the \"g\" policy rules, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addGroupingPoliciesEx(rules) {\n        return this.addNamedGroupingPoliciesEx('g', rules);\n    }\n    /**\n     * addNamedGroupingPoliciesEx adds named role inheritance rules to the current policy.\n     * If a rule already exists, the function will skip it and continue to add the remaining rules.\n     * The function returns true if at least one rule was added successfully.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param rules the \"g\" policy rules.\n     * @return succeeds or not.\n     */\n    async addNamedGroupingPoliciesEx(ptype, rules) {\n        return this.addPoliciesInternalEx('g', ptype, rules, true);\n    }\n    /**\n     * removeGroupingPolicy removes a role inheritance rule from the current policy.\n     *\n     * @param params the \"g\" policy rule, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async removeGroupingPolicy(...params) {\n        return this.removeNamedGroupingPolicy('g', ...params);\n    }\n    /**\n     * removeGroupingPolicies removes role inheritance rules from the current policy.\n     *\n     * @param rules the \"g\" policy rules, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async removeGroupingPolicies(rules) {\n        return this.removeNamedGroupingPolicies('g', rules);\n    }\n    /**\n     * removeFilteredGroupingPolicy removes a role inheritance rule from the current policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredGroupingPolicy(fieldIndex, ...fieldValues) {\n        return this.removeFilteredNamedGroupingPolicy('g', fieldIndex, ...fieldValues);\n    }\n    /**\n     * removeNamedGroupingPolicy removes a role inheritance rule from the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param params the \"g\" policy rule.\n     * @return succeeds or not.\n     */\n    async removeNamedGroupingPolicy(ptype, ...params) {\n        return this.removePolicyInternal('g', ptype, params, true);\n    }\n    /**\n     * removeNamedGroupingPolicies removes role inheritance rules from the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param rules the \"g\" policy rules.\n     * @return succeeds or not.\n     */\n    async removeNamedGroupingPolicies(ptype, rules) {\n        return this.removePoliciesInternal('g', ptype, rules, true);\n    }\n    /**\n     * removeFilteredNamedGroupingPolicy removes a role inheritance rule from the current named policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredNamedGroupingPolicy(ptype, fieldIndex, ...fieldValues) {\n        return this.removeFilteredPolicyInternal('g', ptype, fieldIndex, fieldValues, true);\n    }\n    /**\n     * UpdateGroupingPolicy updates an rule to the current named policy.\n     *\n     * @param oldRule the old rule.\n     * @param newRule the new rule.\n     * @return succeeds or not.\n     */\n    async updateGroupingPolicy(oldRule, newRule) {\n        return this.updateNamedGroupingPolicy('g', oldRule, newRule);\n    }\n    /**\n     * updateNamedGroupingPolicy updates an rule to the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param oldRule the old rule.\n     * @param newRule the new rule.\n     * @return succeeds or not.\n     */\n    async updateNamedGroupingPolicy(ptype, oldRule, newRule) {\n        return this.updatePolicyInternal('g', ptype, oldRule, newRule, true);\n    }\n    /**\n     * addFunction adds a customized function.\n     * @param name custom function name\n     * @param func function\n     */\n    async addFunction(name, func) {\n        this.fm.addFunction(name, func);\n    }\n    async selfAddPolicy(sec, ptype, rule) {\n        return this.addPolicyWithoutNotify(sec, ptype, rule);\n    }\n    async selfAddPolicies(sec, ptype, rules) {\n        return this.addPoliciesWithoutNotify(sec, ptype, rules);\n    }\n    async selfRemovePolicy(sec, ptype, rule) {\n        return this.removePolicyWithoutNotify(sec, ptype, rule);\n    }\n    async selfRemovePolicies(sec, ptype, rules) {\n        return this.removePoliciesWithoutNotify(sec, ptype, rules);\n    }\n    async selfRemoveFilteredPolicy(sec, ptype, fieldIndex, ...fieldValues) {\n        return this.removeFilteredPolicyWithoutNotify(sec, ptype, fieldIndex, fieldValues);\n    }\n    async selfUpdatePolicy(sec, ptype, oldRule, newRule) {\n        return this.updatePolicyWithoutNotify(sec, ptype, oldRule, newRule);\n    }\n    async selfUpdatePolicies(sec, ptype, oldRules, newRules) {\n        return this.updatePoliciesWithoutNotify(sec, ptype, oldRules, newRules);\n    }\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 4645, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/enforcer.js"],"sourcesContent":["// Copyright 2018 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { ManagementEnforcer } from './managementEnforcer';\nimport { newModelFromFile } from './model';\nimport { FileAdapter, getDefaultFileSystem, setDefaultFileSystem, StringAdapter } from './persist';\nimport { getLogger } from './log';\nimport { arrayRemoveDuplicates } from './util';\n/**\n * Enforcer = ManagementEnforcer + RBAC API.\n */\nexport class Enforcer extends ManagementEnforcer {\n    /**\n     * initWithFile initializes an enforcer with a model file and a policy file.\n     * @param modelPath model file path\n     * @param policyPath policy file path\n     * @param lazyLoad lazyLoad whether to load policy at initial time\n     */\n    async initWithFile(modelPath, policyPath, lazyLoad = false) {\n        const a = new FileAdapter(policyPath, this.fs);\n        await this.initWithAdapter(modelPath, a, lazyLoad);\n    }\n    /**\n     * initWithFile initializes an enforcer with a model file and a policy file.\n     * @param modelPath model file path\n     * @param policyString policy CSV string\n     * @param lazyLoad whether to load policy at initial time\n     */\n    async initWithString(modelPath, policyString, lazyLoad = false) {\n        const a = new StringAdapter(policyString);\n        await this.initWithAdapter(modelPath, a, lazyLoad);\n    }\n    /**\n     * initWithAdapter initializes an enforcer with a database adapter.\n     * @param modelPath model file path\n     * @param adapter current adapter instance\n     * @param lazyLoad whether to load policy at initial time\n     */\n    async initWithAdapter(modelPath, adapter, lazyLoad = false) {\n        const m = newModelFromFile(modelPath, this.fs);\n        await this.initWithModelAndAdapter(m, adapter, lazyLoad);\n        this.modelPath = modelPath;\n    }\n    /**\n     * initWithModelAndAdapter initializes an enforcer with a model and a database adapter.\n     * @param m model instance\n     * @param adapter current adapter instance\n     * @param lazyLoad whether to load policy at initial time\n     */\n    async initWithModelAndAdapter(m, adapter, lazyLoad = false) {\n        if (adapter) {\n            this.adapter = adapter;\n        }\n        this.model = m;\n        this.model.printModel();\n        this.initRmMap();\n        if (!lazyLoad && this.adapter) {\n            await this.loadPolicy();\n        }\n    }\n    /**\n     * getRolesForUser gets the roles that a user has.\n     *\n     * @param name the user.\n     * @param domain the domain.\n     * @return the roles that the user has.\n     */\n    async getRolesForUser(name, domain) {\n        const rm = this.rmMap.get('g');\n        if (rm) {\n            if (domain === undefined) {\n                return rm.getRoles(name);\n            }\n            else {\n                return rm.getRoles(name, domain);\n            }\n        }\n        throw new Error(\"RoleManager didn't exist.\");\n    }\n    /**\n     * getUsersForRole gets the users that has a role.\n     *\n     * @param name the role.\n     * @param domain the domain.\n     * @return the users that has the role.\n     */\n    async getUsersForRole(name, domain) {\n        const rm = this.rmMap.get('g');\n        if (rm) {\n            if (domain === undefined) {\n                return rm.getUsers(name);\n            }\n            else {\n                return rm.getUsers(name, domain);\n            }\n        }\n        throw new Error(\"RoleManager didn't exist.\");\n    }\n    /**\n     * hasRoleForUser determines whether a user has a role.\n     *\n     * @param name the user.\n     * @param role the role.\n     * @param domain the domain.\n     * @return whether the user has the role.\n     */\n    async hasRoleForUser(name, role, domain) {\n        const roles = await this.getRolesForUser(name, domain);\n        let hasRole = false;\n        for (const r of roles) {\n            if (r === role) {\n                hasRole = true;\n                break;\n            }\n        }\n        return hasRole;\n    }\n    /**\n     * addRoleForUser adds a role for a user.\n     * Returns false if the user already has the role (aka not affected).\n     *\n     * @param user the user.\n     * @param role the role.\n     * @param domain the domain.\n     * @return succeeds or not.\n     */\n    async addRoleForUser(user, role, domain) {\n        if (domain === undefined) {\n            return this.addGroupingPolicy(user, role);\n        }\n        else {\n            return this.addGroupingPolicy(user, role, domain);\n        }\n    }\n    /**\n     * deleteRoleForUser deletes a role for a user.\n     * Returns false if the user does not have the role (aka not affected).\n     *\n     * @param user the user.\n     * @param role the role.\n     * @param domain the domain.\n     * @return succeeds or not.\n     */\n    async deleteRoleForUser(user, role, domain) {\n        if (!user) {\n            throw new Error('user must not be empty');\n        }\n        if (!role) {\n            throw new Error('role must not be empty');\n        }\n        if (domain === undefined) {\n            return this.removeGroupingPolicy(user, role);\n        }\n        else {\n            return this.removeGroupingPolicy(user, role, domain);\n        }\n    }\n    /**\n     * deleteRolesForUser deletes all roles for a user.\n     * Returns false if the user does not have any roles (aka not affected).\n     *\n     * @param user the user.\n     * @param domain the domain.\n     * @return succeeds or not.\n     */\n    async deleteRolesForUser(user, domain) {\n        if (!user) {\n            throw new Error('user must not be empty');\n        }\n        if (domain === undefined) {\n            const subIndex = this.getFieldIndex('p', \"sub\" /* FieldIndex.Subject */);\n            return this.removeFilteredGroupingPolicy(subIndex, user);\n        }\n        else {\n            return this.removeFilteredGroupingPolicy(0, user, '', domain);\n        }\n    }\n    /**\n     * deleteUser deletes a user.\n     * Returns false if the user does not exist (aka not affected).\n     *\n     * @param user the user.\n     * @return succeeds or not.\n     */\n    async deleteUser(user) {\n        if (!user) {\n            throw new Error('user must not be empty');\n        }\n        const subIndex = this.getFieldIndex('p', \"sub\" /* FieldIndex.Subject */);\n        const res1 = await this.removeFilteredGroupingPolicy(subIndex, user);\n        const res2 = await this.removeFilteredPolicy(subIndex, user);\n        return res1 || res2;\n    }\n    /**\n     * deleteRole deletes a role.\n     * Returns false if the role does not exist (aka not affected).\n     *\n     * @param role the role.\n     * @return succeeds or not.\n     */\n    async deleteRole(role) {\n        if (!role) {\n            throw new Error('role must not be empty');\n        }\n        const subIndex = this.getFieldIndex('p', \"sub\" /* FieldIndex.Subject */);\n        const res1 = await this.removeFilteredGroupingPolicy(subIndex, role);\n        const res2 = await this.removeFilteredPolicy(subIndex, role);\n        return res1 || res2;\n    }\n    /**\n     * deletePermission deletes a permission.\n     * Returns false if the permission does not exist (aka not affected).\n     *\n     * @param permission the permission, usually be (obj, act). It is actually the rule without the subject.\n     * @return succeeds or not.\n     */\n    async deletePermission(...permission) {\n        if (permission.length === 0) {\n            throw new Error('permission must not be empty');\n        }\n        return this.removeFilteredPolicy(1, ...permission);\n    }\n    /**\n     * addPermissionForUser adds a permission for a user or role.\n     * Returns false if the user or role already has the permission (aka not affected).\n     *\n     * @param user the user.\n     * @param permission the permission, usually be (obj, act). It is actually the rule without the subject.\n     * @return succeeds or not.\n     */\n    async addPermissionForUser(user, ...permission) {\n        permission.unshift(user);\n        return this.addPolicy(...permission);\n    }\n    /**\n     * deletePermissionForUser deletes a permission for a user or role.\n     * Returns false if the user or role does not have the permission (aka not affected).\n     *\n     * @param user the user.\n     * @param permission the permission, usually be (obj, act). It is actually the rule without the subject.\n     * @return succeeds or not.\n     */\n    async deletePermissionForUser(user, ...permission) {\n        if (!user) {\n            throw new Error('user must not be empty');\n        }\n        permission.unshift(user);\n        return this.removePolicy(...permission);\n    }\n    /**\n     * deletePermissionsForUser deletes permissions for a user or role.\n     * Returns false if the user or role does not have any permissions (aka not affected).\n     *\n     * @param user the user.\n     * @return succeeds or not.\n     */\n    async deletePermissionsForUser(user) {\n        if (!user) {\n            throw new Error('user must not be empty');\n        }\n        const subIndex = this.getFieldIndex('p', \"sub\" /* FieldIndex.Subject */);\n        return this.removeFilteredPolicy(subIndex, user);\n    }\n    /**\n     * getPermissionsForUser gets permissions for a user or role.\n     *\n     * @param user the user.\n     * @return the permissions, a permission is usually like (obj, act). It is actually the rule without the subject.\n     */\n    async getPermissionsForUser(user) {\n        const subIndex = this.getFieldIndex('p', \"sub\" /* FieldIndex.Subject */);\n        return this.getFilteredPolicy(subIndex, user);\n    }\n    /**\n     * hasPermissionForUser determines whether a user has a permission.\n     *\n     * @param user the user.\n     * @param permission the permission, usually be (obj, act). It is actually the rule without the subject.\n     * @return whether the user has the permission.\n     */\n    async hasPermissionForUser(user, ...permission) {\n        permission.unshift(user);\n        return this.hasPolicy(...permission);\n    }\n    /**\n     * getImplicitRolesForUser gets implicit roles that a user has.\n     * Compared to getRolesForUser(), this function retrieves indirect roles besides direct roles.\n     * For example:\n     * g, alice, role:admin\n     * g, role:admin, role:user\n     *\n     * getRolesForUser(\"alice\") can only get: [\"role:admin\"].\n     * But getImplicitRolesForUser(\"alice\") will get: [\"role:admin\", \"role:user\"].\n     */\n    async getImplicitRolesForUser(name, ...domain) {\n        const res = new Set();\n        const q = [name];\n        let n;\n        while ((n = q.shift()) !== undefined) {\n            for (const rm of this.rmMap.values()) {\n                const role = await rm.getRoles(n, ...domain);\n                role.forEach((r) => {\n                    if (!res.has(r)) {\n                        res.add(r);\n                        q.push(r);\n                    }\n                });\n            }\n        }\n        return Array.from(res);\n    }\n    /**\n     * getImplicitPermissionsForUser gets implicit permissions for a user or role.\n     * Compared to getPermissionsForUser(), this function retrieves permissions for inherited roles.\n     * For example:\n     * p, admin, data1, read\n     * p, alice, data2, read\n     * g, alice, admin\n     *\n     * getPermissionsForUser(\"alice\") can only get: [[\"alice\", \"data2\", \"read\"]].\n     * But getImplicitPermissionsForUser(\"alice\") will get: [[\"admin\", \"data1\", \"read\"], [\"alice\", \"data2\", \"read\"]].\n     */\n    async getImplicitPermissionsForUser(user, ...domain) {\n        const roles = await this.getImplicitRolesForUser(user, ...domain);\n        roles.unshift(user);\n        const res = [];\n        const withDomain = domain && domain.length !== 0;\n        for (const n of roles) {\n            if (withDomain) {\n                const p = await this.getFilteredPolicy(0, n, ...domain);\n                res.push(...p);\n            }\n            else {\n                const p = await this.getPermissionsForUser(n);\n                res.push(...p);\n            }\n        }\n        return res;\n    }\n    /**\n     * getImplicitResourcesForUser returns all policies that user obtaining in domain.\n     */\n    async getImplicitResourcesForUser(user, ...domain) {\n        const permissions = await this.getImplicitPermissionsForUser(user, ...domain);\n        const res = [];\n        for (const permission of permissions) {\n            if (permission[0] === user) {\n                res.push(permission);\n                continue;\n            }\n            let resLocal = [[user]];\n            const tokensLength = permission.length;\n            const t = [];\n            for (const token of permission) {\n                if (token === permission[0]) {\n                    continue;\n                }\n                const tokens = await this.getImplicitUsersForRole(token, ...domain);\n                tokens.push(token);\n                t.push(tokens);\n            }\n            for (let i = 0; i < tokensLength - 1; i++) {\n                const n = [];\n                for (const tokens of t[i]) {\n                    for (const policy of resLocal) {\n                        const t = [...policy];\n                        t.push(tokens);\n                        n.push(t);\n                    }\n                }\n                resLocal = n;\n            }\n            res.push(...resLocal);\n        }\n        return res;\n    }\n    /**\n     * getImplicitUsersForRole gets implicit users that a role has.\n     * Compared to getUsersForRole(), this function retrieves indirect users besides direct users.\n     * For example:\n     * g, alice, role:admin\n     * g, role:admin, role:user\n     *\n     * getUsersForRole(\"user\") can only get: [\"role:admin\"].\n     * But getImplicitUsersForRole(\"user\") will get: [\"role:admin\", \"alice\"].\n     */\n    async getImplicitUsersForRole(role, ...domain) {\n        const res = new Set();\n        const q = [role];\n        let n;\n        while ((n = q.shift()) !== undefined) {\n            for (const rm of this.rmMap.values()) {\n                const user = await rm.getUsers(n, ...domain);\n                user.forEach((u) => {\n                    if (!res.has(u)) {\n                        res.add(u);\n                        q.push(u);\n                    }\n                });\n            }\n        }\n        return Array.from(res);\n    }\n    /**\n     * getRolesForUserInDomain gets the roles that a user has inside a domain\n     * An alias for getRolesForUser with the domain params.\n     *\n     * @param name the user.\n     * @param domain the domain.\n     * @return the roles that the user has.\n     */\n    async getRolesForUserInDomain(name, domain) {\n        return this.getRolesForUser(name, domain);\n    }\n    /**\n     * getUsersForRoleInFomain gets the users that has a role inside a domain\n     * An alias for getUsesForRole with the domain params.\n     *\n     * @param name the role.\n     * @param domain the domain.\n     * @return the users that has the role.\n     */\n    async getUsersForRoleInDomain(name, domain) {\n        return this.getUsersForRole(name, domain);\n    }\n    /**\n     * getImplicitUsersForPermission gets implicit users for a permission.\n     * For example:\n     * p, admin, data1, read\n     * p, bob, data1, read\n     * g, alice, admin\n     *\n     * getImplicitUsersForPermission(\"data1\", \"read\") will get: [\"alice\", \"bob\"].\n     * Note: only users will be returned, roles (2nd arg in \"g\") will be excluded.\n     */\n    async getImplicitUsersForPermission(...permission) {\n        const res = [];\n        const policySubjects = await this.getAllSubjects();\n        const subjects = arrayRemoveDuplicates([...policySubjects, ...this.model.getValuesForFieldInPolicyAllTypes('g', 0)]);\n        const inherits = this.model.getValuesForFieldInPolicyAllTypes('g', 1);\n        for (const user of subjects) {\n            const allowed = await this.enforce(user, ...permission);\n            if (allowed) {\n                res.push(user);\n            }\n        }\n        return res.filter((n) => !inherits.some((m) => n === m));\n    }\n    /**\n     * getDomainsForUser gets all domains that a user has.\n     */\n    async getDomainsForUser(user) {\n        const domains = [];\n        for (const rm of this.rmMap.values()) {\n            const domain = await rm.getDomains(user);\n            domains.push(...domain);\n        }\n        return domains;\n    }\n    /**\n     * getAllDomains gets all domains.\n     */\n    async getAllDomains() {\n        const domains = [];\n        for (const rm of this.rmMap.values()) {\n            const domain = await rm.getAllDomains();\n            domains.push(...domain);\n        }\n        return arrayRemoveDuplicates(domains);\n    }\n}\nexport async function newEnforcerWithClass(enforcer, ...params) {\n    var _a;\n    // inject the FS\n    if (!getDefaultFileSystem()) {\n        try {\n            if (typeof process !== 'undefined' && ((_a = process === null || process === void 0 ? void 0 : process.versions) === null || _a === void 0 ? void 0 : _a.node)) {\n                const fs = await import('fs');\n                const defaultFileSystem = {\n                    readFileSync(path, encoding) {\n                        return fs.readFileSync(path, { encoding });\n                    },\n                    writeFileSync(path, text, encoding) {\n                        return fs.writeFileSync(path, text, encoding);\n                    },\n                };\n                setDefaultFileSystem(defaultFileSystem);\n            }\n        }\n        catch (ignored) { }\n    }\n    const e = new enforcer();\n    let parsedParamLen = 0;\n    if (params.length >= 1) {\n        const enableLog = params[params.length - 1];\n        if (typeof enableLog === 'boolean') {\n            getLogger().enableLog(enableLog);\n            parsedParamLen++;\n        }\n    }\n    if (params.length - parsedParamLen === 2) {\n        if (typeof params[0] === 'string') {\n            if (typeof params[1] === 'string') {\n                await e.initWithFile(params[0].toString(), params[1].toString());\n            }\n            else {\n                await e.initWithAdapter(params[0].toString(), params[1], params[2] === true);\n            }\n        }\n        else {\n            if (typeof params[1] === 'string') {\n                throw new Error('Invalid parameters for enforcer.');\n            }\n            else {\n                await e.initWithModelAndAdapter(params[0], params[1]);\n            }\n        }\n    }\n    else if (params.length - parsedParamLen === 1) {\n        if (typeof params[0] === 'string') {\n            await e.initWithFile(params[0], '');\n        }\n        else {\n            await e.initWithModelAndAdapter(params[0]);\n        }\n    }\n    else if (params.length === parsedParamLen) {\n        await e.initWithFile('', '');\n    }\n    else {\n        throw new Error('Invalid parameters for enforcer.');\n    }\n    return e;\n}\n/**\n * newEnforcer creates an enforcer via file or DB.\n *\n * File:\n * ```js\n * const e = new Enforcer('path/to/basic_model.conf', 'path/to/basic_policy.csv');\n * ```\n *\n * MySQL DB:\n * ```js\n * const a = new MySQLAdapter('mysql', 'mysql_username:mysql_password@tcp(127.0.0.1:3306)/');\n * const e = new Enforcer('path/to/basic_model.conf', a);\n * ```\n *\n * @param params\n */\nexport async function newEnforcer(...params) {\n    return newEnforcerWithClass(Enforcer, ...params);\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5186, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/cachedEnforcer.js"],"sourcesContent":["// Copyright 2020 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { Enforcer, newEnforcerWithClass } from './enforcer';\n// CachedEnforcer wraps Enforcer and provides decision cache\nexport class CachedEnforcer extends Enforcer {\n    constructor() {\n        super(...arguments);\n        this.enableCache = true;\n        this.m = new Map();\n    }\n    // invalidateCache deletes all the existing cached decisions.\n    invalidateCache() {\n        this.m = new Map();\n    }\n    // setEnableCache determines whether to enable cache on e nforce(). When enableCache is enabled, cached result (true | false) will be returned for previous decisions.\n    setEnableCache(enableCache) {\n        this.enableCache = enableCache;\n    }\n    static canCache(...rvals) {\n        return rvals.every((n) => typeof n === 'string');\n    }\n    static getCacheKey(...rvals) {\n        return rvals.join('$$');\n    }\n    getCache(key) {\n        return this.m.get(key);\n    }\n    setCache(key, value) {\n        this.m.set(key, value);\n    }\n    // enforce decides whether a \"subject\" can access a \"object\" with the operation \"action\", input parameters are usually: (sub, obj, act).\n    // if rvals is not string , ingore the cache\n    async enforce(...rvals) {\n        if (!this.enableCache) {\n            return super.enforce(...rvals);\n        }\n        let key = '';\n        const cache = CachedEnforcer.canCache(...rvals);\n        if (cache) {\n            key = CachedEnforcer.getCacheKey(...rvals);\n            const res = this.getCache(key);\n            if (res !== undefined) {\n                return res;\n            }\n        }\n        const res = await super.enforce(...rvals);\n        if (cache) {\n            this.setCache(key, res);\n        }\n        return res;\n    }\n}\n// newCachedEnforcer creates a cached enforcer via file or DB.\nexport async function newCachedEnforcer(...params) {\n    return newEnforcerWithClass(CachedEnforcer, ...params);\n}\n"],"names":[],"mappings":";;;;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;;AAEO,MAAM,uBAAuB,6KAAQ;IACxC,aAAc;QACV,KAAK,IAAI;QACT,IAAI,CAAC,WAAW,GAAG;QACnB,IAAI,CAAC,CAAC,GAAG,IAAI;IACjB;IACA,6DAA6D;IAC7D,kBAAkB;QACd,IAAI,CAAC,CAAC,GAAG,IAAI;IACjB;IACA,sKAAsK;IACtK,eAAe,WAAW,EAAE;QACxB,IAAI,CAAC,WAAW,GAAG;IACvB;IACA,OAAO,SAAS,GAAG,KAAK,EAAE;QACtB,OAAO,MAAM,KAAK,CAAC,CAAC,IAAM,OAAO,MAAM;IAC3C;IACA,OAAO,YAAY,GAAG,KAAK,EAAE;QACzB,OAAO,MAAM,IAAI,CAAC;IACtB;IACA,SAAS,GAAG,EAAE;QACV,OAAO,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC;IACtB;IACA,SAAS,GAAG,EAAE,KAAK,EAAE;QACjB,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK;IACpB;IACA,wIAAwI;IACxI,4CAA4C;IAC5C,MAAM,QAAQ,GAAG,KAAK,EAAE;QACpB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;YACnB,OAAO,KAAK,CAAC,WAAW;QAC5B;QACA,IAAI,MAAM;QACV,MAAM,QAAQ,eAAe,QAAQ,IAAI;QACzC,IAAI,OAAO;YACP,MAAM,eAAe,WAAW,IAAI;YACpC,MAAM,MAAM,IAAI,CAAC,QAAQ,CAAC;YAC1B,IAAI,QAAQ,WAAW;gBACnB,OAAO;YACX;QACJ;QACA,MAAM,MAAM,MAAM,KAAK,CAAC,WAAW;QACnC,IAAI,OAAO;YACP,IAAI,CAAC,QAAQ,CAAC,KAAK;QACvB;QACA,OAAO;IACX;AACJ;AAEO,eAAe,kBAAkB,GAAG,MAAM;IAC7C,OAAO,IAAA,yLAAoB,EAAC,mBAAmB;AACnD","ignoreList":[0]}},
    {"offset": {"line": 5262, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/syncedEnforcer.js"],"sourcesContent":["// Copyright 2020 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { Enforcer, newEnforcerWithClass } from './enforcer';\nimport AwaitLock from 'await-lock';\n// SyncedEnforcer wraps Enforcer and provides synchronized access\nexport class SyncedEnforcer extends Enforcer {\n    constructor() {\n        super(...arguments);\n        this.lock = new AwaitLock();\n    }\n    /**\n     * setWatcher sets the current watcher.\n     *\n     * @param watcher the watcher.\n     */\n    setWatcher(watcher) {\n        this.watcher = watcher;\n        this.watcher.setUpdateCallback(() => this.loadPolicy());\n    }\n    /**\n     * loadPolicy reloads the policy from file/database.\n     */\n    async loadPolicy() {\n        await this.lock.acquireAsync();\n        return super.loadPolicy().finally(() => this.lock.release());\n    }\n    /**\n     * clearPolicy clears all policy.\n     */\n    clearPolicy() {\n        this.lock\n            .acquireAsync()\n            .then(() => super.clearPolicy())\n            .finally(() => this.lock.release());\n    }\n    /**\n     * savePolicy saves the current policy (usually after changed with Casbin API) back to file/database.\n     */\n    async savePolicy() {\n        await this.lock.acquireAsync();\n        return super.savePolicy().finally(() => this.lock.release());\n    }\n    /**\n     * buildRoleLinks manually rebuild the role inheritance relations.\n     */\n    async buildRoleLinks() {\n        await this.lock.acquireAsync();\n        return super.buildRoleLinks().finally(() => this.lock.release());\n    }\n    /**\n     * If the matchers does not contain an asynchronous method, call it faster.\n     *\n     * enforceWithSyncCompile decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\", input parameters are usually: (sub, obj, act).\n     *\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request.\n     */\n    enforceWithSyncCompile(...rvals) {\n        return super.enforceWithSyncCompile(...rvals);\n    }\n    /**\n     * enforce decides whether a \"subject\" can access a \"object\" with\n     * the operation \"action\", input parameters are usually: (sub, obj, act).\n     *\n     * @param rvals the request needs to be mediated, usually an array\n     *              of strings, can be class instances if ABAC is used.\n     * @return whether to allow the request.\n     */\n    async enforce(...rvals) {\n        await this.lock.acquireAsync();\n        return super.enforce(...rvals).finally(() => this.lock.release());\n    }\n    /**\n     * getAllSubjects gets the list of subjects that show up in the current policy.\n     *\n     * @return all the subjects in \"p\" policy rules. It actually collects the\n     *         0-index elements of \"p\" policy rules. So make sure your subject\n     *         is the 0-index element, like (sub, obj, act). Duplicates are removed.\n     */\n    async getAllSubjects() {\n        return this.getAllNamedSubjects('p');\n    }\n    /**\n     * getAllNamedSubjects gets the list of subjects that show up in the currentnamed policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return all the subjects in policy rules of the ptype type. It actually\n     *         collects the 0-index elements of the policy rules. So make sure\n     *         your subject is the 0-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedSubjects(ptype) {\n        await this.lock.acquireAsync();\n        return super.getAllNamedSubjects(ptype).finally(() => this.lock.release());\n    }\n    /**\n     * getAllObjects gets the list of objects that show up in the current policy.\n     *\n     * @return all the objects in \"p\" policy rules. It actually collects the\n     *         1-index elements of \"p\" policy rules. So make sure your object\n     *         is the 1-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllObjects() {\n        return this.getAllNamedObjects('p');\n    }\n    /**\n     * getAllNamedObjects gets the list of objects that show up in the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return all the objects in policy rules of the ptype type. It actually\n     *         collects the 1-index elements of the policy rules. So make sure\n     *         your object is the 1-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedObjects(ptype) {\n        await this.lock.acquireAsync();\n        return super.getAllNamedObjects(ptype).finally(() => this.lock.release());\n    }\n    /**\n     * getAllActions gets the list of actions that show up in the current policy.\n     *\n     * @return all the actions in \"p\" policy rules. It actually collects\n     *         the 2-index elements of \"p\" policy rules. So make sure your action\n     *         is the 2-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllActions() {\n        return this.getAllNamedActions('p');\n    }\n    /**\n     * GetAllNamedActions gets the list of actions that show up in the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return all the actions in policy rules of the ptype type. It actually\n     *         collects the 2-index elements of the policy rules. So make sure\n     *         your action is the 2-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedActions(ptype) {\n        await this.lock.acquireAsync();\n        return super.getAllNamedActions(ptype).finally(() => this.lock.release());\n    }\n    /**\n     * getAllRoles gets the list of roles that show up in the current policy.\n     *\n     * @return all the roles in \"g\" policy rules. It actually collects\n     *         the 1-index elements of \"g\" policy rules. So make sure your\n     *         role is the 1-index element, like (sub, role).\n     *         Duplicates are removed.\n     */\n    async getAllRoles() {\n        return this.getAllNamedRoles('g');\n    }\n    /**\n     * getAllNamedRoles gets the list of roles that show up in the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @return all the subjects in policy rules of the ptype type. It actually\n     *         collects the 0-index elements of the policy rules. So make\n     *         sure your subject is the 0-index element, like (sub, obj, act).\n     *         Duplicates are removed.\n     */\n    async getAllNamedRoles(ptype) {\n        await this.lock.acquireAsync();\n        return super.getAllNamedRoles(ptype).finally(() => this.lock.release());\n    }\n    /**\n     * getPolicy gets all the authorization rules in the policy.\n     *\n     * @return all the \"p\" policy rules.\n     */\n    async getPolicy() {\n        return this.getNamedPolicy('p');\n    }\n    /**\n     * getFilteredPolicy gets all the authorization rules in the policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return the filtered \"p\" policy rules.\n     */\n    async getFilteredPolicy(fieldIndex, ...fieldValues) {\n        return this.getFilteredNamedPolicy('p', fieldIndex, ...fieldValues);\n    }\n    /**\n     * getNamedPolicy gets all the authorization rules in the named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @return the \"p\" policy rules of the specified ptype.\n     */\n    async getNamedPolicy(ptype) {\n        await this.lock.acquireAsync();\n        return super.getNamedPolicy(ptype).finally(() => this.lock.release());\n    }\n    /**\n     * getFilteredNamedPolicy gets all the authorization rules in the named policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return the filtered \"p\" policy rules of the specified ptype.\n     */\n    async getFilteredNamedPolicy(ptype, fieldIndex, ...fieldValues) {\n        await this.lock.acquireAsync();\n        return super.getFilteredNamedPolicy(ptype, fieldIndex, ...fieldValues).finally(() => this.lock.release());\n    }\n    /**\n     * getGroupingPolicy gets all the role inheritance rules in the policy.\n     *\n     * @return all the \"g\" policy rules.\n     */\n    async getGroupingPolicy() {\n        return this.getNamedGroupingPolicy('g');\n    }\n    /**\n     * getFilteredGroupingPolicy gets all the role inheritance rules in the policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\" means not to match this field.\n     * @return the filtered \"g\" policy rules.\n     */\n    async getFilteredGroupingPolicy(fieldIndex, ...fieldValues) {\n        return this.getFilteredNamedGroupingPolicy('g', fieldIndex, ...fieldValues);\n    }\n    /**\n     * getNamedGroupingPolicy gets all the role inheritance rules in the policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @return the \"g\" policy rules of the specified ptype.\n     */\n    async getNamedGroupingPolicy(ptype) {\n        await this.lock.acquireAsync();\n        return super.getNamedGroupingPolicy(ptype).finally(() => this.lock.release());\n    }\n    /**\n     * getFilteredNamedGroupingPolicy gets all the role inheritance rules in the policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return the filtered \"g\" policy rules of the specified ptype.\n     */\n    async getFilteredNamedGroupingPolicy(ptype, fieldIndex, ...fieldValues) {\n        await this.lock.acquireAsync();\n        return super.getFilteredNamedGroupingPolicy(ptype, fieldIndex, ...fieldValues).finally(() => this.lock.release());\n    }\n    /**\n     * hasPolicy determines whether an authorization rule exists.\n     *\n     * @param params the \"p\" policy rule, ptype \"p\" is implicitly used.\n     * @return whether the rule exists.\n     */\n    async hasPolicy(...params) {\n        return this.hasNamedPolicy('p', ...params);\n    }\n    /**\n     * hasNamedPolicy determines whether a named authorization rule exists.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param params the \"p\" policy rule.\n     * @return whether the rule exists.\n     */\n    async hasNamedPolicy(ptype, ...params) {\n        await this.lock.acquireAsync();\n        return super.hasNamedPolicy(ptype, ...params).finally(() => this.lock.release());\n    }\n    /**\n     * addPolicy adds an authorization rule to the current policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param params the \"p\" policy rule, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addPolicy(...params) {\n        return this.addNamedPolicy('p', ...params);\n    }\n    /**\n     * addNamedPolicy adds an authorization rule to the current named policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param params the \"p\" policy rule.\n     * @return succeeds or not.\n     */\n    async addNamedPolicy(ptype, ...params) {\n        await this.lock.acquireAsync();\n        return super.addNamedPolicy(ptype, ...params).finally(() => this.lock.release());\n    }\n    /**\n     * removePolicy removes an authorization rule from the current policy.\n     *\n     * @param params the \"p\" policy rule, ptype \"p\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async removePolicy(...params) {\n        return this.removeNamedPolicy('p', ...params);\n    }\n    /**\n     * removeFilteredPolicy removes an authorization rule from the current policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredPolicy(fieldIndex, ...fieldValues) {\n        return this.removeFilteredNamedPolicy('p', fieldIndex, ...fieldValues);\n    }\n    /**\n     * removeNamedPolicy removes an authorization rule from the current named policy.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param params the \"p\" policy rule.\n     * @return succeeds or not.\n     */\n    async removeNamedPolicy(ptype, ...params) {\n        await this.lock.acquireAsync();\n        return this.removePolicyInternal('p', ptype, params, true).finally(() => this.lock.release());\n    }\n    /**\n     * removeFilteredNamedPolicy removes an authorization rule from the current named policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"p\", \"p2\", \"p3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredNamedPolicy(ptype, fieldIndex, ...fieldValues) {\n        await this.lock.acquireAsync();\n        return super.removeFilteredNamedPolicy(ptype, fieldIndex, ...fieldValues).finally(() => this.lock.release());\n    }\n    /**\n     * hasGroupingPolicy determines whether a role inheritance rule exists.\n     *\n     * @param params the \"g\" policy rule, ptype \"g\" is implicitly used.\n     * @return whether the rule exists.\n     */\n    async hasGroupingPolicy(...params) {\n        return this.hasNamedGroupingPolicy('g', ...params);\n    }\n    /**\n     * hasNamedGroupingPolicy determines whether a named role inheritance rule exists.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param params the \"g\" policy rule.\n     * @return whether the rule exists.\n     */\n    async hasNamedGroupingPolicy(ptype, ...params) {\n        await this.lock.acquireAsync();\n        return super.hasNamedGroupingPolicy(ptype, ...params).finally(() => this.lock.release());\n    }\n    /**\n     * addGroupingPolicy adds a role inheritance rule to the current policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param params the \"g\" policy rule, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async addGroupingPolicy(...params) {\n        return this.addNamedGroupingPolicy('g', ...params);\n    }\n    /**\n     * addNamedGroupingPolicy adds a named role inheritance rule to the current policy.\n     * If the rule already exists, the function returns false and the rule will not be added.\n     * Otherwise the function returns true by adding the new rule.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param params the \"g\" policy rule.\n     * @return succeeds or not.\n     */\n    async addNamedGroupingPolicy(ptype, ...params) {\n        await this.lock.acquireAsync();\n        return super.addNamedGroupingPolicy(ptype, ...params).finally(() => this.lock.release());\n    }\n    /**\n     * removeGroupingPolicy removes a role inheritance rule from the current policy.\n     *\n     * @param params the \"g\" policy rule, ptype \"g\" is implicitly used.\n     * @return succeeds or not.\n     */\n    async removeGroupingPolicy(...params) {\n        return this.removeNamedGroupingPolicy('g', ...params);\n    }\n    /**\n     * removeFilteredGroupingPolicy removes a role inheritance rule from the current policy, field filters can be specified.\n     *\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredGroupingPolicy(fieldIndex, ...fieldValues) {\n        return this.removeFilteredNamedGroupingPolicy('g', fieldIndex, ...fieldValues);\n    }\n    /**\n     * removeNamedGroupingPolicy removes a role inheritance rule from the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param params the \"g\" policy rule.\n     * @return succeeds or not.\n     */\n    async removeNamedGroupingPolicy(ptype, ...params) {\n        await this.lock.acquireAsync();\n        return super.removeNamedGroupingPolicy(ptype, ...params).finally(() => this.lock.release());\n    }\n    /**\n     * removeFilteredNamedGroupingPolicy removes a role inheritance rule from the current named policy, field filters can be specified.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param fieldIndex the policy rule's start index to be matched.\n     * @param fieldValues the field values to be matched, value \"\"\n     *                    means not to match this field.\n     * @return succeeds or not.\n     */\n    async removeFilteredNamedGroupingPolicy(ptype, fieldIndex, ...fieldValues) {\n        await this.lock.acquireAsync();\n        return super.removeFilteredNamedGroupingPolicy(ptype, fieldIndex, ...fieldValues).finally(() => this.lock.release());\n    }\n    /**\n     * UpdateGroupingPolicy updates an rule to the current named policy.\n     *\n     * @param oldRule the old rule.\n     * @param newRule the new rule.\n     * @return succeeds or not.\n     */\n    async updateGroupingPolicy(oldRule, newRule) {\n        return super.updateGroupingPolicy(oldRule, newRule);\n    }\n    /**\n     * updateNamedGroupingPolicy updates an rule to the current named policy.\n     *\n     * @param ptype the policy type, can be \"g\", \"g2\", \"g3\", ..\n     * @param oldRule the old rule.\n     * @param newRule the new rule.\n     * @return succeeds or not.\n     */\n    async updateNamedGroupingPolicy(ptype, oldRule, newRule) {\n        return super.updateNamedGroupingPolicy(ptype, oldRule, newRule);\n    }\n    /**\n     * add matching function to RoleManager by ptype\n     * @param ptype g\n     * @param fn the function will be added\n     */\n    async addNamedMatchingFunc(ptype, fn) {\n        await this.lock.acquireAsync();\n        return super.addNamedMatchingFunc(ptype, fn).finally(() => this.lock.release());\n    }\n    /**\n     * add domain matching function to RoleManager by ptype\n     * @param ptype g\n     * @param fn the function will be added\n     */\n    async addNamedDomainMatchingFunc(ptype, fn) {\n        await this.lock.acquireAsync();\n        return super.addNamedDomainMatchingFunc(ptype, fn).finally(() => {\n            this.lock.release();\n        });\n    }\n}\n// newSyncedEnforcer creates a synchronized enforcer via file or DB.\nexport async function newSyncedEnforcer(...params) {\n    return newEnforcerWithClass(SyncedEnforcer, ...params);\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}},
    {"offset": {"line": 5711, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/frontend.js"],"sourcesContent":["// Copyright 2020 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport { deepCopy } from './util';\n/**\n * Experiment!\n * getPermissionForCasbinJs returns a string include the whole model.\n * You can pass the returned string to the frontend and manage your webpage widgets and APIs with Casbin.js.\n * @param e the initialized enforcer\n * @param user the user\n */\nexport async function casbinJsGetPermissionForUser(e, user) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n    const obj = {};\n    const m = e.getModel().model;\n    let s = '';\n    s += '[request_definition]\\n';\n    s += `r = ${(_b = (_a = m.get('r')) === null || _a === void 0 ? void 0 : _a.get('r')) === null || _b === void 0 ? void 0 : _b.value.replace(/_/g, '.')}\\n`;\n    s += '[policy_definition]\\n';\n    s += `p = ${(_d = (_c = m.get('p')) === null || _c === void 0 ? void 0 : _c.get('p')) === null || _d === void 0 ? void 0 : _d.value.replace(/_/g, '.')}\\n`;\n    if (((_e = m.get('g')) === null || _e === void 0 ? void 0 : _e.get('g')) !== undefined) {\n        s += '[role_definition]\\n';\n        s += `g = ${(_g = (_f = m.get('g')) === null || _f === void 0 ? void 0 : _f.get('g')) === null || _g === void 0 ? void 0 : _g.value}\\n`;\n    }\n    s += '[policy_effect]\\n';\n    s += `e = ${(_j = (_h = m.get('e')) === null || _h === void 0 ? void 0 : _h.get('e')) === null || _j === void 0 ? void 0 : _j.value.replace(/_/g, '.')}\\n`;\n    s += '[matchers]\\n';\n    s += `m = ${(_l = (_k = m.get('m')) === null || _k === void 0 ? void 0 : _k.get('m')) === null || _l === void 0 ? void 0 : _l.value.replace(/_/g, '.')}`;\n    obj['m'] = s;\n    const policy = deepCopy(await e.getPolicy());\n    const groupPolicy = deepCopy(await e.getGroupingPolicy());\n    policy.forEach((item) => {\n        item.unshift('p');\n    });\n    groupPolicy.forEach((item) => {\n        item.unshift('g');\n    });\n    obj['p'] = [...policy, ...groupPolicy];\n    return JSON.stringify(obj);\n}\n"],"names":[],"mappings":";;;;AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AAAA;;AAQO,eAAe,6BAA6B,CAAC,EAAE,IAAI;IACtD,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI;IAC5C,MAAM,MAAM,CAAC;IACb,MAAM,IAAI,EAAE,QAAQ,GAAG,KAAK;IAC5B,IAAI,IAAI;IACR,KAAK;IACL,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,EAAE,CAAC;IAC1J,KAAK;IACL,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,EAAE,CAAC;IAC1J,IAAI,CAAC,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,CAAC,IAAI,MAAM,WAAW;QACpF,KAAK;QACL,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC;IAC3I;IACA,KAAK;IACL,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,EAAE,CAAC;IAC1J,KAAK;IACL,KAAK,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,GAAG,CAAC,IAAI,MAAM,QAAQ,OAAO,KAAK,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,MAAM;IACxJ,GAAG,CAAC,IAAI,GAAG;IACX,MAAM,SAAS,IAAA,iLAAQ,EAAC,MAAM,EAAE,SAAS;IACzC,MAAM,cAAc,IAAA,iLAAQ,EAAC,MAAM,EAAE,iBAAiB;IACtD,OAAO,OAAO,CAAC,CAAC;QACZ,KAAK,OAAO,CAAC;IACjB;IACA,YAAY,OAAO,CAAC,CAAC;QACjB,KAAK,OAAO,CAAC;IACjB;IACA,GAAG,CAAC,IAAI,GAAG;WAAI;WAAW;KAAY;IACtC,OAAO,KAAK,SAAS,CAAC;AAC1B","ignoreList":[0]}},
    {"offset": {"line": 5767, "column": 0}, "map": {"version":3,"sources":["file:///C:/dev/flow/workflow-core/apps/web/node_modules/casbin/lib/esm/index.js"],"sourcesContent":["// Copyright 2019 The Casbin Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nimport * as Util from './util';\nexport * from './config';\nexport * from './enforcer';\nexport * from './cachedEnforcer';\nexport * from './syncedEnforcer';\nexport * from './effect';\nexport * from './model';\nexport * from './persist';\nexport * from './rbac';\nexport * from './log';\nexport * from './enforceContext';\nexport * from './frontend';\nexport { Util };\n"],"names":[],"mappings":";AAAA,0DAA0D;AAC1D,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,kDAAkD;AAClD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AACjC;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","ignoreList":[0]}}]
}